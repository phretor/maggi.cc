[{"authors":["admin"],"categories":null,"content":"I enjoy doing research on various cyber-security topics. I\u0026rsquo;ve analyzed web applications, network protocols and devices, embedded systems, radio-frequency control systems, industrial robots, cars, and mobile devices, but I also have experience on defensive technology and research, through building machine learning-based tools for intrusion and fraud detection.\nI work with Trend Micro Research in a global team that focuses on technology and cyber-crime research. After more than 10 years, I concluded that I‚Äôm still around in the infosec area because it gives me so many opportunities to solve new exciting problems every day.\n","date":-62135596800,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/author/federico-maggi/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/federico-maggi/","section":"authors","summary":"I enjoy doing research on various cyber-security topics. I\u0026rsquo;ve analyzed web applications, network protocols and devices, embedded systems, radio-frequency control systems, industrial robots, cars, and mobile devices, but I also have experience on defensive technology and research, through building machine learning-based tools for intrusion and fraud detection.","tags":null,"title":"Federico Maggi","type":"authors"},{"authors":["Marcello Pogliani","Federico Maggi","Marco Balduzzi","Davide Quarta","Stefano Zanero"],"categories":null,"content":"","date":1601856000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591541701,"objectID":"da4bcca57101ef1ab9760e00b6affbad","permalink":"/publication/pogliani_otrazor_2020/","publishdate":"2020-06-05T00:00:00Z","relpermalink":"/publication/pogliani_otrazor_2020/","section":"publication","summary":"To appear","tags":null,"title":"Detecting Unsafe Code Patterns in Industrial Robot Programs","type":"publication"},{"authors":["Federico Maggi","Marcello Pogliani","Davide Quarta","Stefano Zanero","Marco Balduzzi"],"categories":null,"content":"","date":1596585600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591540292,"objectID":"178ce1b2dc2d55c719be73474ae70eb4","permalink":"/talk/maggi_otrazorbhus_talk_2020/","publishdate":"2020-06-05T00:00:00Z","relpermalink":"/talk/maggi_otrazorbhus_talk_2020/","section":"talk","summary":"In this talk, we delve into industrial robot programming, focusing on the security issues arising from the design and implementation choices of these platforms.  Industrial robot manufacturers provide proprietary, domain-specific programming languages to operate these complex machines. Mostly focused on movement instructions, such programming languages also provide access to low-level system resources like files and network access, and some even allow dynamic code loading. While useful, these features can lead to unsafe programming patterns such as input-validation vulnerabilities or malware-like functionalities, especially if the underlying environment provides no resource isolation like those found in modern operating systems.  After describing the technical features of the languages by eight leading manufacturers, we'll share several cases of vulnerable and malicious usage. We'll then present a static code analyzer that we created and patented, to scan robotic programs and discover unsafe code patterns. Our evaluation on 50 automation programs show that unsafe patterns are indeed found in real-world code, and that static source code analysis is an effective defense tool in the short term.  We conclude by discussing the remediation steps that can be adopted by developers and vendors to mitigate such issues in the medium and long term.","tags":null,"title":"OTRazor: Static Code Analysis for Vulnerability Discovery in Industrial Automation Scripts","type":"talk"},{"authors":[],"categories":[],"content":"I\u0026rsquo;m not a bug hunter, but I do occasionally find and report vulnerabilities as part of my job.\nCVE-2018-19023  Hetronic replay-attack vulnerability in radio-frequency industrial remote controllers. More details at ICSA-19-003-03, CVE-2018-19023, and ZDI-19-003.\nZDI-CAN-6183  Autec replay-attack vulnerability in radio-frequency industrial remote controllers. The product under testing has reached end of life and is no longer supported by the vendor. More details.\nZDI-18-1336  Juuko replay-attack vulnerability in radio-frequency industrial remote controllers. More details at ZDI-18-1336.\nZDI-CAN-6185  Circuit Design replay-attack vulnerability in radio-frequency module. More details.\nZDI-18-1362  Juuko arbitrary command injection and remote code execution vulnerability in radio-frequency industrial remote controllers. More details at ZDI-18-1362.\nZDI-CAN-6187  Elca replay-attack vulnerability in radio-frequency industrial remote controllers. The product under testing has reached end of life and is no longer supported by the vendor. More details.\nCVE-2018-17903  Saga replay-attack vulnerability in radio-frequency industrial remote controllers. More details at ICSA-18-296-02, and CVE-2018-17903.\nCVE-2018-17921  Saga TX-RX re-pairing without human interaction in radio-frequency industrial radio controllers. More details at ICSA-18-296-02, and CVE-2018-17921.\nCVE-2018-17923  Saga unattended reprogramming in radio-frequency industrial radio remote controllers. More details at ICSA-18-296-02, and CVE-2018-17923.\nCVE-2018-17935  Telecrane replay-attack vulnerability in radio-frequency industrial radio remote controllers. More details at ICSA-18-296-03, and CVE-2018-17935.\nCVE-2018-11615  mosca 2.8.1 regular expression denial of service. More details at CVE-2018-11615, and ZDI-18-583.\nCVE-2018-17614 PubSubClient 2.7 MQTT remote command execution. More details at CVE-2018-17614 and ZDI-18-1337.\nCVE-2018-10633 Universal Robots Robot Controllers Version CB 3.1 remote code execution. More details at ICSA-18-191-01.\nCVE-2018-10635 Universal Robots Robot Controllers Version CB 3.1 hard-coded credentials. More details at ICSA-18-191-01.\nCVE-2017-7653 Eclipse Mosquitto broker up to version 1.4.15 denial of service via invalid Unicode in topics strings. More details at CVE-2017-7653, 532113, and OASIS.\nICS-ALERT-17-209-01 CAN Bus Standard Vulnerability (Resource Exhaustion). More details at ICS-ALERT-17-209-01.\nABBVU-DMRO-124641  ABB RobotWare Buffer overflow leading to arbitrary remote code execution. More details at SI20107.\nABBVU-DMRO-124642  ABB RobotWare Remote command execution. More details at SI20107.\nABBVU-DMRO-124644  ABB RobotWare Authentication bypass. More details at SI20107.\nABBVU-DMRO-124645  ABB RobotWare Buffer overflow in FlexPendant. More details at SI20107.\nABBVU-DMRO-128238  ABB RobotWare Remote buffer overflow in command endpoint. More details at SI20107.\n","date":1591537908,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591537908,"objectID":"3af68fc1503a11dd3f34ff909fb6bce8","permalink":"/advisories/","publishdate":"2020-06-07T15:51:48+02:00","relpermalink":"/advisories/","section":"","summary":"I\u0026rsquo;m not a bug hunter, but I do occasionally find and report vulnerabilities as part of my job.\nCVE-2018-19023  Hetronic replay-attack vulnerability in radio-frequency industrial remote controllers. More details at ICSA-19-003-03, CVE-2018-19023, and ZDI-19-003.","tags":[],"title":"Advisories","type":"page"},{"authors":[],"categories":[],"content":"Cybersecurity keeps giving me the best excuses to find exciting problems to solve. Or, as my wife once said, to \u0026ldquo;push buttons on my computer\u0026rdquo;.\nBoring Stuff First Very likely, you came here because you need to quickly copy and paste my short bio, or grab a head shot to post on a conference website. So, here you go!\nShort Bio (170 words)  With more than a decade of research experience in the cybersecurity field, Federico Maggi is specialized in doing threat and security analysis on virtually any system. Federico has analyzed web applications, network protocols and devices, embedded systems, radio-frequency control systems, industrial robots, cars, and mobile devices.\nFederico has experience on defensive technology and research, through building machine learning-based tools for intrusion and fraud detection. He\u0026rsquo;s applied data visualization techniques for analyzing botnets, and has gained basic malware analysis and reverse-engineering on Android-based platforms.\nCurrently employed as a Senior Researcher with security giant Trend Micro (https://trendmicro.com), Federico was an Assistant Professor at Politecnico di Milano, one of the leading engineering technical universities in Italy. Aside his teaching activities, Federico co-directed the security group and has managed hundreds of graduate students.\nFederico has given several lectures and talks as an invited speaker at international venues and research schools, and also serves in the review or organizing committees of well-known conferences.\nMore info about Federico and his work are available online at https://maggi.cc\n One-liner Bio (27 words)  Federico Maggi, PhD, is a Senior Researcher with Trend Micro and has been working in cybersecurity for more than a decade with the public and private sector.\n Head shot If you need a head shot, please use headshot.jpg.\nResearch Activities The mission of the team I work with is to scout the future of emerging (or legacy and widely adopted) technologies. This is easier said than done! Of course we don\u0026rsquo;t have a crystal ball. What we do is we look at a technology from a threat-actor perspective, and make an effort to \u0026ldquo;see\u0026rdquo; how things can go bad if a threat actually arise.\nThis gives us good insights on how to anticipate and prevent emerging security risks and threats. And of course this gives my employer a driver for innovation, to push new updates into existing products, or create new products. Because of this, Trend Micro\u0026rsquo;s customers will benefit from our research.\nThis is what I do most of the the time, together with my colleagues in Trend Micro Research. In addition to technology research, we constantly collaborate with law-enforcement agencies in cybercrime investigations.\nResearch Topics I Love I have been in the computer security ‚Äúcircus‚Äù since 2005.\nAlthough I enjoy doing research in really any area, looking back at my past work, it seems that my main interests revolve around various topics under the ‚Äúcyber security‚Äù and ‚Äúcyber crime‚Äù umbrella terms, such as threat analysis and intelligence, malware analysis, mobile security, fraud analysis and detection, web- and social-network security and data visualization.\nIf I have to find a distinctive aspect of my work, I like to follow data-driven or learning-based approaches. Indeed, I enjoy doing large-scale measurements.\nAn Academic Moved to the Industry World Before joining Trend Micro, until Summer 2016 I was an Assistant Professor at Dipartimento di Elettronica, Informazione e Bioingegneria (DEIB), Politecnico di Milano in Italy, where I co-directed the system-security group at the NECST Laboratory, and led several projects with my colleague and advisor Stefano Zanero.\nDuring my PhD, I made some contributions in the field of anomaly detection and I was using machine learning way before it became mainstream. I developed and tested various anomaly-based tools, for example to detect attacks against web applications or unexpected activities in the kernel (sing of malware infections or compromised processes).\nSpeaking: The Cherry on The Cake Let\u0026rsquo;s be honest: when the hard research work is over, isn\u0026rsquo;t it just great to get on stage and share the results with the world?\nI have given several lectures and talks, mainly peer-reviewed talks, but also as an invited speaker at international venues and research schools.\nI\u0026rsquo;m far from being a professional speaker, but people say I\u0026rsquo;m quite good at it. Have a look at some of my public speeches to get a sense of my speaking style. I used to hate and be afraid of speaking in public, and I still remember the tension and anxiety I experienced before every single talk. I don\u0026rsquo;t know exactly when and why, but something happened at some point, and everything turned upside down. Now I try to find every possible excuse to get on stage, because I find it an extremely satisfying and entertaining activity‚Äìfor myself, at least, and hopefully for the audience as well!\nHacking and Playing Around With Stuff I\u0026rsquo;m not a bug hunter, but I do occasionally find and report vulnerabilities as part of my job.\nAs my work is not focused on a particular product or vertical, I\u0026rsquo;ve never really grown a technology-specific skillset when it comes to hacking and bug hunting. Rather, I adapt and I\u0026rsquo;m eager to learn what\u0026rsquo;s needed for the next challenge. I\u0026rsquo;ve looked at web applications, desktop and mobile apps, middleware protocols, embedded protocols, and even radio frequency. So, a little bit of everything. As I mentioned at the beginning of this page, cybersecurity is the only field that managed to keep me busy with new problems.\nWhen time permits, I occasionally play CTFs or prepare challenges. Honestly, I haven\u0026rsquo;t been playing for a looong long time: I think 2004 or something, when we (early memebers of the Tower of Hanoi) played one of the very first editions of the UCSB iCTF. Thanks to @ lucacarettoni for sharing this great memory about that game. Yes, that\u0026rsquo;s the printout of the scoreboard. Amazing times!\nWith the same team, in 2015 I have led the organization of the PoliCTF contest. Was quite a lot of fun! I\u0026rsquo;m currently organizing the Capture the Signal (CTS), a contest focused exclusively on RF-hacking.\nWhen time permits, I like to pretend I\u0026rsquo;m an amateur electronic enthusiast, doing stuff like DYI automation, RF nodes, and stuff like that.\nReviewing Others\u0026rsquo; Work I\u0026rsquo;m regularly invited to serve in the review board, organizing or technical program committee of conferences. To name a few, I have been the general chair of DIMVA 2015, PC chair of EUC 2014 and PC member of several conferences and workshops including ACSAC, AsiaCCS, DIMVA, SecureComm.\n","date":1591535462,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591535462,"objectID":"8576ec274c98b3831668a172fa632d80","permalink":"/about/","publishdate":"2020-06-07T15:11:02+02:00","relpermalink":"/about/","section":"","summary":"Cybersecurity keeps giving me the best excuses to find exciting problems to solve. Or, as my wife once said, to \u0026ldquo;push buttons on my computer\u0026rdquo;.\nBoring Stuff First Very likely, you came here because you need to quickly copy and paste my short bio, or grab a head shot to post on a conference website.","tags":[],"title":"About","type":"page"},{"authors":[],"categories":[],"content":"I like to explore and analyze! I especially enjoy creating tools to extract data, analyze and explain unknown phenomena in any ICT system, at any scale.\nI am happily doing this (and more) at Trend Micro Research, where we scout the future for upcoming or overlooked security risks and threats.\n  Summary  Positions, Education and Awards  Presence in the Infosec Community  Research  Teaching and Advising Experience  References and Endorsements  For the past 17 years I have had both industrial and academic work experience, as an employee, professor, and consultant. As such, I have experience dealing with various realms, from large corporate environments, research laboratories, to small companies.\nMy work activities range from pure development to research, including both technical and dissemination tasks. In the past, I\u0026rsquo;ve done vulnerability assessment and web penetration-testing activities as a consultant, and I was hired multiple times as a technical expert witness for courts in Italy. Being member of various review boards and scientific program committees, I have extensive experience in assessing the quality of technical documents and other scientific artifacts.\nResearch Summary Although I enjoy doing research in really any area of computer science, my experience includes various topics under the ‚Äúcyber security‚Äù and ‚Äúcyber crime‚Äù umbrella terms, such as threat analysis and intelligence, malware analysis, mobile security, fraud analysis and detection, web- and social-network security, and data visualization for security.\nA distinctive aspect of my work is that I always strive to follow data-driven or learning-based approaches. The most recent example is a large-scale, data-analysis tool that I developed to find web-defacement campaigns. In agreement with the employer, I\u0026rsquo;ve partially open-sourced the tool after demoing it at Black Hat US Arsenal (2017). I\u0026rsquo;ve worked on similar projects on other topics: botnet data analysis and intelligence, mobile ransomware analysis, banking fraud intelligence, malware behavior mining, web-scale threat measurements, anomaly detection.\nResearch Dissemination and Speaking Experience I published tenths of research papers at refereed international conferences or journals, as well as technical white papers and technical blog posts. I\u0026rsquo;ve presented my work at various international venues including both academic and industrial conferences (e.g., Black Hat), as well as closed-door events.\nThanks to my extensive teaching experience, I have acquired professional proficency at speaking to and engaging with various types of audiences in both English and Italian languaeg. Thanks to these activities, I\u0026rsquo;ve grown accustomed to travel internationally and interact with a variety of cultures.\nMy work has been recognized by several research groups (UC Santa Barbara, Foundation for Research and Technology Hellas, Northeaster Univeristy, Stony Brook University, KU Leven, and Royal Holloway University of London), with which I collaborated in various occasions.\nTeamwork and Management Experience In addition to teamwork in small groups of researchers, I have been teaching computer programming, computer and network security, digital forensics, and information systems. Since 2014 I was a professor for the Computer Security course and co-teach Advanced Topics in Computer Security.\nI coordinated the organization of computer-security challenges and international competitions (CTFs). I\u0026rsquo;ve advised several PhD students. During my research projects, I am keen to involve people actively and work closely with them. During my academic career, this resulted in more than 35 theses and hundreds of people that I supervised since 2009.\nTechnical Skills R\u0026amp;D activities highly demand flexibility, and thus I\u0026rsquo;m always keen to learn a new technology. Thanks to this, I have gained hands-on experience with a wide variety of technical development and research tools, at all levels of the modern ICT stack: from a disassembler or other command-line tools, to full-fledged web-development frameworks, storage systems, as well as dev-ops or system-administration tools.\nPositions, Education and Awards Record of Employment   2016‚Äîpresent\n Title: Senior Researcher with Trend Micro, Inc. Research. Italy. Main activities: R\u0026amp;D, research dissemination.    2016‚Äî2017\n Title: Adjunct Professor with Politecnico di Milano, Dipartimento di Elettronica, Informazione e Bioingegneria (DEIB). Italy. Main activities: teaching (Computer Security).    2015‚Äì2016\n Title: Visiting Professor at UC Santa Barbara, Computer Security Group. California, USA. Main activities: Scientific research.    2014‚Äî2016\n Title: Fixed-term Assistant Professor with Politecnico di Milano, Dipartimento di Elettronica, Informazione e Bioingegneria (DEIB). Italy. Main activities: Scientific research, teaching (Computer Security), research management.    2013‚Äîpresent\n Title: Technical expert witness for courts in Italy. Main activities: Computer forensics, evidence analysis.    2010‚Äì2014\n Title: Post-doctorate research fellow with Politecnico di Milano, Dipartimento di Elettronica, Informazione e Bioingegneria (DEIB). Italy. Main activities: Scientific research, teaching (Computer Security, Computer Forensics, Programming).    2005‚Äì2016\n Title: Consultant for SecureNetwork s.r.l. Italy. Main activities: R\u0026amp;D, teaching (Information Security, Malware Analysis), web penetration testing, and vulnerability assessment. Italy.    2002‚Äì2006\n Title: Consultant for BMS s.r.l. Main activities: IT maintenance and development. Italy.    2000‚Äì2016\n Title: Freelance IT consultant. Italy.    Education   2010: Doctorate in Computer Enginering\n Grade: cum laude Institute: Politecnico di Milano. Thesis:    Federico Maggi  (2010). Integrated Detection of Anomalous Behavior of Computer Infrastructures.  PDF  Cite     Advisor: Prof. S. Zanero Reviewer: Prof. H. J. Bos    2008‚Äì2009 Visiting Research Scholar\n Institute: University of California, Santa Barbara, Department of Computer Science Supervisor: Prof. G. Vigna    2006: Master of Science in Computer Science Engineering\n Grade: cum laude Thesis: Efficacia ed integrazione di sistemi di anomaly detection Advisor: Prof. G. Serazzi Advisor: Prof. S. Zanero    Toolbox \u0026amp; Technical Skills  Data analysis and Machine Learning: Pandas, NumPy, SciPy, Scikit-Learn, R. Scalable storage and data analysis: MongoDB, Elastic Search, Kibana, Splunk, Hadoop. Programming languages and frameworks: Python, Bash, C, Arduino, x86. Reverse engineering and binary analysis: Apktool, GDB, IDA Pro, Smali. Web frameworks: Flux, React, Flask, Django, Bootstrap. Systems: OS X, Linux, FreeBSD, Windows, Android, Docker. Physical layers: Universal Radio Hacker, GNU Radio, RFCat, Arduino, KiCad.  Awards   Dimitri N. Chorafas PhD Thesis Award (USD 4,000), 2010  Best M.Sc. Thesis Nominee at Premio tesi ClusIT, 2007  Presence in the Infosec Community Through various activities such as international collaborations, public speaking and conference organization, I feel I belong to the ‚Äúsmall‚Äù world that we all call ‚Äúthe infosec community‚Äù. The researchers with which I collaborate can be easily extrapolated by looking at my publication list. Therefore, I\u0026rsquo;m hereby listing the rest.\nInternational Conference Organization I was organizer of international conferences, part of their review boards, or served as an external reviewer.\n 2020: Black Hat Europe Review Board 2019: EuroSec, DIMVA, eCrime 2018: AsiaCCS, ACSAC 2017: ACSAC, DIMVA, AsiaCCS, AppSec EU, eCrime, IMPS 2016: ACSAC, DIMVA 2015: DIMVA (General Chair), TRUST, MALWARE, WISTP, EUC, AppSecEU, PPREW, ESSoS. 2014: PPREW, MCSoC, TRUST, DPMPC, WISTP, IJCNN. 2013: CyCon, ICISS, 2011: EC2ND, BADGERS 2010: COMPENG 2009: EC2ND 2008: DIMVA  I was part of the Tower of Hanoi (ToH) team, with which I\u0026rsquo;ve gained experience in playing, organizing, and running CTF competitions. I\u0026rsquo;m among the organizers of the Capture the Signal (CTS), the first RF-only CTF (by Trend Micro Research)!\nReferee Service Although I\u0026rsquo;m not a strong supporter of journals in this area, in the past I have served for the following journals as a reviewer:\n International Journal of Computer Security (IJCS) International Journal of Information Security (IJIS) IEEE Transactions on Dependable and Secure Computing (TDSC) ACM Transactions on Information and System Security (TISSEC) Journal in Computer Virology (JCV) Computers \u0026amp; Security (CoSe)  Research My research activity revolves around a multitude of topics in the area of cyber security and e-crime, with a spin on data-analysis-oriented approaches.\nResearch Topics I focus on analysis and mitigation of current and future threats using data analysis. I\u0026rsquo;ve been using ML since the beginning of my academic career. Nowadays, there is a lot of hype around machine learning (ML) and artificial intelligence (AI), and sometimes these two branches of science are brutally confused, to the point that people write ‚ÄúML/AI‚Äù or say ‚ÄúML or AI,‚Äù like they were synonyms. I prefer to take a step back, and simply say that I use data-analysis techniques, which has a much broader meaning. In particular, I do research on threat analysis and intelligence, malware analysis (including mobile malware), banking fraud analysis and detection, web and social-network security, vishing (voice phishing), and measurement. In addition, I did contributions in the field of security visualization.\nIn the past I made contributions in the field of anomaly detection: I developed and tested anomaly-based tools to mitigate Internet threats by (1) avoiding their spread via vulnerable web applications, (2) detecting unexpected activities in the operating system‚Äôs kernel (sing of malware infections or compromised processes), and (3) dealing with high number of alerts using alert correlation.\nI occasionally extend my research beyond such topics: I let new ideas grow into research projects and involve multiple research institutions as needed by the specific vertical.\nFunded Research Projects Prior to joining Trend Micro, Inc., my academic research has been supported by the following projects, in which I was either the PI or was directly involved as a researcher.\n  FACE (MIUR FIRB, 2014\u0026ndash;206) - face-project.it\n Principal Investigators: F. Maggi and M. Dalla Preda Topics: Malware analysis and defense methodologies.    WOMBAT (EU STREP FP-7, 2010\u0026ndash;2013) - wombat-project.eu\n Principal Investigator: Prof. G. Serazzi Topics: Malware analysis, network traffic analysis. Role: researcher.    SysSec (EU NOE FP-7, 2010\u0026ndash;2013) - syssec-project.eu\n Principal Investigator: Prof. S. Zanero Topics: System security, mobile malware, scientific collaboration and education. Role: researcher and co-coordinator of dissemination activities.    i-Code (CIPS, 2010\u0026ndash;2011) - icode-project.eu\n Principal Investigator: Prof. S. Zanero Topics: Malware analysis, network traffic analysis, forensics. Role: researcher and co-supervisor of other staff researchers.    TENACE (MIUR PRIN, 2013\u0026ndash;2016) - http://www.dis.uniroma1.it/~tenace\n Principal Investigator: Prof. S. Zanero Topics: National critical infrastructure protection. Role: researcher and co-supervisor of students working on financial fraud detection.    Teaching and Advising Experience In 2013\u0026ndash;2017, I have been a lecturer for the Computer Security course of the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano.\nI have been doing teaching since Master of Science (MSc), during which I\u0026rsquo;ve tutored undergraduate students in computer programming courses (Informatica 1) between 2005 and 2007. In the following list, this activity is referred to as ‚ÄúLab. Tutor‚Äù: this involves guiding students in problem-solving tasks during their programming assignment in laboratory classes. Such classes are taught by so-called ‚ÄúLab. Teaching Assistants (TAs)‚Äù. I was ‚ÄúLab. TA‚Äù between 2007 and 2010 for the same computer programming courses, which meant preparing, solving and testing computer-programming problems of increasing difficulty (mainly in ANSI C), assigning them to students, coordinating the activity of one or two Lab. Tutors, and evaluating the solutions produced by students.\nIn 2008\u0026ndash;2016 I have been TA for other courses. In particular, I thought classes in computer and network security, graduate-level courses, and prepared and graded exams for such courses. I also prepared and demonstrated practical tutorial lessons (e.g., live penetration testing exercises) to introduce young students to ethical hacking and CTFs. Also, I have been TA for non-security courses on topics such as computer system performance evaluation and information systems. For these courses I was required to teach how to solve practical exercises, prepare and grade exams, and also to prepare homework and small web application for students to request assignments, submit their solutions and automate grading.\nTaught Courses Here\u0026rsquo;s the timeline of my teaching experience:\n  2014-2015\n Instructor for Computer Security. Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. Instructor for Computer Security. Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. TA for Informatica Forense (Computer Forensic). Graduate-level course thought at the 5th School of Engineer- ing (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. Advanced Topics in Computer Security. Master- and PhD-level course taught by Prof. S. Zanero as part of the Doctoral Program in Information Technology (Dottorato di Ricerca in Ingegneria dell‚ÄôInformazione) at Politecnico di Milano.    2013-2014\n Instructor for Computer Security. Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. TA for Informatica Forense (Computer Forensic). Graduate-level course thought at the 5th School of Engineer- ing (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. TA for Privacy and Security. Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano (Como). Advanced Topics in Computer Security. Master- and PhD-level course taught by Prof. S. Zanero as part of the Doctoral Program in Information Technology (Dottorato di Ricerca in Ingegneria dell‚ÄôInformazione) at Politecnico di Milano.    2012-2013\n TA for Computer Security. Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. TA for Informatica Forense (Computer Forensic). Graduate-level course thought at the 5th School of Engineer- ing (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. Advanced Topics in Computer Security. Master- and PhD-level course taught by Prof. S. Zanero as part of the Doctoral Program in Information Technology (Dottorato di Ricerca in Ingegneria dell‚ÄôInformazione) at Politecnico di Milano.    2011-2012\n Advanced Topics in Computer Security. Master- and PhD-level course taught by Prof. S. Zanero as part of the Doctoral Program in Information Technology (Dottorato di Ricerca in Ingegneria dell‚ÄôInformazione) at Politecnico di Milano.    2010-2011\n TA for Dimensionamento degli Impianti Informatici (Computer Systems Performance Evaluation: Techniques and Applications) TA for Sistemi Informativi (Information Systems). Undergraduate-level course thought at the 2nd School of Engineering (Ingegneria dei Sistemi) of Politecnico di    2009-2010\n TA for Sicurezza delle Applicazioni (Computer Security). Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano. Lab. TA2 for Informatica B (Programming). Undergraduate-level course thought at the 4th School of Engi- neering (Ingegneria Industriale) of Politecnico di Milano. TA for Sistemi Informativi (Information Systems). Undergraduate-level course thought at the 2nd School of Engineering (Ingegneria dei Sistemi) of Politecnico di    2008-2009\n TA for Impianti di Elaborazione (Information Systems). Undergraduate-level course thought at the 2nd School of Engineering (Ingegneria dei Sistemi) of Politecnico di    2007-2008\n Lab. TA for Informatica 1 (Programming). TA for Impianti Informatici (Enterprise Digital Infrastructures). TA for Sicurezza degli Impianti Informatici (Network Security). Graduate-level course thought at the 5th School of Engineering (Ingegneria dell‚ÄôInformazione) of Politecnico di Milano.    2006-2007\n Lab. Tutor for Informatica 1 (Programming).    2005-2006\n Lab. Tutor for Informatica 1 (Programming).    Students Advised I supervised 2 PhD students ( Andrea Continella and Chengyu Zheng) Additionally, I co-supervised 3 PhD students ( Michele Carminati, Mario Polino, and Davide Quarta).\nIn addition, I\u0026rsquo;ve always involved undergraduate and graduate students in my research activity, and strive to work closely and directly with them, as opposed to just assign work. Moreover, I supervised graduate and undergraduate students during their master and bachelor theses.\nReferences and Endorsements I\u0026rsquo;ve collaborated with several researchers and Professors around the world. If you are looking to receive an opinion on me, or a recommendation letter, you can contact:\nProfessor Stefano Zanero stefano.zanero@polimi.it\nDipartimento di Elettronica, Informazione e Bioingegneria\nPolitecnico di Milano\nVia Ponzio 34/5\nI-20133, Milano (MI), Italia\nProfessor Christopher KruÃàgel chris@cs.ucsb.edu\n1117 Engineering I\nDepartment of Computer Science\nUniversity of California, Santa Barbara\nSanta Barbara, CA 93106, United States\nProfessor Giovanni Vigna vigna@cs.ucsb.edu\n2159 Engineering I\nDepartment of Computer Science\nUniversity of California, Santa Barbara\nSanta Barbara, CA 93106, United States\nProfessor Herbert Bos herbertb@cs.vu.nl\nComputer Systems Section\nVU Amsterdam\nDe Boelelaan 1081\n1081 HV Amsterdam\nAlthough I don\u0026rsquo;t really believe in publicly disclosed recommendations, I have requested, given and received some recommendations via LinkedIn. Feel free to check those out, FWIW.\nThat\u0026rsquo;s all folks! Thanks for reading!\n","date":1591349727,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591349727,"objectID":"fd36605688ef45e10dc233c860158012","permalink":"/cv/","publishdate":"2020-06-05T11:35:27+02:00","relpermalink":"/cv/","section":"","summary":"I like to explore and analyze! I especially enjoy creating tools to extract data, analyze and explain unknown phenomena in any ICT system, at any scale.\nI am happily doing this (and more) at Trend Micro Research, where we scout the future for upcoming or overlooked security risks and threats.","tags":[],"title":"Curriculum Vit√¶","type":"page"},{"authors":["Federico Maggi","Marcello Pogliani"],"categories":null,"content":"","date":1589155200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591541019,"objectID":"2c9f57f8a85df6ef0a764879bf97ddc8","permalink":"/publication/maggi_smartfactorywp_tr_2020/","publishdate":"2020-05-11T00:00:00Z","relpermalink":"/publication/maggi_smartfactorywp_tr_2020/","section":"publication","summary":"This research presents a systematic security analysis that we performed to explore a variety of attack vectors on a real smart manufacturing system and to assess the attacks that could be feasibly launched on a complex smart manufacturing system. The main, two-pronged question we want to answer is: Under which threat conditions and attacker capabilities are certain attacks possible, and what are the consequences?","tags":null,"title":"Attacks on Smart Manufactururing Systems: A Forward-looking Security Analysis","type":"publication"},{"authors":["Stephen Hilt","Federico Maggi","Charles Perine","Lord Remorin","Martin R√∂sler","Rainer Vosseler"],"categories":null,"content":"","date":1579564800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591541226,"objectID":"b4c830a4d55a4947c4360df11abb82bb","permalink":"/publication/hilt_factoryhoneypotwp_tr_2020/","publishdate":"2020-01-21T00:00:00Z","relpermalink":"/publication/hilt_factoryhoneypotwp_tr_2020/","section":"publication","summary":"Different critical infrastructures have been hit with attacks such as those that involved the infamous Stuxnet malware1 and the more recent Triton malware.2 These incidents ‚Äî attacks on manufacturing and other sectors that use industrial control systems (ICSs) ‚Äî continue to be heard of through the years. In 2017, for instance, the notorious WannaCry ransomware shut down a car manufacturing factory in Japan,3 and another ransomware attack took down a factory in North Carolina, U.S.4Smart factories attract the interest of threat actors for the critical and sensitive infrastructures they usually handle. A successful attack, no matter how difficult the execution, can yield high-impact results that can corner an organization into giving in to cybercriminals‚Äô demands or, at the very least, cost it considerable losses.Prompted by our desire to determine how knowledgeable and imaginative attackers could be in compromising a manufacturing facility, we built the most realistic factory honeypot we had ever created. And in doing so, we also created an ideal environment where we could monitor and learn about the attacks that the honeypot came to attract. From conceptualization to actual execution, our factory honeypot was designed to be an attractive target for potential cybercriminals.Our factory honeypot took on the ruse of a small fictitious company that apparently handled clients from critical industries yet possessed inadequate security defenses. Our ruse proved successful as our honeypot saw several attacks, which we had the freedom and resources to monitor. These attacks included a malicious cryptocurrency mining campaign, two ransomware attacks, another that posed as a ransomware attack, and several scanners.In this research paper, we detail the conceptualization and creation of our most elaborate honeypot to date, and discuss the result of our monitoring and tracking of the incidents that occurred on the honeypot.","tags":null,"title":"Caught in the Act: Running a Realistic Factory Honeypot to Capture Real Threats","type":"publication"},{"authors":["Federico Maggi","Marco Balduzzi","Jonathan Andersson","Philippe Lin","Stephen Hilt","Akira Urano","Rainer Vosseler"],"categories":null,"content":"","date":1560902400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"c03c0f0aa40acc4bc8311e34bee523d9","permalink":"/publication/maggi_industrialradios_2019/","publishdate":"2019-06-19T00:00:00Z","relpermalink":"/publication/maggi_industrialradios_2019/","section":"publication","summary":"Heavy industrial machinery is a primary asset for the operation of key sectors such as construction, manufacturing, and logistics. Targeted attacks against these assets could result in incidents, fatal injuries, and substantial financial loss. Given the importance of such scenarios, we analyzed and evaluated the security implications of the technology used to operate and control this machinery, namely industrial radio remote controllers. We conducted the first-ever security analysis of this technology, which relies on proprietary radio-frequency protocols to implement remote-control functionalities. Through a two-phase evaluation approach we discovered important flaws in the design and implementation of industrial remote controllers. In this paper we introduce and describe 5 practical attacks affecting major vendors and multiple real-world installations. We conclude by discussing how a challenging responsible disclosure process resulted in first-ever security patches and improved security awareness.","tags":null,"title":"A Security Evaluation of Industrial Radio Remote Controllers","type":"publication"},{"authors":["Marco Balduzzi","Federico Maggi"],"categories":null,"content":"","date":1557446400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"0dda4c82ebc9f57b931ed3e6be3c6b68","permalink":"/talk/balduzzi_industrialradioshitb_talk_2019/","publishdate":"2019-05-10T00:00:00Z","relpermalink":"/talk/balduzzi_industrialradioshitb_talk_2019/","section":"talk","summary":"Radio-frequency (RF) remote controllers are widely used in multiple industrial applications like manufacturing, construction and transportation. Cranes, drillers and diggers, among others, are commonly equipped with RF controllers, which have become the weakest link in safety-critical IIoT applications.  Our security assessment revealed a lack of important security features at different levels, with vendors using obscure proprietary protocols instead of standards. As a consequence, this technology appeared to be vulnerable to attacks like replay, command injection, e-stop abuse, malicious repairing and reprogramming. Together with ZDI, we ran into a 6-months responsible disclosure process and then released 10 security advisories.  In this presentation, we share the findings of our research and make use of demos to discuss the problems in detail. We conclude providing recommendations for all parties involved in the life-cycle of these devices, from vendors to users and system integrators.","tags":null,"title":"Hey Operator, Where‚Äôs Your Crane? Attacking Industrial Remote Controllers","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1557360000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"8938f2c45ec842ceed2925a0202b50c6","permalink":"/talk/maggi_rfquack_talk_2019/","publishdate":"2019-05-09T00:00:00Z","relpermalink":"/talk/maggi_rfquack_talk_2019/","section":"talk","summary":"RFQuack is the versatile RF-analysis tool that quacks! It's a library firmware that allows you to sniff, manipulate, and transmit data over the air. And if you're not happy how the default firmware functionalities, we made it easy to extend. Consider it as the hardware-modular and developer-friendly version of the great YardStick One, which is based on the CC1111 radio chip. Differently from that and other RF dongles, RFQuack is designed to be agnostic with respect to the radio chip. So if you want to use, say, the RF69, you can do it. If you need to use the CC110L or CC1120, you can do it. Similarly to RFCat, RFQuack has console based, Python scriptable, client that allows you to set parameters, receive, transmit, and so on.","tags":null,"title":"RFQuack: The RF-Analysis Tool That Quacks","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1554336000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"53ce16ae8f0bcc359e964fc77cd83c28","permalink":"/talk/maggi_m2mhmi_talk_2019/","publishdate":"2019-04-04T00:00:00Z","relpermalink":"/talk/maggi_m2mhmi_talk_2019/","section":"talk","summary":"MQTT and CoAP provide data connectivity for practically any kind of \"machines\". This talk will cover the results of our security analysis of MQTT and CoAP, which uncovered issues in the design specifications, vulnerable product implementations, and hundreds of thousands unsecured, open-to-the-world deployments. Despite the fixes in the design specifications, it is hard for developers to keep up with a changing standard when a technology becomes pervasive. Also, the market of this technology is very wide because the barrier to entry is fairly low. This led to a multitude of fragmented implementations. Our findings have been acknowledged by the vendors, by the MQTT Technical Committee, which released a note to help identify the risks, and received the attention of several other organizations. Using MQTT and CoAP as case study, we will provide recommendations at various levels, in the hope to see a significant reduction in the number of insecure deployments in the future.","tags":null,"title":"Machine-to-Machine Protocol Security: The Case of MQTT and CoAP","type":"talk"},{"authors":["Marcello Pogliani","Davide Quarta","Mario Polino","Martino Vittone","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1548979200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"a7ece6e98db59d5becfc99dd12fb153f","permalink":"/publication/pogliani_article_2019/","publishdate":"2019-02-01T00:00:00Z","relpermalink":"/publication/pogliani_article_2019/","section":"publication","summary":"In modern factories, ``controlled'' manufacturing systems, such as industrial robots, CNC machines, or 3D printers, are often connected in a control network, together with a plethora of heterogeneous control devices. Despite the obvious advantages in terms of production and ease of maintenance, this trend raises non-trivial cybersecurity concerns. Often, the devices employed are not designed for an interconnected world, but cannot be promptly replaced: In fact, they have essentially become legacy systems, embodying design patterns where components and networks are accounted as trusted elements. In this paper, we take a holistic view of the security issues (and challenges) that arise in designing and securely deploying controlled manufacturing systems, using industrial robots as a case study---indeed, robots are the most representative instance of a complex automatically controlled industrial device. Following up to our previous experimental analysis, we take a broad look at the deployment of industrial robots in a typical factory network and at the security challenges that arise from the interaction between operators and machines; then, we propose actionable points to secure industrial cyber-physical systems, and we discuss the limitations of the current standards in industrial robotics to account for active attackers.","tags":null,"title":"Security of controlled manufacturing systems in the connected factory: the case of industrial robots","type":"publication"},{"authors":[],"categories":[],"content":"After having analyzed the several RF protocols for industrial applications, distributed by global vendors, we discovered that none of them had sufficient security features to prevent an attacker from hijacking the communication and manoeuvre the controlled connected machines.\nIn Summer 2016 the condo we live in went through some renovation work. We had construction workers here for the about half a year. This was around the time when I was getting into software-defined radio (SDR) technology, and had a spectrum analyzer open all the time on my computer. Just for fun. After a while I\u0026rsquo;ve noticed some peaks of energy around 434MHz. I didn\u0026rsquo;t pay attention, until when I saw one of the workers holding what looked like a rugged remote controller with a tiny antenna. I rushed back in my office and took a closer look at the spectrum: I could clearly see that the peaks were showing in perfect sync with the noise of the huge crane swinging over my roof.\nI had a little chat with the worker and asked him: \u0026ldquo;Is there any safety mechanism? Like, if I push a button to make the load go down, and someone is under that load, what happens?\u0026rdquo; In the local dialect, he answered something that I could roughly translate as\n \u0026ldquo;ü§¨ if you do that, you must have some serious problems.\n This sounded like the perfect project idea to pitch to my colleagues! So I did. After some back and forth, brainstorming, and someone in the team having related ideas, we\u0026rsquo;ve decided to go after this, map the market, reverse engineer the protocols, look in depth into the embedded systems inside these remotes, and perform an all-around security analysis.\nSo here we are. After a long break in the middle, hard research work, and a challenging disclosure process, I\u0026rsquo;m very happy to share the results of what my colleagues in Trend Micro Research and I have produced.\nMeanwhile, the renovation work is done and we\u0026rsquo;re enjoying a shiny new stone paver.\nRadio-frequency Technology Sub-gigaherz radio-frequency (RF) protocols are widely adopted for both consumer and industrial applications. From simple garage-door openers to remote controllers that manoeuvre huge mining drillers or overhead cranes that can lift tons of loads. So, way beyond construction cranes. These RF protocols operate in the ISM bands (e.g., 433, 868, 915 MHz, depending on the region), have a range up to several hundreds meters, can easily go through obstacles, are very low priced, and are very flexible.\nIndustrial RF Remote Control Systems These industrial remote-control systems usually comprise a receiver (RX) with a few relay switches (e.g., to power up the controlled motor or other electrical loads), and a transmitter (TX) that looks like a rugged remote controller with buttons. Both RX and TX have an embedded digital radio chip and a micro-controller that implements the actual application-level protocol (e.g., structure of messages, CRCs, pairing, addressing). Each transmitted message carries a distinct command that the RX actuates, usually by triggering the relay switches in a given, configurable way.\nSecurity Angle Despite the simplicity of these systems, there is no standardization in the application-level protocol, nor security best practices that go beyond the use of rolling-code to avoid replay attacks (in the best case).\nAfter having analyzed the systems produced by several global vendors, in our research we discovered that none of the implementations had any robust security features (not even rolling codes) that would prevent an attacker from hijacking the communication and take control of the heavy industrial machines connected to the RX unit. After having responsibly disclosed our findings through Trend Micro\u0026rsquo;s ZDI ( 10 advisories and 3 ICS-CERT alerts, some of which resulted in security firmware updates), we\u0026rsquo;ve drawn a list of recommendations for end users, system integrators, and vendors, to ensure that current-generation systems get properly secured, and that next-generation systems will be secure by design.\nDetails? Nope! This has been the hard part. Digging into custom protocols and figuring out all the bits that travel on the SPI bus (to make sure that we\u0026rsquo;re looking at the right data on the RX side) was challenging, yet a lot, lot of fun!\nNo, this blog post won\u0026rsquo;t go into the details. There\u0026rsquo;s the white paper (below) for that! Plus this interactive page with demo videos, and this blog post that describes a little RF dongle we\u0026rsquo;ve built for this research.\nI\u0026rsquo;ve presented this research at Direction Tokyo last November (by the way, my first encounter with the Japanese culture was stellar!), my colleague Philippe has presented it at HITCON pacific focusing on the firmware reverse-engineering, and my colleagues Jonathan ( this Jonathan) and Stephen have just presented the white paper today at the S4 conference.\nMedia I\u0026rsquo;m not attempting to keep track of the media activity around this research, sorry!\n  „ÅÇ„Å™„Åü„ÅÆÊ©üÊ¢∞„ÄÅÂÆâÊòì„Å´„Å§„Å™„Åí„Å¶Â§ß‰∏àÂ§´Ôºü„ÄÄ„É™„Çπ„ÇØ„Å®ÊîªÊíÉÊâãÊ≥ï„ÇíÁü•„Çã, Nov 19th, 2018  „ÇØ„É¨„Éº„É≥„Çí‰∏çÊ≠£„Å´ÈÅ†ÈöîÊìç‰Ωú„ÄÅ10Âπ¥Ââç„Çà„Çä„ÄåÊîªÊíÉ„Åó„ÇÑ„Åô„ÅÑ„ÄçÔºü„ÄÄÂ∞ÇÈñÄÂÆ∂„ÅåÊ≥®ÊÑèÂñöËµ∑, Nov 29th, 2018 Scott Shuey, Gulf News, The next cyber threat won‚Äôt be over the internet, it‚Äôs on the radio ( print version). Jan 5th, 2019 Thomas Brewster, Forbes, Watch Hackers Take Control Of Giant Construction Cranes. Jan 15th, 2019 Sean Lyngaas, CyberScoop, Look to the sky: How hackers could control cranes by abusing radio frequencies, Jan 15th, 2019  References  Federico Maggi, Marco Balduzzi, Jonathan Andersson, Philippe Lin, Stephen Hilt, Akira Urano, Rainer Vosseler  (2019). A Security Evaluation of Industrial Radio Remote Controllers. Proceedings of the 16th International Conference on Detection of Intrusions and Malware, and Vulnerability Assessment (DIMVA).  PDF  Cite    Jonathan Andersson, Marco Balduzzi, Stephen Hilt, Philippe Lin, Federico Maggi, Akira Urano, Rainer Vosseler  (2019). A Security Analysis of Radio Remote Controllers for Industrial Applications. Trend Micro Research.  PDF  Cite  ","date":1547647310,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1547647310,"objectID":"3aca11d5dc9aefeb72dff674e51c30d9","permalink":"/post/ir-security/","publishdate":"2019-01-16T16:01:50+02:00","relpermalink":"/post/ir-security/","section":"post","summary":"After having analyzed the several RF protocols for industrial applications, distributed by global vendors, we discovered that none of them had sufficient security features to prevent an attacker from hijacking the communication and manoeuvre the controlled connected machines.\n","tags":["trendmicro","sdr","rf","radio","iiot","embedded"],"title":"Radio Killed the Radio Stars: Security Analysis of RF Protocols for Industrial Applications","type":"post"},{"authors":["Jonathan Andersson","Marco Balduzzi","Stephen Hilt","Philippe Lin","Federico Maggi","Akira Urano","Rainer Vosseler"],"categories":null,"content":"","date":1547510400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"40947526485c632cdb16d2d77d502ea7","permalink":"/publication/andersson_industrialradioswp_tr_2019/","publishdate":"2019-01-15T00:00:00Z","relpermalink":"/publication/andersson_industrialradioswp_tr_2019/","section":"publication","summary":"Radio frequency (RF) remote controllers are widely used in manufacturing, construction, transportation, and many other industrial applications. Cranes, drills, and miners, among others, are commonly equipped with RF remotes. Unfortunately, these devices have become the weakest link in these safety-critical applications, characterized by long life spans, high replacement costs, and cumbersome patching processes. Given the pervasive connectivity promoted by the Industry 4.0 trend, we foresee a security risk in this domain as has happened in other fields.  Our research reveals that RF remote controllers are distributed globally, and millions of vulnerable units are installed on heavy industrial machinery and environments. Our extensive in-lab and on-site analysis of devices made by seven popular vendors reveals a lack of security features at different levels, with obscure, proprietary protocols instead of standard ones. They are vulnerable to command spoofing, so an attacker can selectively alter their behavior by crafting arbitrary commands ‚Äî with consequences ranging from theft and extortion to sabotage and injury.  This research analyzes and shows how an attacker can persistently and remotely take control or simulate the malfunction of the attached machinery, through attacks like command injection, emergency-stop (e-stop) abuse, and malicious re-pairing. In addition, many modern radio controllers can be programmed via software, which also lacks any security measures, opening them to remote attack vectors. A remote attacker who compromises the computer used to program these remotes can alter their firmware to implement persistent and sophisticated attacks.  Having examined the root cause of the vulnerabilities that make these attacks possible, we have reached out to the affected vendors to promote suitable mitigation, and we hope that our research will help raise awareness and avoid unfortunate situations regarding RF remote controllers in industrial applications.","tags":null,"title":"A Security Analysis of Radio Remote Controllers for Industrial Applications","type":"publication"},{"authors":["Federico Maggi","Davide Quarta"],"categories":null,"content":"","date":1544054400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"d5aad251bb3d9dae230c85d0ad63c584","permalink":"/talk/maggi_mqttbheu_talk_2018/","publishdate":"2018-12-06T00:00:00Z","relpermalink":"/talk/maggi_mqttbheu_talk_2018/","section":"talk","summary":"Two popular machine-to-machine (M2M) protocols‚ÄîMQTT \u0026 CoAP‚Äîare slowly forming the backbone of many IoT infrastructures, including critical industry environments. They are used to provide data connectivity for practically any kind of \"machines\". We found out that these protocols are affected by security and privacy issues that impact several market verticals, applications, products, and brands.  This talk provides a security analysis of MQTT \u0026 CoAP at the design, implementation, and deployment level. We found issues in the design specifications, vulnerable product implementations, and hundreds of thousands unsecured, open-to-the-world deployments. These issues show the risk that endpoints could be open to denial-of-service attacks and, in some cases, full control by an adversary. Despite the fixes in the design specifications, it is hard for developers to keep up with a changing standard when a technology becomes pervasive. Also, the market of this technology is very wide because the barrier to entry is fairly low. This led to a multitude of fragmented implementations.  We analyzed the source code of the most common MQTT implementations, and discovered common flaws‚Äîmostly originating from misinterpretation of the standard. In particular, we found issues in how multibyte strings, UTF-8 characters, and regular-expressions are parsed. Combined with standard features that force servers to retain messages and clients to request acknowledgement the delivery of every message, such bugs can lead to persistent denial of service. Our findings have been acknowledged by the MQTT Technical Committee, which released a note to help identify the risks.  Alongside this, we've analyzed hundreds of millions MQTT \u0026 CoAP messages obtained from hundreds of thousands server. Despite previous efforts that tried to raise awareness, we still found exposed data related to various industry sectors and sensitive information, including credentials and network infrastructure details. Moreover, we found out that MQTT is being used beyond messaging, to transport binary data, most likely for OTA update purposes, which certainly raises a red flag.  Using MQTT \u0026 CoAP as a concrete example of modern M2M technology, we will provide recommendations at various levels (standardization bodies, vendors, developers, and users) in the hope to see a significant reduction in the number of insecure deployments in the future, and a more responsible position by standardization bodies.","tags":null,"title":"When Machines Can't Talk: Security and Privacy Issues of Machine-to-Machine Data Protocols","type":"talk"},{"authors":["Federico Maggi","Rainer Vosseler","Davide Quarta"],"categories":null,"content":"","date":1543881600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"ae8bdbf534857200db8fd2e286c069c1","permalink":"/publication/maggi_mqttwp_tr_2018/","publishdate":"2018-12-04T00:00:00Z","relpermalink":"/publication/maggi_mqttwp_tr_2018/","section":"publication","summary":"The most popular protocols for machine-tomachine (M2M) technology---the backbone of the internet of things (IoT) and industrial internet of things (IIoT)---are affected by security and privacy issues that impact several market verticals, applications, products, and brands.  This report provides a holistic security analysis of the most popular M2M protocols: Message Queuing Telemetry Transport (MQTT) and Constrained Application Protocol (CoAP). Given their flexibility, these data protocols are being adopted in a variety of settings for consumer, enterprise, and industrial applications to connect practically all kinds of ‚Äúmachine,‚Äù from innocuous fitness trackers to large power plants. We found issues in design as well as vulnerable implementations, along with hundreds of thousands of unsecure deployments. These issues highlight the risk of how endpoints could be open to denial-of-service (DoS) attacks and, in some cases, taken advantage of to gain full control by an attacker. Despite the fixes in the design specifications, it is hard for developers to keep up with a changing standard when a technology becomes pervasive. Also, the market for this technology is very wide because the barrier to entry is fairly low. This has led to a multitude of fragmented implementations.  This report is aimed at raising security awareness and driving the adoption of proper remediation measures.","tags":null,"title":"The Fragility of Industrial IoT's Data Backbone: Security and Privacy Issues in MQTT and CoAP Protocols","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1543363200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"de01b585d507ba75ab1b64e24f3e23a2","permalink":"/talk/maggi_webdefacementhitb_talk_2018/","publishdate":"2018-11-28T00:00:00Z","relpermalink":"/talk/maggi_webdefacementhitb_talk_2018/","section":"talk","summary":"Web defacement is the practice of altering a website after its compromise. The altered pages, called defaced pages, can negatively affect the reputation and business of the victim. While investigating several campaigns, we observed that the artifacts left by these attackers allow an expert analyst to investigate their modus operandi and social structure, and expand from single attacks to a group of related incidents. However, manually performing such analysis on millions of events is tedious, and poses scalability challenges.  From these observations, we conceived an automated system that efficiently builds intelligence information out of raw events. Our approach streamlines the analysts job by automatically recognizing web campaigns, and assigning meaningful textual labels to them. Applied to a comprehensive dataset of 13 million incidents, our approach allowed us to conduct what we believe been the first large-scale investigation of this form. In addition, our approach is meant to be adopted operationally by analysts to identify live campaigns in the real world.  We analyze the social structure of modern web attackers, which includes lone individuals as well as actors that cooperate in teams. We look into their motivations, and we draw a parallel between the time line of word-shaping events and web campaigns, which represent the evolution of the interests and orientation of modern attackers.","tags":null,"title":"Using Machine-Learning to Investigate Web Campaigns at Large","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1542326400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"c980bd4714e25e6e7231f2e5f8ab4dc6","permalink":"/talk/maggi_ir_talk_2018/","publishdate":"2018-11-16T00:00:00Z","relpermalink":"/talk/maggi_ir_talk_2018/","section":"talk","summary":"","tags":null,"title":"Safety Risks and Threats in Industrial Automation Systems: The Case of Industrial Radio Remote Controllers","type":"talk"},{"authors":null,"categories":null,"content":"Privacy Policy On this website, accessible from https://maggi.cc, one of our main priorities is the privacy of our visitors. This Privacy Policy document contains types of information that is collected and recorded by this website and how we use it.\nIf you have additional questions or require more information about our Privacy Policy, do not hesitate to contact us.\nThis Privacy Policy applies only to our online activities and is valid for visitors to our website with regards to the information that they shared and/or collect in this website. This policy is not applicable to any information collected offline or via channels other than this website.\nConsent By using our website, you hereby consent to our Privacy Policy and agree to its terms.\nInformation we collect The personal information that you are asked to provide, and the reasons why you are asked to provide it, will be made clear to you at the point we ask you to provide your personal information. If you contact us directly, we may receive additional information about you such as your name, email address, phone number, the contents of the message and/or attachments you may send us, and any other information you may choose to provide. When you register for an Account, we may ask for your contact information, including items such as name, company name, address, email address, and telephone number.\nHow we use your information We use the information we collect in various ways, including to:\n Provide, operate, and maintain our website Improve, personalize, and expand our website Understand and analyze how you use our website Develop new products, services, features, and functionality Communicate with you, either directly or through one of our partners, including for customer service, to provide you with updates and other information relating to the website, and for marketing and promotional purposes Send you emails Find and prevent fraud  Log Files This website follows a standard procedure of using log files. These files log visitors when they visit websites. All hosting companies do this and a part of hosting services\u0026rsquo; analytics. The information collected by log files include internet protocol (IP) addresses, browser type, Internet Service Provider (ISP), date and time stamp, referring/exit pages, and possibly the number of clicks. These are not linked to any information that is personally identifiable. The purpose of the information is for analyzing trends, administering the site, tracking users\u0026rsquo; movement on the website, and gathering demographic information. Our Privacy Policy was created with the help of the Privacy Policy Generator.\nAdvertising Partners Privacy Policies You may consult this list to find the Privacy Policy for each of the advertising partners of this website.\nThird-party ad servers or ad networks uses technologies like cookies, JavaScript, or Web Beacons that are used in their respective advertisements and links that appear on this website, which are sent directly to users\u0026rsquo; browser. They automatically receive your IP address when this occurs. These technologies are used to measure the effectiveness of their advertising campaigns and/or to personalize the advertising content that you see on websites that you visit.\nNote that Federico Maggi has no access to or control over these cookies that are used by third-party advertisers.\nThird Party Privacy Policies This website\u0026rsquo;s Privacy Policy does not apply to other advertisers or websites. Thus, we are advising you to consult the respective Privacy Policies of these third-party ad servers for more detailed information. It may include their practices and instructions about how to opt-out of certain options.\nYou can choose to disable cookies through your individual browser options. To know more detailed information about cookie management with specific web browsers, it can be found at the browsers\u0026rsquo; respective websites.\nCCPA Privacy Rights (Do Not Sell My Personal Information) Under the CCPA, among other rights, California consumers have the right to: Request that a business that collects a consumer\u0026rsquo;s personal data disclose the categories and specific pieces of personal data that a business has collected about consumers. Request that a business delete any personal data about the consumer that a business has collected. Request that a business that sells a consumer\u0026rsquo;s personal data, not sell the consumer\u0026rsquo;s personal data. If you make a request, we have one month to respond to you. If you would like to exercise any of these rights, please contact us.\nGDPR Data Protection Rights We would like to make sure you are fully aware of all of your data protection rights. Every user is entitled to the following:\n  The right to access ‚Äì You have the right to request copies of your personal data. We may charge you a small fee for this service.\n  The right to rectification ‚Äì You have the right to request that we correct any information you believe is inaccurate. You also have the right to request that we complete the information you believe is incomplete.\n  The right to erasure ‚Äì You have the right to request that we erase your personal data, under certain conditions.\n  The right to restrict processing ‚Äì You have the right to request that we restrict the processing of your personal data, under certain conditions.\n  The right to object to processing ‚Äì You have the right to object to our processing of your personal data, under certain conditions.\n  The right to data portability ‚Äì You have the right to request that we transfer the data that we have collected to another organization, or directly to you, under certain conditions.\n  If you make a request, we have one month to respond to you. If you would like to exercise any of these rights, please contact us.\n  Children\u0026rsquo;s Information Another part of our priority is adding protection for children while using the internet. We encourage parents and guardians to observe, participate in, and/or monitor and guide their online activity.\nFederico Maggi does not knowingly collect any Personal Identifiable Information from children under the age of 13. If you think that your child provided this kind of information on our website, we strongly encourage you to contact us immediately and we will do our best efforts to promptly remove such information from our records.\n","date":1530140400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1530140400,"objectID":"18d05a63a1c8d7ed973cc51838494e41","permalink":"/privacy/","publishdate":"2018-06-28T00:00:00+01:00","relpermalink":"/privacy/","section":"","summary":"Privacy Policy On this website, accessible from https://maggi.cc, one of our main priorities is the privacy of our visitors. This Privacy Policy document contains types of information that is collected and recorded by this website and how we use it.","tags":null,"title":"Privacy Policy","type":"page"},{"authors":[],"categories":[],"content":"Given the multiple releases around this topic and project, I\u0026rsquo;ve decided to put together a summary. So far, there is: a tool, a white paper, an academic paper, and (spoiler alert) another white paper coming soon.\nYou‚Äôd be surprised (I was!) how much the modus operandi and the motivation behind web defacement have evolved and mutated over the past ~20 years. From attackers interested in pointing their finger to vulnerable websites, to modern actors taking strong positions on real-world conflicts.\nHow do we know what we know about this phenomenon? Let\u0026rsquo;s take a look!\nThe Tool Last year at Black Hat US Arsenal my colleagues and I released part of the source code of DefPloreX, the tool-chain that we use to explore million of web-deface pages. DefPloreX is pretty flexible and, in principle, it could be used to process any web page, for instance those planted as a result of an attack, or to \u0026ldquo;cluster\u0026rdquo; together web pages of underground web sites, and any other e-crime forensics task that requires to \u0026ldquo;make sense\u0026rdquo; out of a large dataset of web pages.\nDefPloreX ingests plain and flat tabular files (e.g., CSV files) containing metadata records of web incidents under analysis (e.g., URLs), renders them and obtains a copy of their resources with headless browsers (we tried basically all of them, but then we settled with Chrome via Puppeteer), extracts numerical features, and stores the resulting data to an Elastic index. We\u0026rsquo;ve designed any task to be distributed by default, using Celery to coordinate them.\nOn top of the Elastic back-end, I\u0026rsquo;ve cooked up a ReactJS-based web-app (which as of now is not part of the open-source release, mainly because the code is very messy) to interactively explore, query, and dig into the data. This allows an analyst to easily investigate on campaigns, for example in discovering websites targeted by the same campaign or attributing one or more actors to the same hacking group. All of this without sacrificing the interactivity aspect of the investigation.\nIf you want to see the web app in action, you can take yourself a 14 minutes coffee or tea break while watching this demo.\n  Distributed Data Processing Normally, to take full advantage of Elastic\u0026rsquo;s distributed data-processing functionality, you need to resort to scripting.\nAlthough scripting is quite powerful and handy for small data-manipulation tasks, it\u0026rsquo;s a bit cumbersome to deploy and handle requires; and, in addition, it requires full access to the Elastic\u0026rsquo;s client nodes. For example, if you need to process all the documents in an Elastic index (e.g., to enrich them by computing additional fields), you will have to choose one of the scripting languages supported by Elastic, write a script, deploy it and run it. Needless to say, your script will run within the context of the ES runtime, with all the limitations that this implies. For example, should you need to use Python, you\u0026rsquo;re forced to use the Jython Java implementation of Python, which is not the same as pure Python. For instance, some of the libraries that you may want to use may not be supported, and so on. In other words, we don\u0026rsquo;t want to depend on the Elastic\u0026rsquo;s scripting subsystem in our work :-)\nInstead, we take a more \u0026ldquo;detached\u0026rdquo; approach. We decouple the data-processing part, making it independent from the Elastic runtime and architecture, and rely on ES exclusively as a data back-end to store, retrieve and modify JSON documents. The coordination of the distributed computation is delegated to a well-known and widely used distributed task queue: Celery. The friendliness of Celery is astonishing: from the programmer\u0026rsquo;s perspective, all it requires is to write your data-processing code by means of a function, and Celery will take care of offloading the (expensive and long-running) computation to one of the available workers.\nFor example, if you need to visit a web page with an automated headless browser, all you need to do is to wrap your code into a function, let\u0026rsquo;s say visit_page, and decorate it with @app.task to inform Celery that this is a task:\n@app.task def visit_page(url): result = long_running_process(url) return result  Later on in your code, all you need to do is to call the function (almost) as you would normally do:\nvisit_page.delay(url)  The .delay() function indicates that the function call will not execute immediately, but instead will be \u0026ldquo;pushed\u0026rdquo; into a task list, from which an available worker will pull it and do the work.\nOn the other end of the task list, you can launch as many workers as you need, by simply keeping the Celery daemon active:\n$ celery worker --autoscale=6,64  Assuming a 64-core machine, this command spawns 6 concurrent processes, up to 64 when more workload comes in. And of course you can add as many workers as needed, from a single computer with a few tenths of cores, to a full rack distributed across the globe. In our deployment, we have 5 machines, with a total of 128 cores. With these modest resources, we were able to visit the entire collection of over 13 million web pages in a week. Adding more cores would have made the analysis even faster.\nDocument Transformations From this moment on, we have a solid foundation to efficiently transform JSON documents stored in the Elastic index. Therefore, we \u0026ldquo;encode\u0026rdquo; any operation that we need to perform in DefPloreX by means of a few lines of Python code. For example, we often need to \u0026ldquo;tag\u0026rdquo; JSON documents to mark those that have been processed. To this end, as exemplified in this repository, we use the TagTransformer transformation. As any other transform, this function receives one JSON document and returns the newly added fields, or the modified fields.\nclass TagTransformer(Transformer): \u0026quot;\u0026quot;\u0026quot; Example transform to append tag to a record. \u0026quot;\u0026quot;\u0026quot; _name = 'tag' # unique name def __call__(self, doc, *args, **kwargs): doc = super(TagTransformer, self).__call__( doc, *args, **kwargs) tag = kwargs.get('tag') # tag that we want to apply to the JSON if not tag: log.debug('No tags supplied, skipping') return [] tags = doc.get('tags', []) # get the 'tags' field from the existing JSON doc if tags: log.debug('Found tags: %s', tags) tags.append(tag) # append the new tag tags = list(set(tags)) # remove duplicates log.debug('Updated tags: %s', tags) return dict(tags=tags) # return the enriched JSON  The output of this transformation is automatically handled by our Elastic wrapper (see backend.elastic.ESStorer) and the transformer.Pipeline class, which merges the new (partial) document with the original one and saves it into the ES index. Actually, this is performed in bulk: that is, every worker consumes and processes a given amount of documents at each round (default is 1000). To summarize: given a query, we enqueue all the IDs of the documents that match that query. The queue consumers will pull 1000 IDs at a time, query Elastic for the respective documents, transform them, and push them back on Elastic as update operations.\nOther transformations that we have implemented (briefly explained in the following) include for example visiting the web pages with an automated, headless browser, extracting information from the visited web pages, calculating numerical features, and so on. Every task is expressed by means of a subclass of Transformer, which takes as input a document, and returns the enriched or modified fields.\nThe White Paper With the help of our great colleagues at TrendLabs, we prepared a white paper that focuses on the major campaigns, and how DefPloreX helped explore them. In particular, we look at 7 campaigns that have affected Israel, France, India, Syria, Kosovo, and countries surrounding the South China Sea. We dig into specific conflicts in those areas and the defacements that happened in the aftermath.\nTo feed our curiosity and~ help CERTs understand better the origin of these attacks and modus-operandi of the groups, we also look how they are organized (some are formed across continents, and some are a loose collection of local hackers), as well as how their recruitment tools and the methods adopt.\nThe Devil Answer is in the Details You might be wondering how exactly the data-mining workflow works, what features we use, what clustering algorithm and so on. For the impatient, here\u0026rsquo;s a quick overview of the data that we process and the features that we extract:\nSo, now, how do we use these features for clustering?\nI\u0026rsquo;m very thankful to Roberto Perdisci for the valuable insights that he provided on this work about the machine-learning and data-mining part. What I\u0026rsquo;m most thankful about, however, is the suggestion to use BIRCH, which I didn\u0026rsquo;t know before. I think this figure speaks by itself.\nImpressive, huh?\nReferences   Federico Maggi, Marco Balduzzi, Ryan Flores, Lion Gu, Vincenzo Ciancaglini  (2018). Investigating Web Defacement Campaigns at Large. Proceedings of the 2018 on Asia Conference on Computer and Communications Security.  PDF  Cite    Marco Balduzzi, Federico Maggi, Vincenzo Ciancaglini, Ryan Flores, Lion Gu  (2017). DefPloreX: A Machine Learning Toolkit for Large-scale e-Crime Forensics.  PDF  Cite   ","date":1528982479,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1528982479,"objectID":"9aabaf6f805c3c42c6f2517c3e29c29e","permalink":"/post/large-scale-deface-page-analysis/","publishdate":"2018-06-14T15:21:19+02:00","relpermalink":"/post/large-scale-deface-page-analysis/","section":"post","summary":"Given the multiple releases around this topic and project, I\u0026rsquo;ve decided to put together a summary. So far, there is: a tool, a white paper, an academic paper, and (spoiler alert) another white paper coming soon.\n","tags":["trendmicro","measurement","web","defacement"],"title":"Large Scale Analysis of Defaced Web Pages","type":"post"},{"authors":["Federico Maggi","Marco Balduzzi","Ryan Flores","Lion Gu","Vincenzo Ciancaglini"],"categories":null,"content":"","date":1528070400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"7b886b9af4c29d5d16de9e92a8986585","permalink":"/publication/maggi_defplorex_2018/","publishdate":"2018-06-04T00:00:00Z","relpermalink":"/publication/maggi_defplorex_2018/","section":"publication","summary":" Website defacement is the practice of altering the web pages of a website after its compromise. The altered pages, calleddeface pages, can negatively affect the reputation and business of the victim site. Previous research has focused primarily on detection, rather than exploring the defacement phenomenon in depth. While investigating several defacements, we observed that the artifacts left by the defacers allow an expert analyst to investigate the actors' modus operandi and social structure, and expand from the single deface page to a group of related defacements (i.e., acampaign ). However, manually performing such analysis on millions of incidents is tedious, and poses scalability challenges. From these observations, we propose an automated approach that efficiently builds intelligence information out of raw deface pages. Our approach streamlines the analysts job by automatically recognizing defacement campaigns, and assigning meaningful textual labels to them. Applied to a comprehensive dataset of 13 million defacement records, from Jan. 1998 to Sept. 2016, our approach allowed us to conduct the first large-scale measurement on web defacement campaigns. In addition, our approach is meant to be adopted operationally by analysts to identify live campaigns on the field.  We go beyond confirming anecdotal evidence. We analyze the social structure of modern defacers, which includes lone individuals as well as actors that cooperate with each others, or with teams, which evolve over time and dominate the scene. We conclude by drawing a parallel between the time line of World-shaping events and defacement campaigns, representing the evolution of the interests and orientation of modern defacers.","tags":null,"title":"Investigating Web Defacement Campaigns at Large","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1523232000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"f96def18dab1e2dc1b927d76c660566d","permalink":"/talk/maggi_iiothmi_talk_2018/","publishdate":"2018-04-09T00:00:00Z","relpermalink":"/talk/maggi_iiothmi_talk_2018/","section":"talk","summary":"Despite the focus on future-generation equipment, legacy industrial machines will continue to exist. In terms of cybersecurity risks, what happens when these machines must be connected? We've answered this question by taking a close look at a previous-generation industrial robot, one of the most widespread industrial machine, used practically in every sector, including for manufacturing. Besides the software vulnerabilities that we have found, which we consider \"natural\" in embedded software, we focused on the root cause of these vulnerabilities and we will discuss our thoughts and practical recommendations with the audience. We will provide a demo of what happens when an attacker compromises an industrial robot, explaining how a software flaw can go all the way down to affecting the quality of the manufactured goods. Beyond robots, the entire factory features more and more embedded systems, which are a critical entry point for an external attacker, and thus need to properly be secured.","tags":null,"title":"The impact of legacy machines on future manufacturing cybersecurity","type":"talk"},{"authors":["Marco Balduzzi","Ryan Flores","Lion Gu","Federico Maggi","Vincenzo Ciancaglini","Roel Reyes","Akira Urano"],"categories":null,"content":"","date":1516579200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"2dfeee6761c4ecb00c88dd13a5a568f8","permalink":"/publication/balduzzi_defplorexwp_tr_2018/","publishdate":"2018-01-22T00:00:00Z","relpermalink":"/publication/balduzzi_defplorexwp_tr_2018/","section":"publication","summary":"Web attacks‚Äîattacks that compromise internet assets like mail servers, cloud infrastructures, and websites‚Äîare troubling phenomena. The research community has put considerable effort into investigating these incidents but has mostly focused on detecting attacks and not delving into the reasons behind these attacks.  Of course, the typical cybercriminal's goal is to profit. They might compromise websites to push ransomware, or they could try and steal data‚Äîrecent breaches show that information is an increasingly valuable commodity. But, as this paper discusses, more emotional motivations, such as patriotism, specific real-world events or simply hacktivism, can also trigger compromises.  Web defacement hacktivism is the practice of subverting a website with the goal of promoting a specific agenda or political ideology. Methods may vary, but when hacktivists compromise a website, the usual tactic involves replacing the original page with their version‚Äîa practice that is called web defacement. Hacktivism is mainly linked to web defacement, but a hacktivist (the attacker) can also be involved in traffic redirection (from a legitimate site to an attackerowned site), denial of service (a form of service disruption), and malware distribution to support their particular cause.  Dedicated websites like Zone-H1 collect evidence of web defacements and defacers can voluntarily advertise their compromise by submitting a report. Elaborating on the reasons behind web defacements at scale is not as easy as it seems. While someone could theorize that geopolitical events and conflicts influence cybercriminals‚Äô attacks against websites and their choice of victims, corroborating this phenomenon requires large-scale analysis.  Our examination of over 13 million web defacement reports against websites spans over 18 years, covering multiple continents. We designed an internal system that gathers, analyzes, and clusters these millions of reports. As we identify the major campaigns of these defacers, we can provide further insights into how geopolitical events are reflected in web defacements. We also look at how different factors, such as the political beliefs and the defacers' religious inclination, can trigger and affect these attacks.  Our first two sections provide high-level insights into our dataset of defacements, as well as some defining facts about the targets and tactics used by the defacers. Our next section on Real World Impact breaks down seven top campaigns that have affected Israel, France, India, Syria, Kosovo, and countries surrounding the South China Sea. We delve into specific conflicts in those areas and the defacements that happened in the aftermath.  The succeeding sections cover the hacking groups' affiliations and how their collectives are organized‚Äîsome collectives are formed across continents, and some are a loose collection of local hackers. Recruitment tools and the methods used to distribute hacking techniques are also discussed.  The final sections discuss other activities that defacers take part in, and how the current activities may evolve. Recently, there have been incidents of hackers who have gone from simple web defacement to activities supporting cybercrime. There is a real possibility that defacers and defacement groups will start to escalate their activities, move away from ideological motivations, and turn into cybercrime. ","tags":null,"title":"A Deep Dive into Defacement: How Geopolitical Events Trigger Web Attacks","type":"publication"},{"authors":[],"categories":[],"content":"Many vulnerabilities in one shot, yet several pre-conditions for a target to be actually exploitable. Here\u0026rsquo;s simple flowchart to check whether your Dnsmasq deployments are vulnerable.\n Dnsmasq is the de-facto tool to implement DNS and DHCP services in small servers and embedded devices. Being Dnsmasq user, when Google Security researchers disclosed the CVE-2017-14491 to 14496 series, I quickly checked whether my installation was vulnerable.\nTurned out that, despite I found a vast amount of devices running a vulnerable version of Dnsmasq, the chain of pre-conditions for these vulnerabilities to be exploitable are not super trivial. So I decided to write them down in a flowchart.\nYou can read the full blog post here!\n","date":1507381764,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1507381764,"objectID":"ad257fa5ba15021fd558cf364162393b","permalink":"/post/dnsmasq/","publishdate":"2017-10-07T15:09:24+02:00","relpermalink":"/post/dnsmasq/","section":"post","summary":"Many vulnerabilities in one shot, yet several pre-conditions for a target to be actually exploitable. Here\u0026rsquo;s simple flowchart to check whether your Dnsmasq deployments are vulnerable.\n","tags":["trendmicro","measurement","vulnerability"],"title":"Dnsmasq and CVE-2017-1449*: A Reality Check and Remediation Practices","type":"post"},{"authors":[],"categories":[],"content":"Industrial robots are complex cyber-physical systems used for manufacturing, and a critical component of any modern factory. Besides the mechanical arm, inside an industrial robot there are not just electromechanical components but a multitude of complex embedded controllers.\nThese embedded controllers are often interconnected with other computers in the factory network, safety systems, and to the Internet for remote monitoring and maintenance. In this scenario, industrial routers also play a key role, because they directly expose the robot\u0026rsquo;s controller. Therefore, the impact of a single, simple vulnerability can grant attackers an easy entry point.\nVideos   \n  Read More   Technical brief: Rogue Robots: Testing the Limits of an Industrial Robot‚Äôs Security\n  Material, F.A.Q., press: http://robosec.org\n  Elevator pitch: Rogue Robots - Testing the Limits of an Industrial Robot‚Äôs Security\n  References   Davide Quarta, Marcello Pogliani, Mario Polino, Federico Maggi, Zanero Stefano  (2017). Breaking the Laws of Robotics: Attacking Industrial Robots.  PDF  Cite    Davide Quarta, Marcello Pogliani, Mario Polino, Federico Maggi, Andrea Maria Zanchettin, Stefano Zanero  (2017). An Experimental Security Analysis of an Industrial Robot Controller. Proceedings of the 38th IEEE Symposium on Security and Privacy.  PDF  Cite   ","date":1504193971,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1504193971,"objectID":"cfc4d3739213b2d73c4b5ddbc7c4af0a","permalink":"/post/robosec/","publishdate":"2017-08-31T17:39:31+02:00","relpermalink":"/post/robosec/","section":"post","summary":"Industrial robots are complex cyber-physical systems used for manufacturing, and a critical component of any modern factory. Besides the mechanical arm, inside an industrial robot there are not just electromechanical components but a multitude of complex embedded controllers.\n","tags":[],"title":"Robosec: Industrial Robot Security","type":"post"},{"authors":["Apostolis Zarras","Federico Maggi"],"categories":null,"content":"","date":1503878400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"24b982456e422cc733d91b7e7f8c6fa1","permalink":"/publication/zarras_sqlbot_2017/","publishdate":"2017-08-28T00:00:00Z","relpermalink":"/publication/zarras_sqlbot_2017/","section":"publication","summary":"It could be argued that without search engines, the web would have never grown to the size that it has today. To achieve maximum coverage and provide relevant results, search engines employ large armies of autonomous crawlers that continuously scour the web, following links, indexing content, and collecting features that are then used to calculate the ranking of each page. In this paper, we describe how autonomous crawlers can be abused by attackers to exploit vulnerabilities on thirdparty websites while hiding the true origin of the attacks. Moreover, we show how certain vulnerabilities on websites that are currently deemed unimportant, can be abused in a way that would allow an attacker to arbitrarily boost the rankings of malicious websites in the search results of popular search engines. Motivated by the potentials of these vulnerabilities, we propose a series of preventive and defensive countermeasures that website owners and search engines can adopt to minimize, or altogether eliminate, the effects of crawler-abusing attacks.","tags":null,"title":"Hiding Behind the Shoulders of Giants: Abusing Crawlers for Indirect Web Attacks","type":"publication"},{"authors":[],"categories":[],"content":"CAN-based protocols are vulnerable to bit-flipping attacks at the link layer. In this collaborative research, Politecnico di Milano\u0026rsquo;s NECSTLab and Trend Micro\u0026rsquo;s FTR analyze the protocol in depth and demonstrate the vulnerability on a real car, with PoC and so on.\nThis project started somewhere between 2015 and 2016. Back then, I was an Assistant Professor at Politecnico di Milano. Together with my colleague Stefano, I was advising this bright Master student, Andrea Palanca, who was basically \u0026ldquo;breathing cars,\u0026rdquo; and really passionate about car hacking. So it made a lot of sense to introduce him to Eric Evencick, who then became part of the project.\nEric had this idea of looking at the link layer of the CAN protocol, given the numerous frame-injection attacks popping up here and there. However, we\u0026rsquo;ve thought, injecting frame in the CAN bus is pretty noisy, and also quite easy to detect with some smart monitoring. Indeed, knowing the network architecture and ECUs attached to it (and, let\u0026rsquo;s be honest, they don\u0026rsquo;t change that often even in a connected car), it\u0026rsquo;s fairly easy to figure out if a frame is out of order, or simply unexpected.\nAndrea then started to dig into the CAN bus standard, using his own car as a playground, and quickly came up with a prototype testbed CAN deployment in the lab, on which he started to explore the effect of flipping \u0026ldquo;the right bit at the right time\u0026rdquo;.\nAlright, enough high-level talking! It\u0026rsquo;s time to take a look at the actual content.\nGimme da Video! In the following short video you can see me presenting the work to an academic audience. True fact: I\u0026rsquo;ve recorded this while preparing my talk for DIMVA 2017.\n  Additional Material If you\u0026rsquo;re curious to know more:\n for an intermediate-level description, you can read our blog post, for a more in-depth piece, head over to the technical brief (PDF), if you\u0026rsquo;re using CAN in your products, you might be interested in our disclosure through the ICS-CERT (ICS-ALERT-17-209-01).  References  Andrea Palanca, Eric Evenchick, Federico Maggi, Stefano Zanero  (2017). A Stealth, Selective, Link-Layer Denial-of-Service Attack Against Automotive Networks. Proceedings of the 14th International Conference on Detection of Intrusions and Malware, and Vulnerability Assessment (DIMVA).  PDF  Cite  ","date":1502880544,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1502880544,"objectID":"1a0ee93c484f08b6cec4900d85bfc159","permalink":"/post/candos/","publishdate":"2017-08-16T12:49:04+02:00","relpermalink":"/post/candos/","section":"post","summary":"CAN-based protocols are vulnerable to bit-flipping attacks at the link layer. In this collaborative research, Politecnico di Milano\u0026rsquo;s NECSTLab and Trend Micro\u0026rsquo;s FTR analyze the protocol in depth and demonstrate the vulnerability on a real car, with PoC and so on.\n","tags":["cars","vulnerability","trendmicro","polimi","dimva17","paper"],"title":"From a Bit-flipping to a Vulnerability in the CAN Standard","type":"post"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1501545600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"f1966b0176e2004b50960a3609f82de8","permalink":"/publication/maggi_candoswp_tr_2017/","publishdate":"2017-08-01T00:00:00Z","relpermalink":"/publication/maggi_candoswp_tr_2017/","section":"publication","summary":"This research is a joint effort between Politecnico di Milano, Linklayer Labs, and Trend Micro's FTR. In this report, we describe a vulnerability in modern cars‚Äô networks that allows a completely stealthy denial-of-service attack which is undetectable by current security mechanisms and works for every automotive vendor. This attack differs drastically from other previously reported car hacks because it does not exploit easily patchable software vulnerabilities. Rather, the element exploited is a design flaw, which is thus fundamentally hard to solve, in the standard that defines how in-vehicle networks work.  This attack was presented at the 2017 international conference on Detection of Intrusions and Malware \u0026 Vulnerability Assessment (DIMVA) in Bonn (Jul 6‚Äì7). Prior to that, we coordinated with the ICS-CERT, which promptly disseminated an alert (ICS-ALERT-17-209-01).","tags":null,"title":"A Vulnerability in Modern Automotive Standards and How We Exploited It","type":"publication"},{"authors":["Tommi Unruh","Bhargava Shastry","Malte Skoruppa","Federico Maggi","Konrad Rieck","Jean-Pierre Seifert","Fabian Yamaguchi"],"categories":null,"content":"","date":1501545600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348198,"objectID":"89b6fdf0fd9d4aaccb1f3146a3c0249c","permalink":"/publication/unruh_joernphp_2017/","publishdate":"2017-08-01T00:00:00Z","relpermalink":"/publication/unruh_joernphp_2017/","section":"publication","summary":"The Web is replete with tutorial-style content on how to accomplish programming tasks. Unfortunately, even top-ranked tutorials suffer from severe security vulnerabilities, such as cross-site scripting (XSS), and SQL injection (SQLi). Assuming that these tutorials influence real-world software development, we hypothesize that code snippets from popular tutorials can be used to bootstrap vulnerability discovery at scale. To validate our hypothesis, we propose a semi-automated approach to find recurring vulnerabilities starting from a handful of top-ranked tutorials that contain vulnerable code snippets. We evaluate our approach by performing an analysis of tens of thousands of open-source web applications to check if vulnerabilities originating in the selected tutorials recur. Our analysis framework has been running on a standard PC, analyzed 64,415 PHP codebases hosted on GitHub thus far, and found a total of 117 vulnerabilities that have a strong syntactic similarity to vulnerable code snippets present in popular tutorials. In addition to shedding light on the anecdotal belief that programmers reuse web tutorial code in an ad hoc manner, our study finds disconcerting evidence of insufficiently reviewed tutorials compromising the security of open-source projects. Moreover, our findings testify to the feasibility of large-scale vulnerability discovery using poorly written tutorials as a starting point.","tags":["workshop"],"title":"Leveraging Flawed Tutorials for Seeding Large-Scale Web Vulnerability Discovery","type":"publication"},{"authors":["Bhargava Shastry","Federico Maggi","Fabian Yamaguchi","Konrad Rieck","Jean-Pierre Seifert"],"categories":null,"content":"","date":1501545600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348198,"objectID":"9be91f0faf3c0dd46f9cbdbb0ca02860","permalink":"/publication/shastry_hybridstaticfuzzing_2017/","publishdate":"2017-08-01T00:00:00Z","relpermalink":"/publication/shastry_hybridstaticfuzzing_2017/","section":"publication","summary":"Taint-style vulnerabilities comprise a majority of fuzzer discovered program faults. These vulnerabilities usually manifest as memory access violations caused by tainted program input. Although fuzzers have helped uncover a majority of taint-style vulnerabilities in software to date, they are limited by (i) extent of test coverage; and (ii) the availability of fuzzable test cases. Therefore, fuzzing alone cannot provide a high assurance that all taint-style vulnerabilities have been uncovered.  In this paper, we use static template matching to find recurrences of fuzzer-discovered vulnerabilities. To compensate for the inherent incompleteness of template matching, we implement a simple yet effective match-ranking algorithm that uses test coverage data to focus attention on matches comprising untested code. We prototype our approach using the Clang/LLVM compiler toolchain and use it in conjunction with afl-fuzz, a modern coverage-guided fuzzer. Using a case study carried out on the Open vSwitch codebase, we show that our prototype uncovers corner cases in modules that lack a fuzzable test harness. Our work demonstrates that static analysis can effectively complement fuzz testing, and is a useful addition to the security assessment tool-set. Furthermore, our techniques hold promise for increasing the effectiveness of program analysis and testing, and serve as a building block for a hybrid vulnerability discovery framework.","tags":["workshop"],"title":"Static Exploration of Taint-Style Vulnerabilities Found by Fuzzing","type":"publication"},{"authors":["Davide Quarta","Marcello Pogliani","Mario Polino","Federico Maggi","Zanero Stefano"],"categories":null,"content":"","date":1501113600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"3181c9b7601c6122808cda71bf929a44","permalink":"/talk/quarta_robosecbhus_talk_2017/","publishdate":"2017-07-27T00:00:00Z","relpermalink":"/talk/quarta_robosecbhus_talk_2017/","section":"talk","summary":"Industrial robots are complex cyber-physical systems used for manufacturing, and a critical component of any modern factory. These robots aren't just electromechanical devices but include complex embedded controllers, which are often interconnected with other computers in the factory network, safety systems, and to the Internet for remote monitoring and maintenance. In this scenario, industrial routers also play a key role, because they directly expose the robot's controller. Therefore, the impact of a single, simple vulnerability can grant attackers an easy entry point.  Industrial robots must follow three fundamental laws: accurately \"read\" from the physical world through sensors and \"write\" (i.e. perform actions) through actuators, refuse to execute self-damaging control logic, and most importantly, echoing Asimov, never harm humans. By combining a set of vulnerabilities we discovered on a real robot, we will demonstrate how remote attackers are able to violate such fundamental laws up to the point where they can alter the manufactured product, physically damage the robot, steal industry secrets, or injure humans.  We will cover in-depth technical aspects (e.g., reverse engineering and vulnerability details, and attack PoCs), alongside a broader discussion on the security posture of industrial routers and robots: Why these devices are attractive for attackers? What could they achieve? Are they hard to compromise? How can their security be improved?","tags":null,"title":"Breaking the Laws of Robotics: Attacking Industrial Robots","type":"talk"},{"authors":["Marco Balduzzi","Federico Maggi","Vincenzo Ciancaglini","Ryan Flores","Lion Gu"],"categories":null,"content":"","date":1501113600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"06019df8a0c393541d5e7b8ce7483645","permalink":"/talk/balduzzi_defplorexbhus_talk_2017/","publishdate":"2017-07-27T00:00:00Z","relpermalink":"/talk/balduzzi_defplorexbhus_talk_2017/","section":"talk","summary":"The security industry as a whole---including operation centers, providers and telcos---loves collecting data. Researchers are not different! A sort of common feeling is that the more data someone collects, the more self-confident he becomes about, say, a threat or another phenomenon. However, large volumes of data imply more processing resources needed, especially in extracting meaningful and useful information if the data is highly unstructured. As a result, manual data analysis is often the only choice, with security professionals like pen-testers, reversers and analysts processing data through tedious repetitive operations.  Given this situation, and our research lab suffering from similar problems, we have spent the first half of 2017 implementing a flexible toolkit based on open-source libraries for efficiently analyzing millions of deface pages and web incidents. Our tool, DefPloreX, uses a combination of machine-learning and visualization techniques to practically turn original unstructured data into meaningful high-level descriptions. Real-time information on incidents, breaches, attacks and vulnerabilities, for example, are efficiently processed and condensed into objects that are easily browsable -- making them suitable for efficient large-scale eCrime forensics and investigations.  DefPloreX ingests plain CSV inputs about web incidents to analyze, explores their resources with headless browsers, extracts features from deface pages, and uploads the resulting data to an Elastic index. Distributed headless browsers are coordinated via Celery. Using Python Panda, NumPy and PyTables, DefPloreX provides offline \"views\" of the data, allowing easy pivoting and exploration. Our toolkit automatically groups similar deface pages in clusters and organizes web incidents in campaigns. Requiring only one pass, clustering is intrinsically parallel and not memory bound. DefPloreX offers text- and web-based UIs, which can be queried using a simple language for investigations and forensics.","tags":null,"title":"DefPloreX: A Machine Learning Toolkit for Large-scale e-Crime Forensics","type":"talk"},{"authors":["Andrea Continella","Alessandro Guagnelli","Giovanni Zingaro","Giulio De Pasquale","Alessandro Barenghi","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1501113600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"e429e4e87d1315f2f117522e10a48cc1","permalink":"/talk/continella_shieldfsbhus_talk_2017/","publishdate":"2017-07-27T00:00:00Z","relpermalink":"/talk/continella_shieldfsbhus_talk_2017/","section":"talk","summary":"Preventive and reactive security measures can only partially mitigate the damage caused by modern ransomware attacks. The remarkable amount of illicit profit and the cybercriminals' increasing interest in ransomware schemes demonstrate that current defense solutions are failing, and a large number of users are actually paying the ransoms. In fact, pure-detection approaches (e.g., based on analysis sandboxes or pipelines) are not sufficient, because, when luck allows a sample to be isolated and analyzed, it is already too late for several users! Moreover, modern ransomware implements several techniques to prevent detection by common AV. Similarly, for performance reasons, backups leave a small-but-important window of recent files unprotected.  We believe that a forward-looking solution is to equip modern operating systems with generic, practical self-healing capabilities against this serious threat.  In this talk, we will present ShieldFS, a drop-in driver that makes the Windows native filesystem immune to ransomware attacks, even when detection fails ShieldFS dynamically toggles a protection layer that acts as a copy-on-write mechanism whenever its detection component reveals suspicious activity. For this, ShieldFS monitors the filesystem's internals to update a set of adaptive models that profile the system activity over time. This detection is based on a study of the filesystem activity of over 2,245 applications, and takes into account the entropy of write operations, frequency of read, write, and folder-listing operations, fraction of files renamed, and the file-type usage statistics. Additionally, ShieldFS monitors the memory pages of each \"potentially malicious\" process, searching for traces of the typical block cipher key schedules.  We will show how ShieldFS can shadow the write operations. Whenever one or more processes violate our detection component, their operations are deemed malicious and the side effects on the filesystem are transparently rolled back.  Last, we will demo how effective ShieldFS is against samples from state of the art ransomware families, showing that it is able to detect the malicious activity at runtime and transparently recover all the original files.","tags":null,"title":"ShieldFS: The Last Word in Ransomware-resilient File Systems","type":"talk"},{"authors":["Andrea Palanca","Eric Evenchick","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1499299200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"5b084ebcb106f56d564967c5d2511e24","permalink":"/publication/palanca_candos_2017/","publishdate":"2017-07-06T00:00:00Z","relpermalink":"/publication/palanca_candos_2017/","section":"publication","summary":"Modern vehicles incorporate tens of electronic control units (ECUs), driven by as much as 100,000,000 lines of code. They are tightly interconnected via internal networks, mostly based on the CAN bus standard. Past research showed that, by obtaining physical access to the network or by remotely compromising a vulnerable ECU, an attacker could control even safety-critical inputs such as throttle, steering or brakes. In order to secure current CAN networks from cyberattacks, detection and prevention approaches based on the analysis of transmitted frames have been proposed, and are generally considered the most time- and cost-effective solution, to the point that companies have started promoting aftermarket products for existing vehicles.","tags":null,"title":"A Stealth, Selective, Link-Layer Denial-of-Service Attack Against Automotive Networks","type":"publication"},{"authors":[],"categories":[],"content":"The goal of this project is to extract signatures that capture the WebInject behavior of trojans. WebInject-based trojans are still the most popular e-crime tool.\nPrometheus (formerly Zarathustra) is based on a technique that we call web page differential analysis, which extracts and generates a model of the differences between a web page visited from an infected (virtual) machine and the very same page visited from a clean machine. These differences are unavoidable for the malware to carry out its functionality, and thus allow to create robust indicators of compromise. We generalize these differences using custom heuristics to reduce the chances of false positives.\nReferences  Andrea Continella, Michele Carminati, Mario Polino, Andrea Lanzi, Stefano Zanero, Federico Maggi  (2017). Prometheus: Analyzing WebInject-based information stealers. Journal of Computer Security.  Cite    Claudio Criscione, Fabio Bosatelli, Stefano Zanero, Federico Maggi  (2014). Zarathustra: Extracting WebInject Signatures from Banking Trojans. Proceedings of the Twelfth Annual International Conference on Privacy, Security and Trust (PST).  PDF  Cite  ","date":1497281659,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1497281659,"objectID":"77adfb231f6efcc16e02d0c5ca103753","permalink":"/post/prometheus/","publishdate":"2017-06-12T17:34:19+02:00","relpermalink":"/post/prometheus/","section":"post","summary":"The goal of this project is to extract signatures that capture the WebInject behavior of trojans. WebInject-based trojans are still the most popular e-crime tool.\n","tags":[],"title":"Prometheus: Automatic signature generation for WebInject-based banking trojan detection","type":"post"},{"authors":[],"categories":[],"content":"Industrial routers play a very crucial role: a single vulnerability can grant the attacker access to an entire network of critical machines. In this research, I\u0026rsquo;ve looked at how easy it is for a hypothetical attacker to find and enumerate industrial routers, and the security posture of their vendors.\nIndustrial routers aren\u0026rsquo;t just regular routers in a rugged case. They are the gateway to networks of machines, which usually end up interacting with the physical world. Think about connected vehicles, factories, robots, and so on.\nWhile working on a remote access box (another name for \u0026ldquo;industrial router\u0026rdquo;), during our industrial robots research, we noticed that the web-admin panel had an authentication-bypass vulnerability. Upon reporting the vulnerability to the vendor, which patched it right away, we\u0026rsquo;ve wondered: are there other vendors? What\u0026rsquo;s the state of security in this area?\nAfter going through the \u0026ldquo;Switches Get Stitches\u0026rdquo; talks ( 44CON 2014, 31C3 2014, Black Hat US 2015), we had some bad feelings about industrial routers too, so we\u0026rsquo;ve started to collect technical resources like manuals and firmware update files, and crafted Shodan and Censys search strings to see how many of these routers were directly exposed to a casual attacker.\nThe first thing that we\u0026rsquo;ve noticed was the abundance of technical information freely available to the public. Don\u0026rsquo;t get me wrong: I\u0026rsquo;m not advocating in favor of \u0026ldquo;security through obscurity\u0026rdquo; nor \u0026ldquo;closed source\u0026rdquo;. Once I believe in openness, I also believe that critical targets like industrial routers (which are put in front of supposedly critical machinery), shouldn\u0026rsquo;t be that easy for a casual attacker to discover. Ironically, marketing brochures required a registration, whereas firmware and technical manuals were directly indexed by search engines and publicly accessible.\nGiven the security posture of some vendors, we\u0026rsquo;ve decided to take a broad look at all of them, both from a reconnaissance and vulnerability viewpoint.\nIf you\u0026rsquo;re curious, head over to the full article on TrendLab\u0026rsquo;s Security Intelligence Blog.\n","date":1493807986,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1493807986,"objectID":"2a926f4fb8178aed3e2d04a61d14d7d6","permalink":"/post/industrial-routers/","publishdate":"2017-05-03T12:39:46+02:00","relpermalink":"/post/industrial-routers/","section":"post","summary":"Industrial routers play a very crucial role: a single vulnerability can grant the attacker access to an entire network of critical machines. In this research, I\u0026rsquo;ve looked at how easy it is for a hypothetical attacker to find and enumerate industrial routers, and the security posture of their vendors.\n","tags":["vulnerability","trendmicro","iiot","routers","industry"],"title":"The Role of Industrial Routers in Keeping the Future Factory Secure","type":"post"},{"authors":["Andrea Continella","Michele Carminati","Mario Polino","Andrea Lanzi","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1493683200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591521330,"objectID":"8046a9cb2e72effa5583bbcbe462b685","permalink":"/publication/continella_prometheus_article_2017/","publishdate":"2017-05-02T00:00:00Z","relpermalink":"/publication/continella_prometheus_article_2017/","section":"publication","summary":"Nowadays Information stealers are reaching high levels of sophistication. The number of families and variants observed increased exponentially in the last years. Furthermore, these trojans are sold on underground markets along with automatic frameworks that include web-based administration panels, builders and customization procedures. From a technical point of view such malware is equipped with a functionality, called WebInject, that exploits API hooking techniques to intercept all sensitive data in a browser context and modify web pages on infected hosts. In this paper we propose Prometheus, an automatic system that is able to analyze trojans that base their attack technique on DOM modifications. Prometheus is able to identify the injection operations performed by malware, and generate signatures based on the injection behavior. Furthermore, it is able to extract the WebInject targets by using memory forensic techniques. We evaluated Prometheus against real-world, online websites and a dataset of distinct variants of financial trojans. In our experiments we show that our approach correctly recognizes known variants of WebInject-based malware and successfully extracts the WebInject targets. ","tags":null,"title":"Prometheus: Analyzing WebInject-based information stealers","type":"publication"},{"authors":["Davide Quarta","Marcello Pogliani","Mario Polino","Federico Maggi","Andrea Maria Zanchettin","Stefano Zanero"],"categories":null,"content":"","date":1493596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"56949984e402ea4d0c19acf433fa4a9f","permalink":"/publication/quarta_robosec_2017/","publishdate":"2017-05-01T00:00:00Z","relpermalink":"/publication/quarta_robosec_2017/","section":"publication","summary":"Industrial robots, automated manufacturing, and efficient logistics processes are at the heart of the upcoming fourth industrial revolution. While there are seminal studies on the vulnerabilities of cyber-physical systems in the industry, as of today there has been no systematic analysis of the security of industrial robot controllers. We examine the standard architecture of an industrial robot and analyze a concrete deployment from a systems security standpoint. Then, we propose an attacker model and confront it with the minimal set of requirements that industrial robots should honor: precision in sensing the environment, correctness in execution of control logic, and safety for human operators. Following an experimental and practical approach, we then show how our modeled attacker can subvert such requirements through the exploitation of software vulnerabilities, leading to severe consequences that are unique to the robotics domain. We conclude by discussing safety standards and security challenges in industrial robotics.","tags":null,"title":"An Experimental Security Analysis of an Industrial Robot Controller","type":"publication"},{"authors":["Federico Maggi","Davide Quarta","Marcello Pogliani","Mario Polino","Andrea M. Zanchettin","Stefano Zanero"],"categories":null,"content":"","date":1493596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"7f81a5c339f7abd713948c80b49a15a3","permalink":"/publication/maggi_robotswp_tr_2017/","publishdate":"2017-05-01T00:00:00Z","relpermalink":"/publication/maggi_robotswp_tr_2017/","section":"publication","summary":"Vulnerabilities in protocols and software running industrial robots are by now widely known, but to date, there has been no in-depth, hands-on research that demonstrates to what extent robots can actually be compromised. For the first time, with this research‚Äîa collaboration between Politecnico di Milano (POLIMI) and the Trend Micro Forward-Looking Threat Research (FTR) Team‚Äîwe have been able to analyze the impact of system-specific attacks and demonstrate attack scenarios on actual standard industrial robots in a controlled environment. In industrial devices, the impact of a single, simple software vulnerability can already have serious consequences. Depending on the actual setup and security posture of the targeted smart factory, attackers could trigger attacks that could amount to massive financial damage to the company in question or at worst, even affect critical goods. Almost all industry sectors that are critical for a nation are potentially at risk.  Unfortunately, the Industry 4.0 revolution is just bringing industrial robots closer to the forefront. As improvements in the way industrial robots work and communicate increase their complexity and interconnectedness, the industrial robots sector unlocks a broader attack surface. In our security analysis, we found that the software running on these devices is outdated; based on vulnerable OSs and libraries, sometimes relying on obsolete or cryptographic libraries; and have weak authentication systems with default, unchangeable credentials. Additionally, the Trend Micro FTR Team found tens of thousands of industrial devices residing on public IP addresses, which could include exposed industrial robots, further increasing the risk that an attacker can access and hack them.  The impact of vulnerabilities, for example on robots, is what makes our findings a very loud wake-up call for the industrial control systems (ICS) sector. To quantify such impact, our security analysis revealed that industrial robots must follow three fundamental laws‚Äîaccurately ‚Äúread‚Äù from the physical world through sensors and ‚Äúwrite‚Äù (i.e., perform actions) through motors and tools, refuse to execute self-damaging control logic, and most importantly, echo one of the ‚ÄúLaws of Robotics‚Äù (devised by Isaac Asimov, a popular science writer) to never harm humans. Then, by combining the set of vulnerabilities that we discovered on a real, standard robot installed in our laboratory, we demonstrated how remote attackers can violate such fundamental laws up to the point where they can alter or introduce minor defects in the manufactured product, physically damage the robot, steal industry secrets, or injure humans. We then considered some threat scenarios on how attackers capitalized on these attacks, as in an act of sabotage or a ransomware-like scheme.  On the one hand, industrial devices are designed according to strict physical security and safety standards in order to work in rough conditions with extreme temperature ranges, vibrations, and electromagnetic noise. On the other, because of the ubiquity and flexibility demanded by the Industry 4.0 trend, industrial devices are being designed to be flexible, easy to deploy, and to not necessarily require any special security or IT skills. These opposing design requirements make producers very prone to introducing software bugs.  Rather than concluding this paper with a classic checklist for ICS vendors, we reflected on reasons why the situation has not changed much over the years. Thus, we provided a series of research and engineering challenges that we believe will make a difference in the journey to secure the Industry 4.0 ecosystem. On this journey toward improving the security posture of robots in the Industry 4.0 setting, we also began reaching out to vendors, among whom ABB Robotics stood out in that it readily welcomed suggestions we had to offer and even started working on a response plan that will affect its current product line without losing time.","tags":null,"title":"Rogue Robots: Testing the Limits of an Industrial Robot‚Äôs Security","type":"publication"},{"authors":["Vasilios Mavroudis","Shuang Hao","Yanick Fratantonio","Federico Maggi","Christopher Kruegel","Giovanni Vigna"],"categories":null,"content":"","date":1491264000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"ebfb6c7fa82c5012294b44e36e23578e","permalink":"/publication/mavroudis_ubeacsec_2017/","publishdate":"2017-04-04T00:00:00Z","relpermalink":"/publication/mavroudis_ubeacsec_2017/","section":"publication","summary":"Nowadays users often possess a variety of electronic devices for communication and entertainment. In particular, smartphones are playing an increasingly central role in users‚Äô lives: Users carry them everywhere they go and often use them to control other devices. This trend provides incentives for the industry to tackle new challenges, such as cross-device authentication, and to develop new monetization schemes. A new technology based on ultrasounds has recently emerged to meet these demands. Ultrasound technology has a number of desirable features: it is easy to deploy, flexible, and inaudible by humans. This technology is already utilized in a number of different real-world applications, such as device pairing, proximity detection, and cross-device tracking.  This paper examines the different facets of ultrasound-based technology. Initially, we discuss how it is already used in the real world, and subsequently examine this emerging technology from the privacy and security perspectives. In particular, we first observe that the lack of OS features results in violations of the principle of least privilege: an app that wants to use this technology currently needs to require full access to the device microphone. We then analyse real-world Android apps and find that tracking techniques based on ultrasounds suffer from a number of vulnerabilities and are susceptible to various attacks. For example, we show that ultrasound cross-device tracking deployments can be abused to perform stealthy deanonymization attacks (e.g., to unmask users who browse the Internet through anonymity networks such as Tor), to inject fake or spoofed audio beacons, and to leak a user‚Äôs private information.  Based on our findings, we introduce several defense mechanisms. We first propose and implement immediately deployable defenses that empower practitioners, researchers, and everyday users to protect their privacy. In particular, we introduce a browser extension and an Android permission that enable the user to selectively suppress frequencies falling within the ultrasonic spectrum. We then argue for the standardization of ultrasound beacons, and we envision a flexible OS-level API that addresses both the effortless deployment of ultrasound-enabled applications, and the prevention of existing privacy and security problems.","tags":null,"title":"On the Privacy and Security of the Ultrasound Ecosystem","type":"publication"},{"authors":[],"categories":[],"content":"The day before the EyePyramid case exploded, I received a confidential email with a PDF. It was the scanned copy of the court order for the law enforcement to proceed and arrest the Occhionero brothers. In a few minutes, I noticed that this leaked document was also circulating on various private mailing lists and chat groups I\u0026rsquo;m part of. At some point, I received a non-redacted copy.\nIt seems that your browser cannot display the PDF file; Please use this link  instead. Thanks!   I typically do not work on e-crime investigation cases, but while reading the court order I felt that something was not completely right. Moreover, the case was in Italy, my home country, which motivated me to look at it. Then, some colleagues from Trend Micro Italy contacted me with questions coming from our clients (for which, back then, I couldn\u0026rsquo;t answer yet). So, at the end of the day I decided to dive in!\nPuzzling Facts in the Court Order I skimmed through the court order and was surprised by the vast amount of technical evidence provided to support the accusations. Email addresses (in clear or easy to guess when redacted), IP addresses, domain names. So detailed that I could basically write a Yara rule to hunt for malware samples, without even looking at a single binary.\nAnd then, the part that puzzled me most. The author of the malware used a licensed software library and allegedly purchased the license under the name of Giulio Occhionero (one of the two brothers). It\u0026rsquo;s like, leaving your name on the crime scene!\n(Almost) Live Reversing After getting my hands on some samples (yes, with Yara hunting rules based on the court order), things escalated quickly, and found myself looking at nearly 250 samples. With the help of my fine colleagues, we\u0026rsquo;ve drawn rough, big picture of the whole scheme and started to find confirmatory evidence.\nIn a few hours, people on Twitter and other social networks started to follow the case closely, comment on it, give their own views. Given some confusion, I felt the urge to publish a list of \u0026ldquo;cold, simple, yet true\u0026rdquo; technical facts. So I\u0026rsquo;ve spun up a GitHub Gist (now deleted), which then evolved in a full repository (now not updated anymore), and finally a post on Medium (in Italian). Results were popping up rapidly, so I found myself unable to keep up with the pace, and decided to stop \u0026ldquo;live reversing\u0026rdquo; the samples, set aside some time and prepare two comprehensive posts for TrendLab\u0026rsquo;s Intelligence Blog, which my employer was very happy to release in no time.\n Jan 18, 2017 - Uncovering the Inner Workings of EyePyramid Jan 11, 2017 - The Eye of the Storm: A Look at EyePyramid, the Malware Supposedly Used in High-Profile Hacks in Italy  Summary of the Case On the one hand, the original source code had gone through only very mild modifications (e.g., not all variants are able to exfiltrate Skype conversations, C\u0026amp;C and dropzones, compiler version, and protection mechanisms). On the other hand, the computer(s) used to build the various versions over the years seemed to be in line with the evolution of Microsoft developer tools (based on the progression of the compiler version) and software-protection tools (as seen on the recent substitution of Skater plus Dotfuscator with the more powerful ConfuserEx). This indicates that the actors behind this operation knew what they were doing. Of course, this was (and still) far from being an advanced or targeted piece of malware.\nApart from this, the origins of EyePyramid‚Äôs malware and its attribution remain a mystery. While the license key registered to Giulio Occhionero‚Äôs name can be considered as strong evidence, it is unclear why a malware author would bother using (simple yet not so trivial) mechanisms to cover their traces (e.g., obfuscation, packing, encryption, disabling security tools), and then mistakenly embed the license key under his name in all of the main variants. Moreover, an analysis of the domain-to-IP historical data of the domain names listed in the court order reveals domains named occhionero.com and occhionero.info, which is again another oddity.\nLatest Update (Just Another Oddity) I received an unexpected email message from someone I\u0026rsquo;ve never heard before. Despite the author of this email is not known in the cyber security community (he presented himself as a PhD Student in medicine at Stanford), he took the time (and money) to verify every single email address written in my analysis and in the court order.\nUsing LeakedSource (now taken down) he had found that one of the compromised email addresses (lu_1974[@]hotmail.com, which is linked to EyePyramid) was used to register on various dating sites. LeakedSource was borderline websites that hosted stolen information, including usernames and passwords.\n ‚Äúthis is probably just a coincidence‚Äù he said but ‚ÄúGiulio also used his @westlands.com address to register to the same dating sites.‚Äù\n Anyways, I\u0026rsquo;ve replied back, thanking him for his work. Then I\u0026rsquo;ve asked him why a Stanford PhD Student in medicine was so interested in such ‚Äúniche‚Äù case (unfolded from the other side of the world), and how he knew that Giulio Occhionero had used his @westlands.com address to register to the same dating sites, because I could not find any evidence about it\nI\u0026rsquo;ve never gotten a reply.\nMedia After getting in touch with Carola Frediani, who did a very good job consolidating all the facts for La Stampa ( Tutti i dettagli e i misteri di EyePyramid), I happily joined the hacker\u0026rsquo;s corner at the International Journalism Festival 2017 in Perugia, a few months later, in a panel moderated by Carola. Here\u0026rsquo;s the recording of the panel.\n ","date":1484734571,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591352171,"objectID":"fde6658c41aade1c635d78748d63486b","permalink":"/post/eyepyramid/","publishdate":"2017-01-18T12:16:11+02:00","relpermalink":"/post/eyepyramid/","section":"post","summary":"The day before the EyePyramid case exploded, I received a confidential email with a PDF. It was the scanned copy of the court order for the law enforcement to proceed and arrest the Occhionero brothers. In a few minutes, I noticed that this leaked document was also circulating on various private mailing lists and chat groups I\u0026rsquo;m part of. At some point, I received a non-redacted copy.\n","tags":["malware","espionage","italy","trendmicro"],"title":"What we Know About Eyepyramid","type":"post"},{"authors":[],"categories":[],"content":"I\u0026rsquo;ve started this project while advising a Master student who was interested in machine learning. As I\u0026rsquo;ve been using machine learning since around 2006, I was immediately hooked by the idea of using it to determine whether an Android app was trying to lock the target device as part of a ransomware scheme.\nThere are three core characteristics that are unavoidable for any ransomware scheme, which can be all boiled down to the \u0026ldquo;business\u0026rdquo; need of \u0026ldquo;being noisy\u0026rdquo; and evident. It\u0026rsquo;s true right? For the first time we see malware that is no longer trying to hide. Instead, it needs to loudly announce its presence to the victim, in order for the business model to work. If the victim is not aware of what is happening and is not effectively guided to the payment screen, the infection is useless.\nTherefore, any ransomware needs to:\n encrypt or lock access to important data, announce its presence to the user and, guide them through the payment options.  These three features have to be implemented by a ransomware sample, and thus have to be visible somehow in the code. Around this key observation, together with the evil genius Nicol√≤ Andronio (the aforementioned Master student) and my partner-in-crime Stefano, we devised and open-sourced HelDroid, a fully automatic APK analyzer that, using static flow analysis, detects whether an app contains evidence of ransomware behavior.\nEarlier this summer I\u0026rsquo;ve joined Trend Micro\u0026rsquo;s research team, and immediately got my hands onto MARS, its Mobile App Reputation Service, which allowed me to build a good retrospective view of how Android ransomware have evolved.\nThis work granted me a speaking slot at the Black Hat Europe Briefings, where I had the opportunity to present the results to a room packed with attendees. Was a great experience!\nIf you\u0026rsquo;re curious, you can read a summarized version of the research in these two blog posts:\n  Mobile Ransomware: Pocket-Sized Badness  Mobile Ransomware: How to Protect Against It  Here\u0026rsquo;s the web service (archived) in case you want to check it out.\nReferences   Chenghyu Zheng, Nicola Della Rocca, Niccol√≤ Andronio, Stefano Zanero, Maggi Federico  (2016). GreatEatlon: Fast, Static Detection of Mobile Ransomware.  PDF  Cite    Niccol√≤ Andronio, Stefano Zanero, Federico Maggi  (2015). HelDroid: Dissecting and Detecting Mobile Ransomware. International Symposium on Research in Attacks, Intrusions and Defenses (RAID).  PDF  Cite   ","date":1481153535,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1481153535,"objectID":"df7d525539635931cf5decdaddef1364","permalink":"/post/mobile-ransomware/","publishdate":"2016-12-08T01:32:15+02:00","relpermalink":"/post/mobile-ransomware/","section":"post","summary":"I\u0026rsquo;ve started this project while advising a Master student who was interested in machine learning. As I\u0026rsquo;ve been using machine learning since around 2006, I was immediately hooked by the idea of using it to determine whether an Android app was trying to lock the target device as part of a ransomware scheme.\n","tags":["android","mobile","ransomware","bheu16","trendmicro"],"title":"Mobile (Android) Ransomware","type":"post"},{"authors":["Andrea Continella","Alessandro Guagnelli","Giovanni Zingaro","Giulio De Pasquale","Alessandro Barenghi","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1480550400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"c7c34cd3c2ca27521c2fc6cebca0f6d9","permalink":"/publication/continella_shieldfs_2016/","publishdate":"2016-12-01T00:00:00Z","relpermalink":"/publication/continella_shieldfs_2016/","section":"publication","summary":"Preventive and reactive security measures can only partially mitigate the damage caused by modern ransomware attacks. Indeed, the remarkable amount of illicit profit and the cybercriminals‚Äô increasing interest in ransomware schemes suggest that a fair number of users are actually paying the ransoms. Unfortunately, pure-detection approaches (e.g., based on analysis sandboxes or pipelines) are not sufficient nowadays, because often we do not have the luxury of being able to isolate a sample to analyze, and when this happens it is already too late for several users! We believe that a forwardlooking solution is to equip modern operating systems with practical self-healing capabilities against this serious threat. Towards such a vision, we propose ShieldFS, an add-on driver that makes the Windows native filesystem immune to ransomware attacks. For each running process, ShieldFS dynamically toggles a protection layer that acts as a copy-onwrite mechanism, according to the outcome of its detection component. Internally, ShieldFS monitors the low-level filesystem activity to update a set of adaptive models that profile the system activity over time. Whenever one or more processes violate these models, their operations are deemed malicious and the side effects on the filesystem are transparently rolled back.  We designed ShieldFS after an analysis of billions of low-level, I/O filesystem requests generated by thousands of benign applications, which we collected from clean machines in use by real users for about one month. This is the first measurement on the filesystem activity of a large set of benign applications in real working conditions. We evaluated ShieldFS in real-world working conditions on real, personal machines, against samples from state of the art ransomware families. ShieldFS was able to detect the malicious activity at runtime and transparently recover all the original files. Although the models can be tuned to fit various filesystem usage profiles, our results show that our initial tuning yields high accuracy even on unseen samples and variants.","tags":null,"title":"ShieldFS: A Self-healing, Ransomware-aware Filesystem","type":"publication"},{"authors":["Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1478131200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"c23c71c915fa9e2b9e1919bd6e75e6db","permalink":"/talk/maggi_greateatlonbheu_talk_2016/","publishdate":"2016-11-03T00:00:00Z","relpermalink":"/talk/maggi_greateatlonbheu_talk_2016/","section":"talk","summary":"While we have grown accustomed to stealthy malware, specifically written to gain and maintain control of the victim machines to abuse their resources, ransomware really comes as a \"plot twist\"! After 10+ years of stealthy malware, spread mainly for building botnets and steal information, for the second time we're witnessing a growth of disruptive malware, and an interest for direct and fast profit. Ransomware is a particularly striking example of disruptive malware, both on mobile and desktop targets: While traditional mass malware must fly under the radar to fulfill its goals, a ransomware attack that remains unaccountable has failed miserably. It must show up to inform and frighten the victim! As a result, the human psychological response to the attack plays a significant role in the success of ransomware schemes. And, given the remarkable revenue, the scheme seems to be working fairly well.  This talk will describe the technical impact of disruptive malware and its game-changing approach, which made us (at least) rethink our incident-response plans. We will focus on mobile ransomware as a representative, extreme case study. Albeit not very studied, we are currently tracking 10 distinct families, and collected tenths of thousands distinct samples in three months. In this talk, we will go through the most notorious families such as Koler, SLocker, Svpeng (and mention the other notable ones), overviewing their social-engineering tricks and how they are technically implemented. This will include, for instance, how an app can effectively lock a device to forcefully display the typical threatening message that informs the victim of what just happened, or how crypto and file-system APIs are (ab)used to surreptitiously encrypt the valuable data.  After having overviewed these aspects, we will describe how they can be effectively detected with specific static features. We will present a lightweight Smali emulator to track the instruction sequences that implement device-locking mechanisms. To detect malicious encryption attempts, we will present a static, dataflow-based program-analysis technique and tool that track file-system operations (e.g., file listing, file reading) to determine if they are \"connected\" to encryption flows. Since the most recent families have started to abuse the device-administration API (e.g., to lock the device), obfuscated method names and reflection to hinder automatic static analysis, we will show a couple of counter-tricks. Last, we will show how the threatening messages can be recognized from normal text using a language-analysis technique, which classifies text based on the appearance of key terms frequently found in ransomware samples but not in benign sources. Since static program-analysis approaches like ours can be time and resource consuming, we describe a fast triaging pre-filtering technique to quickly discard strikingly benign applications. This filter is generic and ransomware-agnostic. Thus, in principle, it could be applied to any app-vetting pipeline.  With this talk we will release the source code of a prototype that implements (part of) the described techniques, and a dataset comprising tenths of thousands of ransomware applications targeting the Android platform, each labeled with the set of features that characterize their statically-extracted behavior.","tags":null,"title":"Pocket-sized Badness: Why Ransomware Comes as a Plot Twist in the Cat-Mouse Game","type":"talk"},{"authors":["Vasilios Mavroudis","Shuang Hao","Yanick Fratantonio","Federico Maggi","Giovanni Vigna","Christopher Kruegel"],"categories":null,"content":"","date":1478131200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"eb45d4bb421b199e2fea203e56872688","permalink":"/talk/mavroudis_silverdogbh_talk_2016/","publishdate":"2016-11-03T00:00:00Z","relpermalink":"/talk/mavroudis_silverdogbh_talk_2016/","section":"talk","summary":"Cross-device tracking (XDT) technologies are currently the ``Holy Grail'' for marketers because they allow to track the user's visited content across different devices to then push relevant, more targeted content. For example, if a user clicks on a particular advertisement while browsing the web at home, the advertisers are very interested in collecting this information to display, later on, related advertisements on other devices belonging to the same user (e.g., phone, tablet).  Currently, the most recent innovation in this area is ultrasonic cross-device tracking (uXDT), which is the use of the ultrasonic spectrum as a communication channel to \"pair\" devices for the aforementioned tracking purposes. Technically, this pairing happens through a receiver application installed on the phone or tablet. The business model is that users will receive rewards or useful services for keeping those apps active, pretty much like it happens for proximity-marketing apps (e.g., Shopkick), where users receive deals for walk-ins recorded by their indoor-localizing apps.  This talk will describe and demonstrate the practical security and privacy risks that arise with the adoption of uXDT-enabled systems. The uXDT technology has caught the attention of major companies (e.g., IDG Ventures, Google, Nestle, Dominos), many of which either invested in uXDT providers (e.g., SilverPush, Signal360, Audible Magic), or approached such companies as clients. Unfortunately, unbeknownst to the users, we found that numerous mobile applications, some with millions of downloads, include uXDT advertising frameworks that actively listen for ultrasounds, with no opt-out option for the users! Security experts and the authorities (e.g., the Federal Trade Commission) have promptly raised concerns about uXDT, but until now no comprehensive security analysis of the technology has been released.  In this talk, we will explore the uXDT ecosystem, dig into the inner workings of popular uXDT frameworks, and perform an in-depth technical analysis of the underlying technology, exposing both implementation \u0026 design vulnerabilities, and critical security \u0026 privacy shortcomings that we discovered. In the offensive part of our talk, we will demonstrate (through practical demo sessions) how an attacker can exploit uXDT frameworks to reveal the true IP addresses of users who browse the Internet through anonymity networks (e.g., VPNs or Tor). Moreover, we will describe how an attacker can tamper with the \"pairing\" process or affect the results of the advertising/bidding algorithms. For example, an attacker equipped with a simple beacon-emitting device (e.g., a smartphone) can walk into a Starbucks at peak hour and launch a profile-corruption attack against all customers currently taking advantage of uXDT-enabled apps.  In the defensive part of our talk, we will introduce three countermeasures that we designed, implemented, and will publicly release. These include (1) a mobile application that detects ultrasound beacons \"in the air\" with the goal of raising awareness, (2) a browser extension that acts as a personal firewall by selectively filtering ultrasonic beacons, and (3) an brand-new OS permission control in Android that allows applications to declaratively ask access to the ultrasound spectrum. We will go into the technical details and provide remediation advice useful both for the users and developers.","tags":null,"title":"Talking Behind Your Back: Attacks and Countermeasures of Ultrasonic Cross-Device Tracking","type":"talk"},{"authors":["Chenghyu Zheng","Nicola Della Rocca","Niccol√≤ Andronio","Stefano Zanero","Maggi Federico"],"categories":null,"content":"","date":1476057600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"aff61b2bc341c106df91a6cd0a1adccf","permalink":"/publication/zheng_greateatlon_2016/","publishdate":"2016-10-10T00:00:00Z","relpermalink":"/publication/zheng_greateatlon_2016/","section":"publication","summary":"Ransomware is a class of malware that aim at preventing victims from accessing valuable data, typically via data encryption or device locking, and ask for a payment to release the target. In the past year, instances of ransomware attacks have been spotted on mobile devices too. However, despite their relatively low infection rate, we notice that the techniques used by mobile ransomware are quite sophisticated, and different from those used by ransomware against traditional computers.  Through an in-depth analysis of about 100 samples of currently active ransomware apps, we conclude that most of them pass undetected by state-of-the-art tools, which are unable to recognize the abuse of benign features for malicious purposes. The main reason is that such tools rely on an inadequate and incomplete set of features. The most notable examples are the abuse of reflection and device-administration APIs, appearing in modern ransomware to evade analysis and detection, and to elevate their privileges (e.g., to lock or wipe the device). Moreover, current solutions introduce several false positives in the na Ãàƒ±ve way they detect cryptographic-APIs abuse, flagging goodware apps as ransomware merely because they rely on cryptographic libraries. Last but not least, the performance overhead of current approaches is unacceptable for appstore-scale workloads.  In this work, we tackle the aforementioned limitations and propose GreatEatlon, a next-generation mobile ransomware detector. We foresee GreatEatlon deployed on the appstore side, as a preventive countermeasure. At its core, GreatEatlon uses static program-analysis techniques to ``resolve'' reflection-based, anti-analysis attempts, to recognize abuses of the device administration API, and extract accurate data-flow information required to detect truly malicious uses of cryptographic APIs. Given the significant resources utilized by Great- Eatlon, we prepend to its core a fast pre-filter that quickly discards obvious goodware, in order to avoid wasting computer cycles.  We tested GreatEatlon on thousands of samples of goodware, generic malware and ransomware applications, and showed that it surpasses current approaches both in speed and detection capabilities, while keeping the false negative rate below 1.3%. ","tags":null,"title":"GreatEatlon: Fast, Static Detection of Mobile Ransomware","type":"publication"},{"authors":["Chenghyu Zheng","Mila Dalla Preda","Jorge Granjal","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1475280000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"0e4a8026a75534686c2f7c1875f602ae","permalink":"/publication/zheng_openst_2016/","publishdate":"2016-10-01T00:00:00Z","relpermalink":"/publication/zheng_openst_2016/","section":"publication","summary":"Several tools for program tracing and introspection exist. These tools can be used to analyze potentially malicious or untrusted programs. In this setting, it is important to prevent that the target program determines whether it is being traced or not. This is typically achieved by minimizing the code of the introspection routines and any artifact or side-effect that the program can leverage. Indeed, the most recent approaches consist of lightly instrumented operating systems or thin hypervisors running directly on bare metal.  Following this research trend, we investigate the feasibility of transparently tracing a Linux/ARM program without modifying the software stack, while keeping the analysis cost and flexibility compatible with state of the art emulation- or bare-metal-based approaches. As for the typical program tracing task, our goal is to reconstruct the stream of system call invocations along with the respective un-marshalled arguments.  We propose to leverage the availability of on-chip debugging interfaces of modern ARM systems, which are accessible via JTAG. More precisely, we developed OpenST, an open-source prototype tracer that allowed us to analyze the performance overhead and to assess the transparency with respect to evasive, real-world malicious programs. OpenST has two tracing modes: In-kernel dynamic tracing and external tracing. The in-kernel dynamic tracing mode uses the JTAG interface to ``hot-patch'' the system calls at runtime, injecting introspection code. This mode is more transparent than emulator based approaches, but assumes that the traced program does not have access to the kernel memory where the introspection code is loaded. The external tracing mode removes this assumption by using the JTAG interface to manage hardware breakpoints.  Our tests show that OpenST's greater transparency comes at the price of a steep performance penalty. However, with a cost model, we show that OpenST scales better than the state of the art, bare-metal-based approach, while remaining equally stealthy to evasive malware.","tags":null,"title":"On-Chip System Call Tracing: A Feasibility Study and Open Prototype","type":"publication"},{"authors":["Mila Dalla Preda","Federico Maggi"],"categories":null,"content":"","date":1474329600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"c6fb80218ad548f9556b44049a49ce19","permalink":"/publication/dalla-preda_aamo_article_2016/","publishdate":"2016-09-20T00:00:00Z","relpermalink":"/publication/dalla-preda_aamo_article_2016/","section":"publication","summary":"The authors of mobile-malware have started to leverage program protection techniques to circumvent anti-viruses, or simply hinder reverse engineering. In response to the diffusion of anti-virus applications, several researches have proposed a plethora of analyses and approaches to highlight their limitations when malware authors employ program-protection techniques. An important contribution of this work is a systematization of the state of the art of anti-virus apps, comparing the existing approaches and providing a detailed analysis of their pros and cons. As a result of our systematization, we notice the lack of openness and reproducibility that, in our opinion, are crucial for any analysis methodology. Following this observation, the second contribution of this work is an open, reproducible, rigorous methodology to assess the effectiveness of mobile anti-virus tools against code-transformation attacks. Our unified workflow, released in the form of an open-source prototype, comprises a comprehensive set of obfuscation operators. It is intended to be used by anti-virus developers and vendors to test the resilience of their products against a large dataset of malware samples and obfuscations, and to obtain insights on how to improve their products with respect to particular classes of code-transformation attacks.","tags":null,"title":"Testing android malware detectors against code obfuscation: a systematization of knowledge and unified methodology","type":"publication"},{"authors":["Andrea Mambretti","Kaan Onarlioglu","Collin Mulliner","William Robertson","Engin Kirda","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1472688000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"0120d08f255b2cb9dd0315ef85fc3bc8","permalink":"/publication/mambretti_trellis_2016/","publishdate":"2016-09-01T00:00:00Z","relpermalink":"/publication/mambretti_trellis_2016/","section":"publication","summary":"Operating systems provide a wide variety of resource isolation and access control mechanisms, ranging from traditional user-based security models to fine-grained permission systems as found in modern mobile operating systems. However, comparatively little assistance is available for defining and enforcing access control policies within multiuser applications. These applications, often found in enterprise environments, allow multiple users to operate at different privilege levels in terms of exercising application functionality and accessing data. Developers of such applications bear a heavy burden in ensuring that security policies over code and data in this setting are properly expressed and enforced. We present Trellis, an approach for expressing hierarchical access control policies in applications and enforcing these policies during execution. The approach enhances the development toolchain to allow programmers to partially annotate code and data with simple privilege level tags, and uses a static analysis to infer suitable tags for the entire application. At runtime, policies are extracted from the resulting binaries and are enforced by a modified operating system kernel. Our evaluation demonstrates that this approach effectively supports the development of secure multi-user applications with modest runtime performance overhead.","tags":null,"title":"Trellis: Privilege Separation for Multi-User Applications Made Easy","type":"publication"},{"authors":[],"categories":[],"content":"We started this project because we wanted to analyze banking and credit-card transactions and, with as little knowledge as possible, predict whether new ones are fraudulent or not (e.g., due to a banking trojan working on the victim‚Äôs computer, made by a cyber criminal with stolen credentials).\nBankSealer is based on lightweight statistical learning on feature models (e.g., amount, timestamp, recipient country, description) extracted by each transaction. BankSealer is currently deployed at one of the largest Italian banks and has been proven effective at detecting frauds, to the point that my co-authors have created a startup out of it!\nBanksealer is now a fintech startup: https://banksealer.com\nReferences   Federico Maggi  (2016). Fast and Transparent Online Banking Fraud Detection and Investigation.  PDF  Cite    Michele Carminati, Roberto Caron, Federico Maggi, Ilenia Epifani, Stefano Zanero  (2014). BankSealer: An Online Banking Fraud Analysis and Decision Support System. ICT Systems Security and Privacy Protection.  PDF  Cite   ","date":1465140852,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1465140852,"objectID":"609801a7b0dc14c6cd9a32fbd6478fa5","permalink":"/post/banksealer/","publishdate":"2016-06-05T17:34:12+02:00","relpermalink":"/post/banksealer/","section":"post","summary":"We started this project because we wanted to analyze banking and credit-card transactions and, with as little knowledge as possible, predict whether new ones are fraudulent or not (e.g., due to a banking trojan working on the victim‚Äôs computer, made by a cyber criminal with stolen credentials).\n","tags":[],"title":"Banksealer: Automatic Banking Fraud Detection","type":"post"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1460678400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"27d8380f84b2fc4fccffa641c31b14f5","permalink":"/talk/maggi_banksealer_talk_2016/","publishdate":"2016-04-15T00:00:00Z","relpermalink":"/talk/maggi_banksealer_talk_2016/","section":"talk","summary":"","tags":null,"title":"Fast and Transparent Online Banking Fraud Detection and Investigation","type":"talk"},{"authors":[],"categories":[],"content":"We wanted to create a malware tracker similar to ZeusTracker, but for mobile bankers. So we built a tool, DroydSeuss, which uses static analysis to extract relevant C\u0026amp;C endpoints (e.g., phone number, web URLs) and monitors them by running each sample in a sandbox on a daily basis.\nOn top of this, DroydSeuss attaches meta data to both C\u0026amp;C endpoints and malware samples (e.g., country, code feature) that are used to mine association rules. These rules are automatically extracted and can tell useful information such as ‚Äúthere is a group of malware samples that seem to be coming from the same author spreading in a certain country‚Äù.\nWe made the tool public and immediately attracted other researcher‚Äôs attention. Thanks to the data feed produced by DroydSeuss we were able to find (and confirm) one malware campaign spreading against Chinese and Korean bank customers and to discover a strange, rare sample that was using Baidu as a C\u0026amp;C.\n(Update: Jun 6th, 2020) We decided not to maintain the web service anymore. We only keep the URL here for hystorical reasons: http://droydseuss.necst.it\nReferences   Alberto Coletta, Victor Van der Veen, Federico Maggi  (2016). DroydSeuss: A Mobile Banking Trojan Tracker - Short Paper. Financial Cryptography and Data Security.  PDF  Cite    Federico Maggi  (2015). A walk through the construction of the first mobile malware tracker.  Cite   ","date":1454686444,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1454686444,"objectID":"b7b8e0c328b9a40efdb0b63f26f481ce","permalink":"/post/droydseuss/","publishdate":"2016-02-05T17:34:04+02:00","relpermalink":"/post/droydseuss/","section":"post","summary":"We wanted to create a malware tracker similar to ZeusTracker, but for mobile bankers. So we built a tool, DroydSeuss, which uses static analysis to extract relevant C\u0026amp;C endpoints (e.g., phone number, web URLs) and monitors them by running each sample in a sandbox on a daily basis.\n","tags":[],"title":"Droydseuss: Android Malware Tracking and Intelligence","type":"post"},{"authors":["Alberto Coletta","Victor Van der Veen","Federico Maggi"],"categories":null,"content":"","date":1454284800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"55ae2b22a1d6826c2b666449064d7506","permalink":"/publication/coletta_droydseuss_2016/","publishdate":"2016-02-01T00:00:00Z","relpermalink":"/publication/coletta_droydseuss_2016/","section":"publication","summary":"After analyzing several Android mobile banking trojans, we observed the presence of repetitive artifacts that describe valuable information about the distribution of this class of malicious apps. Motivated by the high threat level posed by mobile banking trojans and by the lack of publicly available analysis and intelligence tools, we automated the extraction of such artifacts and created a malware tracker named DroydSeuss. DroydSeuss first processes applications both statically and dynamically, extracting relevant strings that contain traces of communication endpoints. Second, it prioritizes the extracted strings based on the APIs that manipulate them. Finally, DroydSeuss correlates the endpoints with descriptive metadata from the samples, providing aggregated statistics, raw data, and cross-sample information that allow researchers to pinpoint relevant groups of applications. We connected DroydSeuss to the VirusTotal daily feed, consuming Android samples that perform banking-trojan activity. We manually analyzed its output and found supporting evidence to confirm its correctness. Remarkably, the most frequent itemset unveiled a campaign currently spreading against Chinese and Korean bank customers.  Although motivated by mobile banking trojans, DroydSeuss can be used to analyze the communication behavior of any suspicious application.","tags":null,"title":"DroydSeuss: A Mobile Banking Trojan Tracker - Short Paper","type":"publication"},{"authors":["Luca Falsina","Yanick Fratantonio","Stefano Zanero","Christopher Kruegel","Giovanni Vigna","Federico Maggi"],"categories":null,"content":"","date":1448928000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"58f78a089ddc39e2277d9e62385e5f7c","permalink":"/publication/falsina_grabnrun_2015/","publishdate":"2015-12-01T00:00:00Z","relpermalink":"/publication/falsina_grabnrun_2015/","section":"publication","summary":"Android introduced the dynamic code loading (DCL) mechanism to allow for code reuse, to achieve extensibility, to enable updating functionalities or to boost application start- up performance. In spite of its wide adoption by developers, implementing DCL in a secure way is challenging, leading to serious vulnerabilities such as remote code injection. Previous academic and community attempts at solving this problem are unfortunately either impractical or incomplete, or in some cases exhibit vulnerabilities. In this paper, we propose, design, implement and test Grab 'n Run, a novel code verification protocol and a series of supporting libraries, APIs, and components, that address the problem by abstracting away from the developer challenging implementation details. Grab 'n Run is designed to be practical: among its tools, it provides a drop-in library, which requires no modifications to the Android framework or the underlying Dalvik/ART runtime, is very similar to the native API, and most code can be automatically rewritten to use it. Grab 'n Run also contains an application rewriting tool, which allows easy porting of existing applications to use the secure API of its library. We evaluate Grab 'n Run library with a user study, obtaining impressive results in vulnerability reduction, ease of use and speed of development. We also show that the performance overhead introduced by our library is negligible. The library is released as free software.","tags":null,"title":"Grab 'n Run: Secure and Practical Dynamic Code Loading for Android Applications","type":"publication"},{"authors":["Federico Maggi","Yanick Fratantonio"],"categories":null,"content":"","date":1447200000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"cdebe21c9dd202784818d563fd4bebb9","permalink":"/talk/maggi_mobilemalware_talk_2015/","publishdate":"2015-11-11T00:00:00Z","relpermalink":"/talk/maggi_mobilemalware_talk_2015/","section":"talk","summary":"","tags":null,"title":"Malware on Mobile: The What, The Why, and The How","type":"talk"},{"authors":["Andrea Valdi","Eros Lever","Simone Benefico","Davide Quarta","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1446336000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"6869b95bf2d50bb7a8639afe0689a325","permalink":"/publication/valdi_andrototal_article_2015/","publishdate":"2015-11-01T00:00:00Z","relpermalink":"/publication/valdi_andrototal_article_2015/","section":"publication","summary":"AndroTotal, a scalable antivirus evaluation system for mobile devices, creates reproducible, self-contained testing environments for each antivirus application and malware pair and stores them in a repository, benefiting both the research community and Android device users.","tags":null,"title":"Scalable Testing of Mobile Antivirus Applications","type":"publication"},{"authors":["Panagiotis Ilia","Iasonas Polakis","Elias Athanasopoulos","Federico Maggi","Sotiris Ioannidis"],"categories":null,"content":"","date":1443657600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"9ac943d3ed728ff8a85fdaf77a4f861a","permalink":"/publication/ilia_faceoff_2015/","publishdate":"2015-10-01T00:00:00Z","relpermalink":"/publication/ilia_faceoff_2015/","section":"publication","summary":"The capabilities of modern devices, coupled with the almost ubiquitous availability of Internet connectivity, have resulted in photos being shared online at an unprecedented scale. This is further amplified by the popularity of social networks and the immediacy they offer in content sharing. Existing access control mechanisms are too coarse-grained to handle cases of conflicting interests between the users associated with a photo; stories of embarrassing or inappropriate photos being widely accessible have become quite common. In this paper, we propose to rethink access control when applied to photos, in a way that allows us to effectively prevent unwanted individuals from recognizing users in a photo. The core concept behind our approach is to change the granularity of access control from the level of the photo to that of a user's personally identifiable information (PII). In this work, we consider the face as the PII. When another user attempts to access a photo, the system determines which faces the user does not have the permission to view, and presents the photo with the restricted faces blurred out. Our system takes advantage of the existing face recognition functionality of social networks, and can interoperate with the current photo-level access control mechanisms. We implement a proof-of-concept application for Facebook, and demonstrate that the performance overhead of our approach is minimal. We also conduct a user study to evaluate the privacy offered by our approach, and find that it effectively prevents users from identifying their contacts in 87.35% of the restricted photos. Finally, our study reveals the misconceptions about the privacy offered by existing mechanisms, and demonstrates that users are positive towards the adoption of an intuitive, straightforward access control mechanism that allows them to manage the visibility of their face in published photos.","tags":null,"title":"Face/Off: Preventing Privacy Leakage From Photos in Social Networks","type":"publication"},{"authors":["Niccol√≤ Andronio","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1443657600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"c08c444e321d908caf65659f764f3c04","permalink":"/publication/andronio_heldroid_2015/","publishdate":"2015-10-01T00:00:00Z","relpermalink":"/publication/andronio_heldroid_2015/","section":"publication","summary":"In ransomware attacks, the actual target is the human, as opposed to the classic attacks that abuse the infected devices (e.g., botnet renting, information stealing). Mobile devices are by no means immune to ransomware attacks. However, there is little research work on this matter and only traditional protections are available. Even state-of-the-art mobile malware detection approaches are ineffective against ransomware apps because of the subtle attack scheme. As a consequence, the ample attack surface formed by the billion mobile devices is left unprotected. First, in this work we summarize the results of our analysis of the existing mobile ransomware families, describing their common characteristics. Second, we present HelDroid, a fast, efficient and fully automated approach that recognizes known and unknown scareware and ransomware samples from goodware. Our approach is based on detecting the ``build- ing blocks'' that are typically needed to implement a mobile ransomware application. Specifically, HelDroid detects, in a generic way, if an app is attempting to lock or encrypt the device without the user‚Äôs consent, and if ransom requests are displayed on the screen. Our technique works without requiring that a sample of a certain family is available beforehand. We implemented HelDroid and tested it on real-world Android ransomware samples. On a large dataset comprising hundreds of thousands of APKs including goodware, malware, scareware, and ransomware, HelDroid exhibited nearly zero false positives and the capability of recognizing unknown ransomware samples. ","tags":null,"title":"HelDroid: Dissecting and Detecting Mobile Ransomware","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1441929600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"782ec119e12a3f5d86c2e03c0ddde553","permalink":"/talk/maggi_droydseuss_talk_2015/","publishdate":"2015-09-11T00:00:00Z","relpermalink":"/talk/maggi_droydseuss_talk_2015/","section":"talk","summary":"","tags":null,"title":"A walk through the construction of the first mobile malware tracker","type":"talk"},{"authors":[],"categories":[],"content":"A simple and effective Java Library that you can easily add to your Android projects to perform secure dynamic class loading operations.\nThe standard DexClassLoader is not secure, so one single mistake could open the application (and, therefore, the entire device) to serious security vulnerabilities, such as remote code execution. The main goal of Grab\u0026rsquo;s Run is to offer an alternative to the native Android APIs, and its design enforces that even the most inexperienced developer cannot perform well-known, serious mistakes.\nCheck out the source code: github.com/lukeFalsina/Grab-n-Run\nReferences  Luca Falsina, Yanick Fratantonio, Stefano Zanero, Christopher Kruegel, Giovanni Vigna, Federico Maggi  (2015). Grab \u0026#39;n Run: Secure and Practical Dynamic Code Loading for Android Applications. Proceedings of the 31st Annual Computer Security Applications Conference.  PDF  Cite  ","date":1438788885,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1438788885,"objectID":"370d3b5064a0ad46352e368b20ec450c","permalink":"/post/grabnrun/","publishdate":"2015-08-05T17:34:45+02:00","relpermalink":"/post/grabnrun/","section":"post","summary":"A simple and effective Java Library that you can easily add to your Android projects to perform secure dynamic class loading operations.\n","tags":[],"title":"Grab 'n Run: Secure dynamic code loading for Android","type":"post"},{"authors":["Mario Polino","Andrea Scorti","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1436400000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"c3d2c881b9707dc3da64e60d059c5732","permalink":"/publication/polino_jackdaw_2015/","publishdate":"2015-07-09T00:00:00Z","relpermalink":"/publication/polino_jackdaw_2015/","section":"publication","summary":"When analyzing an untrusted binary, reverse engineers usually rely on ad-hoc collections of interesting dynamic patterns known as behaviors in the malware-analysis community and static patterns known as signatures in the antivirus community. Such patterns are often part of the skill set of the analyst, sometimes implemented in manually-created post-processing scripts. It would be desirable to be able to automatically find such behaviors, present them to analysts, and create a systematic catalog of matching rules and relevant implementations. We propose Jackdaw, a system that finds interesting dynamic patterns, and ranks them to unveil potentially interesting behaviors. Then, it annotates them with static information, capturing the distinct implementations of each across different malware families. Finally, Jackdaw associates semantic information to the behaviors, so as to create a descriptive summary that helps the analysts in querying the catalog of behaviors by type. To do this, it leverages the dynamic information and an indexed Web-based knowledge databases. We implement and demonstrate Jackdaw on the Win32 API (even if the technique can be generalized to any OS). On a dataset of 2,136 distinct binaries, including both malicious and benign libraries and executables, we compared the behaviors extracted automatically against a ground truth of 44 behaviors created manually by expert analysts. Jackdaw found 77.3% of them and was able to exclude spurious behaviors in 99.6% cases. We also discovered 466 novel behaviors, among which manual exploration and review by expert reverse engineers revealed interesting findings and confirmed the correctness of the semantic tagging.","tags":null,"title":"Jackdaw: Towards Automatic Reverse Engineering of Large Datasets of Binaries","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1433289600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"72921ae458296e6af65e0a3d44f80a4a","permalink":"/talk/maggi_mobileransomware_talk_2015/","publishdate":"2015-06-03T00:00:00Z","relpermalink":"/talk/maggi_mobileransomware_talk_2015/","section":"talk","summary":"","tags":null,"title":"Mobile Ransomware","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1429488000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"75510c7d6c69dd05546070cbe59d2bbb","permalink":"/talk/maggi_cybercrimethreatanalysis_talk_2015/","publishdate":"2015-04-20T00:00:00Z","relpermalink":"/talk/maggi_cybercrimethreatanalysis_talk_2015/","section":"talk","summary":"","tags":null,"title":"From Cybercrime to Threat Analysis","type":"talk"},{"authors":["Michele Carminati","Roberto Caron","Federico Maggi","Ilenia Epifani","Stefano Zanero"],"categories":null,"content":"","date":1427846400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"9617b4d52b72d2308f7cc547a4fdc800","permalink":"/publication/carminati_banksealer_article_2015/","publishdate":"2015-04-01T00:00:00Z","relpermalink":"/publication/carminati_banksealer_article_2015/","section":"publication","summary":"The significant growth of online banking frauds, fueled by the underground economy of malware, raised the need for effective fraud analysis systems. Unfortunately, almost all of the existing approaches adopt black box models and mechanisms that do not give any justifications to analysts. Also, the development of such methods is stifled by limited Internet banking data availability for the scientific community. In this paper we describe BankSealer, a decision support system for online banking fraud analysis and investigation. During a training phase, BankSealer builds easy-to-understand models for each customer's spending habits, based on past transactions. First, it quantifies the anomaly of each transaction with respect to the customer historical profile. Second, it finds global clusters of customers with similar spending habits. Third, it uses a temporal threshold system that measures the anomaly of the current spending pattern of each customer, with respect to his or her past spending behavior. With this threefold profiling approach, it mitigates the under-training due to the lack of historical data for building well-trained profiles, and the evolution of users' spending habits over time. At runtime, BankSealer supports analysts by ranking new transactions that deviate from the learned profiles, with an output that has an easily understandable, immediate statistical meaning.  Our evaluation on real data, based on fraud scenarios built in collaboration with domain experts that replicate typical, real-world attacks (e.g., credential stealing, banking trojan activity, and frauds repeated over time), shows that our approach correctly ranks complex frauds. In particular, we measure the effectiveness, the computational resource requirements and the capabilities of BankSealer to mitigate the problem of users that performed a low number of transactions. Our system ranks frauds and anomalies with up to 98% detection rate and with a maximum daily computation time of 4~min. Given the good results, a leading Italian bank deployed a version of BankSealer in their environment to analyze frauds.","tags":null,"title":"BankSealer: A decision support system for online banking fraud analysis and investigation","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1426636800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"4cf1e75c310d0b9fa50e3a884fcf3444","permalink":"/talk/maggi_threatanalysis_talk_2015/","publishdate":"2015-03-18T00:00:00Z","relpermalink":"/talk/maggi_threatanalysis_talk_2015/","section":"talk","summary":"","tags":null,"title":"From Cybercrime to Threat Analysis","type":"talk"},{"authors":[],"categories":[],"content":"Sono stato invitato dal Garante per la Protezione dei Dati alla giornata europea della privacy, con richiesta di fare un po\u0026rsquo; di chiarezza sul fenomeno IoT. Questo articolo √® una versione \u0026ldquo;verbosa\u0026rdquo; del mio intervento, che si incentra sui tre fattori che, secondo me, hanno contribuito a dar vita a questo fenomeno: tecnologia accessibile a basso costo, moltitudine di scenari applicativi e media.\nSi tratta di un post piuttosto lungo: lo trovate su Medium.\n","date":1422266010,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1422266010,"objectID":"3461e7d326b370cac35460539f987b52","permalink":"/post/iot-sec-priv/","publishdate":"2015-01-26T11:53:30+02:00","relpermalink":"/post/iot-sec-priv/","section":"post","summary":"Sono stato invitato dal Garante per la Protezione dei Dati alla giornata europea della privacy, con richiesta di fare un po\u0026rsquo; di chiarezza sul fenomeno IoT. Questo articolo √® una versione \u0026ldquo;verbosa\u0026rdquo; del mio intervento, che si incentra sui tre fattori che, secondo me, hanno contribuito a dar vita a questo fenomeno: tecnologia accessibile a basso costo, moltitudine di scenari applicativi e media.\n","tags":["iot","privacy","security","italian"],"title":"Internet of Things. Applicazioni, sicurezza e riservatezza dei dati personali","type":"post"},{"authors":["Federico Maggi","Stefano Zanero","Evangelos Markatos"],"categories":null,"content":"","date":1420070400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"d20b54608e18725ff32912c2b109e069","permalink":"/publication/maggi_eusyssec_tr_2015/","publishdate":"2015-01-01T00:00:00Z","relpermalink":"/publication/maggi_eusyssec_tr_2015/","section":"publication","summary":"Looking back at the evolution of cyber criminal activities, from the nineties to the present day, we observe interesting trends coming together in what may seem a perfectly orchestrated scene. In parallel with the `security by design', we recall the importance of reactive security in a field of ever-changing arms races.","tags":null,"title":"European Cyber-Security Research and Innovation","type":"publication"},{"authors":["Iasonas Polakis","Panagiotis Ilia","Federico Maggi","Marco Lancini","Georgios Kontaxis","Stefano Zanero","Sotiris Ioannidis","Angelos D. Keromytis"],"categories":null,"content":"","date":1414800000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"1441d86a5df8ec58610b91a50d2adad3","permalink":"/publication/polakis_resoauth_2014/","publishdate":"2014-11-01T00:00:00Z","relpermalink":"/publication/polakis_resoauth_2014/","section":"publication","summary":"In an effort to hinder attackers from compromising user accounts, Facebook launched a form of two-factor authentication called social authentication (SA), where users are required to identify photos of their friends to complete a log-in attempt. Recent research, however, demonstrated that attackers can bypass the mechanism by employing face recognition software. Here we demonstrate an alternative attack. that employs image comparison techniques to identify the SA photos within an offline collection of the users' photos. In this paper, we revisit the concept of SA and design a system with a novel photo selection and transformation process, which generates challenges that are robust against these attacks. The intuition behind our photo selection is to use photos. that fail software-based face recognition, while remaining recognizable to humans who are familiar with the depicted people. The photo transformation process. creates challenges in the form of photo collages, where faces are transformed so as to render image matching techniques ineffective. We experimentally confirm the robustness of our approach against three template. matching algorithms that solve 0.4 percent of the challenges, while requiring four orders of magnitude more processing effort. Furthermore, when the transformations are applied, face detection software fails to detect even a single face. Our user studies confirm that users are able to identify their friends in over 99% of the photos with faces unrecognizable by software, and can solve over 94 percent of the challenges with transformed photos.","tags":null,"title":"Faces in the Distorting Mirror: Revisiting Photo-based Social Authentication","type":"publication"},{"authors":["Enrico Bazzoli","Claudio Criscione","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1413331200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"09dcfeb089aea9f43f39f5ccde9ae3d5","permalink":"/publication/bazzoli_xsspeeker_tr_2014/","publishdate":"2014-10-15T00:00:00Z","relpermalink":"/publication/bazzoli_xsspeeker_tr_2014/","section":"publication","summary":"Since the first publication of the \"OWASP Top 10\" (2004), cross-site scripting (XSS) vulnerabilities have always been among the top 5 web application security bugs. Black-box vulnerability scanners are widely used in the industry to reproduce (XSS) attacks automatically. In spite of the technical sophistication and advancement, previous work showed that black-box scanners miss a non-negligible portion of vulnerabilities, and report non-existing, non-exploitable or uninteresting vulnerabilities. Unfortunately, these results hold true even for XSS vulnerabilities, which are relatively simple to trigger if compared, for instance, to logic flaws. Black-box scanners have not been studied in depth on this vertical: knowing precisely how scanners try to detect XSS can provide useful insights to understand their limitations, to design better detection methods. In this paper, we present and discuss the results of a detailed and systematic study on 6 black-box web scanners (both proprietary and open source) that we conducted in coordination with the respective vendors. To this end, we developed an automated tool to (1) extract the payloads used by each scanner, (2) distill the \"templates\" that have originated each payload, (3) evaluate them according to quality indicators, and (4) perform a cross-scanner analysis. Unlike previous work, our testbed application, which contains a large set of XSS vulnerabilities, including DOM XSS, was gradually retrofitted to accomodate for the payloads that triggered no vulnerabilities. Our analysis reveals a highly fragmented scenario. Scanners exhibit a wide variety of distinct payloads, a non-uniform approach to fuzzing and mutating the payloads, and a very diverse detection effectiveness.","tags":null,"title":"XSS Peeker: A Systematic Analysis of Cross-site Scripting Vulnerability Scanners","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1413158400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"2fa4f96dc8b735c8a885435cdf9a7924","permalink":"/talk/maggi_cybercrime_talk_2014/","publishdate":"2014-10-13T00:00:00Z","relpermalink":"/talk/maggi_cybercrime_talk_2014/","section":"talk","summary":"","tags":null,"title":"Current and Future Cybercrime Tactics","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1412985600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"b592078e106579681cabc188e2a8a22d","permalink":"/talk/maggi_andradar_talk_2014/","publishdate":"2014-10-11T00:00:00Z","relpermalink":"/talk/maggi_andradar_talk_2014/","section":"talk","summary":"","tags":null,"title":"Come to the Dark Side: We have Apps!","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1411603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"c42c933614351fefeae139d9e2626d79","permalink":"/talk/maggi_androidre_talk_2014/","publishdate":"2014-09-25T00:00:00Z","relpermalink":"/talk/maggi_androidre_talk_2014/","section":"talk","summary":"","tags":null,"title":"Static Analysis of Android Applications","type":"talk"},{"authors":["Alessio Antonini","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1409529600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"9c8ef501e8cb897436278cacff6b8dc2","permalink":"/publication/antonini_knxmalware_2014/","publishdate":"2014-09-01T00:00:00Z","relpermalink":"/publication/antonini_knxmalware_2014/","section":"publication","summary":"Building automation systems rely heavily on general-purpose computers and communication protocols, which are often affected by security vulnerabilities. In this paper, we first analyze the attack surface of a real building automation system - based on the widely used KNX protocol-connected to a general-purpose IP network. To this end, we analyze the vulnerabilities of KNX-based networks highlighted by previous research work, which, however, did not corroborate their findings with experimental results. To verify the practical exploitability of these vulnerabilities and their potential impact, we implement a full-fledged testbed infrastructure that reproduces the typical deployment of a building automation system. On this testbed, we show the feasibility of a practical attack that leverages and combines the aforementioned vulnerabilities. We show the ease of reverse engineering the vendor-specific components of the KNX protocol. Our attack leverages the IP-to-KNX connectivity to send arbitrary commands which are executed by the actuators. We conclude that the vulnerabilities highlighted by previous work are effectively exploitable in practice, with severe results. Although we use KNX as a target, our work can be generalized to other communication protocols, often characterized by similar issues. Finally, we analyze the countermeasures proposed in previous literature and reveal the limitations that prevent their adoption in practice. We suggest a practical stopgap measure to protect real KNX-based BASs from our attack.","tags":null,"title":"A Practical Attack Against a KNX-based Building Automation System","type":"publication"},{"authors":["Iasonas Polakis","Federico Maggi","Stefano Zanero","Angelos D. Keromytis"],"categories":null,"content":"","date":1409529600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348198,"objectID":"79299f0e3fc5e498debc6c9af4e19831","permalink":"/publication/polakis_osnresearch_2014/","publishdate":"2014-09-01T00:00:00Z","relpermalink":"/publication/polakis_osnresearch_2014/","section":"publication","summary":"We describe our experience gained while exploring practical security and privacy problems in a real-world, large- scale social network (i.e., Facebook), and summarize our conclusions in a series of \"lessons learned\". We first conclude that it is better to adequately describe the potential ethical concerns from the very beginning and plan ahead the institutional review board (IRB) request. Even though sometimes optional, the IRB approval is a valuable point from the reviewer's perspective. Another aspect that needs planning is getting in touch with the online social network security team, which takes a substantial amount of time. With their support, \"bending the rules\" (e.g., using scrapers) when the experimental goals require so, is easier. Clearly, in cases where critical technical vulnerabilities are found during the research, the general recommendations for responsible disclosure should be followed. Gaining the audience's engagement and trust was essential to the success of our user study. Participants felt more comfortable when subscribing to our experiments, and also responsibly reported bugs and glitches. We did not observe the same behavior in crowd-sourcing workers, who were instead more interested in obtaining their rewards. On a related point, our experience suggests that crowd sourcing should not be used alone: Setting up tasks is more time consuming than it seems, and researchers must insert some sentinel checks to ensure that workers are not submitting random answers.From a logistics point of view, we learned that having at least a high-level plan of the experiments pays back, especially when the IRB requires a detailed description of the work and the data to be collected. However, over planning can be dangerous because the measurement goals can change dynamically. From a technical point of view, partially connected to the logistics remarks, having a complex and large data-gathering and analysis framework may be counterproductive in terms of set-up a- d management overhead. From our experience we suggest to choose simple technologies that scale up if needed but, more importantly, can scale down. For example, launching a quick query should be straightforward, and the frameworks should not impose too much overhead for formulating it. We conclude with a series of practical recommendations on how to successfully collect data from online social networks (e.g., using techniques for network multipresence, mimicking user behavior, and other crawling \"tricks\"') and avoid abusing the online service, while gathering the data required by the experiments.","tags":["workshop"],"title":"Security and Privacy Measurements on Social Networks: Experiences and Lessons Learned","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1406419200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"160773bb47f16f1f0a3bca8bf6866639","permalink":"/talk/maggi_virtualization_talk_2014/","publishdate":"2014-07-27T00:00:00Z","relpermalink":"/talk/maggi_virtualization_talk_2014/","section":"talk","summary":"","tags":null,"title":"Virtualization","type":"talk"},{"authors":["Martina Lindorfer","Stamatis Volanis","Alessandro Sisto","Matthias Neugschwandtner","Elias Athanasopoulos","Federico Maggi","Christian Platzer","Stefano Zanero","Sotiris Ioannidis"],"categories":null,"content":"","date":1404172800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"622e79b12dd0073b8be40558b0f66259","permalink":"/publication/lindorfer_andradar_2014/","publishdate":"2014-07-01T00:00:00Z","relpermalink":"/publication/lindorfer_andradar_2014/","section":"publication","summary":"Compared to traditional desktop software, Android applications are delivered through software repositories, commonly known as application markets. Other mobile platforms, such as Apple iOS and BlackBerry OS also use the marketplace model, but what is unique to Android is the existence of a plethora of alternative application markets. This complicates the task of detecting and tracking Android malware. Identifying a malicious application in one particular market is simply not enough, as many instances of this application may exist in other markets. To quantify this phenomenon, we exhaustively crawled 8 markets between June and November 2013. Our findings indicate that alternative markets host a large number of ad-aggressive apps, a non-negligible amount of malware, and some markets even allow authors to publish known malicious apps without prompt action. Motivated by these findings, we present AndRadar, a framework for discovering multiple instances of a malicious Android application in a set of alternative application markets. AndRadar scans a set of markets in parallel to discover similar applications. Each lookup takes no more than a few seconds, regardless of the size of the marketplace. Moreover, it is modular, and new markets can be transparently added once the search and download URLs are known. Using AndRadar we are able to achieve three goals. First, we can discover malicious applications in alternative markets, second, we can expose app distribution strategies used by malware developers, and third, we can monitor how different markets react to new malware. During a three-month evaluation period, AndRadar tracked over 20,000 apps and recorded more than 1,500 app deletions in 16 markets. Nearly 8% of those deletions were related to apps that were hopping from market to market. The most established markets were able to react and delete new malware within tens of days from the malicious app publication date while other markets did not react at all.","tags":null,"title":"AndRadar: Fast Discovery of Android Applications in Alternative Markets","type":"publication"},{"authors":["Stefano Schiavoni","Federico Maggi","Lorenzo Cavallaro","Stefano Zanero"],"categories":null,"content":"","date":1404172800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"f65b4aa43f0653c5788be119e53fb248","permalink":"/publication/schiavoni_phoenix_2014/","publishdate":"2014-07-01T00:00:00Z","relpermalink":"/publication/schiavoni_phoenix_2014/","section":"publication","summary":"Modern botnets rely on domain-generation algorithms (DGAs) to build resilient command-and-control infrastructures. Given the prevalence of this mechanism, recent work has focused on the analysis of DNS traffic to recognize botnets based on their DGAs. While previous work has concentrated on detection, we focus on supporting intelligence operations. We propose Phoenix, a mechanism that, in addition to telling DGA- and non-DGA-generated domains apart using a combination of string and IP-based features, characterizes the DGAs behind them, and, most importantly, finds groups of DGA-generated domains that are representative of the respective botnets. As a result, Phoenix can associate previously unknown DGA-generated domains to these groups, and produce novel knowledge about the evolving behavior of each tracked botnet. We evaluated Phoenix on 1,153,516 domains, including DGA-generated domains from modern, well-known botnets: without supervision, it correctly distinguished DGA- vs. non-DGA-generated domains in 94.8 percent of the cases, characterized families of domains that belonged to distinct DGAs, and helped researchers ``on the field'' in gathering intelligence on suspicious domains to identify the correct botnet.","tags":null,"title":"Phoenix: DGA-Based Botnet Tracking and Intelligence","type":"publication"},{"authors":["Claudio Criscione","Fabio Bosatelli","Stefano Zanero","Federico Maggi"],"categories":null,"content":"","date":1404172800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"bd1f739116e8596ddeb37f4e4991be83","permalink":"/publication/criscione_zarathustra_2014/","publishdate":"2014-07-01T00:00:00Z","relpermalink":"/publication/criscione_zarathustra_2014/","section":"publication","summary":"Modern trojans are equipped with a functionality, called WebInject, that can be used to silently modify a web page on the infected end host. Given its flexibility, WebInject-based malware is becoming a popular information-stealing mechanism. In addition, the structured and well-organized malware-as-a-service model makes revenue out of customization kits, which in turns leads to high volumes of binary variants. Analysis approaches based on memory carving to extract the decrypted webinject.txt and config.bin files at runtime make the strong assumption that the malware will never change the way such files are handled internally, and therefore are not future proof by design. In addition, developers of sensitive web applications (e.g., online banking) have no tools that they can possibly use to even mitigate the effect of WebInjects.","tags":null,"title":"Zarathustra: Extracting WebInject Signatures from Banking Trojans","type":"publication"},{"authors":[],"categories":[],"content":"The main goal of this project is to provide a dashboard to analyze and monitor the spreading of Android malware in marketplaces. AndRadar uses lightweight fingerprints to lookup malware samples without the need to download them from the markets.\nOnce a matching app is found, AndRadar tracks its page, developer, and any kind of meta data associated to it. AndRadar‚Äôs data is then crunched into a set of indicators that summarize, for example, the efficiency of a malware author in publishing its app, the speed of the market in responding to threats, etc., and provide an overall reputation of each developer, market and app. By combining data coming from different marketplaces, AndRadar can track spreading campaigns also across markets. No such tool like AndRadar exists so far, so we released it to the public.\nThe (unmaintained) web application is at: http://andradar.hosting.necst.it\nReferences  Martina Lindorfer, Stamatis Volanis, Alessandro Sisto, Matthias Neugschwandtner, Elias Athanasopoulos, Federico Maggi, Christian Platzer, Stefano Zanero, Sotiris Ioannidis  (2014). AndRadar: Fast Discovery of Android Applications in Alternative Markets. Detection of Intrusions and Malware, and Vulnerability Assessment.  PDF  Cite  ","date":1402133136,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1402133136,"objectID":"fa6898180e685ccb303f1289630eaad6","permalink":"/post/andradar/","publishdate":"2014-06-07T11:25:36+02:00","relpermalink":"/post/andradar/","section":"post","summary":"The main goal of this project is to provide a dashboard to analyze and monitor the spreading of Android malware in marketplaces. AndRadar uses lightweight fingerprints to lookup malware samples without the need to download them from the markets.\n","tags":[],"title":"AndRadar: Mobile app Marketplace Monitoring and Reputation Analysis","type":"post"},{"authors":["Michele Carminati","Roberto Caron","Federico Maggi","Ilenia Epifani","Stefano Zanero"],"categories":null,"content":"","date":1401667200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"a85ed3b6f0568ce7e95bbe7a8f3415c1","permalink":"/publication/carminati_banksealer_2014/","publishdate":"2014-06-02T00:00:00Z","relpermalink":"/publication/carminati_banksealer_2014/","section":"publication","summary":"We propose a semi-supervised online banking fraud analysis and decision support approach. During a training phase, it builds a profile for each customer based on past transactions. At runtime, it supports the analyst by ranking unforeseen transactions that deviate from the learned profiles. It uses methods whose output has a immediate statistical meaning that provide the analyst with an easy-to-understand model of each customer's spending habits. First, we quantify the anomaly of each transaction with respect to the customer historical profile. Second, we find global clusters of customers with similar spending habits. Third, we use a temporal threshold system that measures the anomaly of the current spending pattern of each customer, with respect to his or her past spending behavior. As a result, we mitigate the undertraining due to the lack of historical data for building of well-trained profiles (of fresh users), and the users that change their (spending) habits over time. Our evaluation on real-world data shows that our approach correctly ranks complex frauds as ``top priority''.","tags":null,"title":"BankSealer: An Online Banking Fraud Analysis and Decision Support System","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1400025600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"f50150f48651ae401ced9eaf66909396","permalink":"/talk/maggi_phoenixhoneynet_talk_2014/","publishdate":"2014-05-14T00:00:00Z","relpermalink":"/talk/maggi_phoenixhoneynet_talk_2014/","section":"talk","summary":"Modern botnets rely on domain-generation algorithms (DGAs) to build resilient command-and-control infrastructures. Recent works focus on recognizing automatically generated domains (AGDs) from DNS traffic, which potentially allows to identify previously unknown AGDs to hinder or disrupt botnets' communication capabilities. The state-of-the-art approaches require to deploy low-level DNS sensors to access data whose collection poses practical and privacy issues, making their adoption problematic. We propose a mechanism that overcomes the above limitations by analyzing DNS traffic data through a combination of linguistic and IP-based features of suspicious domains. In this way, we are able to identify AGD names, characterize their DGAs and isolate logical groups of domains that represent the respective botnets. Moreover, our system enriches these groups with new, previously unknown AGD names, and produce novel knowledge about the evolving behavior of each tracked botnet. We used our system in real-world settings, to help researchers that requested intelligence on suspicious domains and were able to label them as belonging to the correct botnet automatically. Additionally, we ran an evaluation on 1,153,516 domains, including AGDs from both modern (e.g., Bamital) and traditional (e.g., Conficker, Torpig) botnets. Our approach correctly isolated families of AGDs that belonged to distinct DGAs, and set automatically generated from non-automatically generated domains apart in 94.8 percent of the cases.","tags":null,"title":"Tracking and Characterizing Botnets Using Automatically Generated Domains","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1398902400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"ef634bfc0a14519ae291969933c4d56d","permalink":"/talk/maggi_phoenixgoogle_talk_2014/","publishdate":"2014-05-01T00:00:00Z","relpermalink":"/talk/maggi_phoenixgoogle_talk_2014/","section":"talk","summary":"","tags":null,"title":"Phoenix \u0026 Cerberus: Botnet Tracking via Precise DGA Characterization","type":"talk"},{"authors":["Nick Nikiforakis","Federico Maggi","Gianluca Stringhini","M. Zubair Rafique","Wouter Joosen","Christopher Kruegel","Frank Piessens","Giovanni Vigna","Stefano Zanero"],"categories":null,"content":"","date":1396310400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"ad23e3ab312cd222b25f4e24b9750ddc","permalink":"/publication/nikiforakis_strangerdanger_2014/","publishdate":"2014-04-01T00:00:00Z","relpermalink":"/publication/nikiforakis_strangerdanger_2014/","section":"publication","summary":"URL shortening services facilitate the need of exchanging long URLs using limited space, by creating compact URL aliases that redirect users to the original URLs when followed. Some of these services show advertisements (ads) to link-clicking users and pay a commission of their advertising earnings to link-shortening users. In this paper, we investigate the ecosystem of these increasingly popular ad-based URL shortening services. Even though traditional URL shortening services have been thoroughly investigated in previous research, we argue that, due to the monetary incentives and the presence of third-party advertising networks, ad-based URL shortening services and their users are exposed to more hazards than traditional shortening services. By analyzing the services themselves, the advertisers involved, and their users, we uncover a series of issues that are actively exploited by malicious advertisers and endanger the users. Moreover, next to documenting the ongoing abuse, we suggest a series of defense mechanisms that services and users can adopt to protect themselves.","tags":null,"title":"Stranger Danger: Exploring the Ecosystem of Ad-based URL Shortening Services","type":"publication"},{"authors":["Michele Spagnuolo","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1393804800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"62936d90e0b68181961a7178fd0008ff","permalink":"/publication/spagnuolo_bitiodine_2014/","publishdate":"2014-03-03T00:00:00Z","relpermalink":"/publication/spagnuolo_bitiodine_2014/","section":"publication","summary":"Bitcoin, the famous peer-to-peer, decentralized electronic currency system, allows users to benefit from pseudonymity, by generating an arbitrary number of aliases (or addresses) to move funds. However, the complete history of all transactions ever performed, called \"blockchain\", is public and replicated on each node. The data it contains is difficult to analyze manually, but can yield a high number of relevant information.  In this paper we present a modular framework, BitIodine, which parses the blockchain, clusters addresses that are likely to belong to a same user or group of users, classifies such users and labels them, and finally visualizes complex information extracted from the Bitcoin network.  BitIodine labels users (semi-)automatically with information on their identity and actions which is automatically scraped from openly available information sources. BitIodine also supports manual investigation by finding paths and reverse paths between addresses or users.  We tested BitIodine on several real-world use cases, identified an address likely to belong to the encrypted Silk Road cold wallet, or investigated the CryptoLocker ransomware and accurately quantified the number of ransoms paid, as well as information about the victims.  We release an early prototype of BitIodine as a library for building more complex Bitcoin forensic analysis tools.","tags":null,"title":"BitIodine: Extracting Intelligence from the Bitcoin Network","type":"publication"},{"authors":["Andrea Gianazza","Federico Maggi","Aristide Fattori","Lorenzo Cavallaro","Stefano Zanero"],"categories":null,"content":"","date":1392768000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"82558333b9c6fa4a29e624a73aca8468","permalink":"/publication/gianazza_puppetdroid_tr_2014/","publishdate":"2014-02-19T00:00:00Z","relpermalink":"/publication/gianazza_puppetdroid_tr_2014/","section":"publication","summary":"Popularity and complexity of malicious mobile applications are rising, making their analysis difficult and labor intensive. Mobile application analysis is indeed inherently different from desktop application analysis: In the latter, the interaction of the user (i.e., victim) is crucial for the malware to correctly expose all its malicious behaviors. We propose a novel approach to analyze (malicious) mobile applications. The goal is to exercise the user interface (UI) of an Android application to effectively trigger malicious behaviors, automatically. Our key intuition is to record and reproduce the UI interactions of a potential victim of the malware, so as to stimulate the relevant behaviors during dynamic analysis. To make our approach scale, we automatically re-execute the recorded UI interactions on apps that are similar to the original ones. These characteristics make our system orthogonal and complementary to current dynamic analysis and UI-exercising approaches. We developed our approach and experimentally shown that our stimulation allows to reach a higher code coverage than automatic UI exercisers, so to unveil interesting malicious behaviors that are not exposed when using other approaches. Our approach is also suitable for crowdsourcing scenarios, which would push further the collection of new stimulation traces. This can potentially change the way we conduct dynamic analysis of (mobile) applications, from fully automatic only, to user-centric and collaborative too.","tags":null,"title":"PuppetDroid: A User-Centric UI Exerciser for Automatic Dynamic Analysis of Similar Android Applications","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1388707200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"13fdcf160e4b53841c1eb5848229c738","permalink":"/talk/maggi_androidmalware_talk_2014/","publishdate":"2014-01-03T00:00:00Z","relpermalink":"/talk/maggi_androidmalware_talk_2014/","section":"talk","summary":"","tags":null,"title":"Malicious Android Apps: Overview, Status and Dilemmas","type":"talk"},{"authors":["Gabriele Bonetti","Marco Viglione","Alessandro Frossi","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1385856000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"8d3a4a6e04f11c7d7e9416cfec7dca25","permalink":"/publication/bonetti_ssdforensics_2013/","publishdate":"2013-12-01T00:00:00Z","relpermalink":"/publication/bonetti_ssdforensics_2013/","section":"publication","summary":"Solid-state drives (SSDs) are inherently different from traditional drives, as they incorporate data-optimization mechanisms to overcome their limitations (such as a limited number of program-erase cycles, or the need of blanking a block before writing). The most common optimizations are wear leveling, trimming, compression, and garbage collection, which operate transparently to the host OS and, in certain cases, even when the disks are disconnected from a computer (but still powered up). In simple words, SSD controllers are designed to hide these internals completely, rendering them inaccessible if not through direct acquisition of the memory cells. These optimizations have a significant impact on the forensic analysis of SSDs. The main cause is that memory cells could be pre-emptively blanked, whereas a traditional drive sector would need to be explicitly rewritten to physically wipe off the data. Unfortunately, the existing literature on this subject is sparse and the conclusions are seemingly contradictory. In this paper we propose a generic, practical, test-driven methodology that guides researchers and forensics analysts through a series of steps that assess the \"forensic friendliness\" of a SSD. Given a drive of the same brand and model of the one under analysis, our methodology produces a decision that helps an analyst to determine whether or not an expensive direct acquisition of the memory cells is worth the effort, because the extreme optimizations may have rendered the data unreadable or useless. We apply our methodology to three SSDs produced by top vendors (Samsung, Corsair, and Crucial), and provide a detailed description of how each step should be conducted.","tags":null,"title":"A Comprehensive Black-box Methodology for Testing the Forensic Characteristics of Solid-state Drives","type":"publication"},{"authors":["Stefano Schiavoni","Federico Maggi","Lorenzo Cavallaro","Stefano Zanero"],"categories":null,"content":"","date":1384992000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"86def92ce196124b6c479d61a911ff74","permalink":"/publication/schiavoni_phoenix_tr_2013/","publishdate":"2013-11-21T00:00:00Z","relpermalink":"/publication/schiavoni_phoenix_tr_2013/","section":"publication","summary":"Modern botnets rely on domain-generation algorithms (DGAs) to build resilient command-and-control infrastructures. Recent works focus on recognizing automatically generated domains (AGDs) from DNS traffic, which potentially allows to identify previously unknown AGDs to hinder or disrupt botnets' communication capabilities. The state-of-the-art approaches require to deploy low-level DNS sensors to access data whose collection poses practical and privacy issues, making their adoption problematic. We propose a mechanism that overcomes the above limitations by analyzing DNS traffic data through a combination of linguistic and IP-based features of suspicious domains. In this way, we are able to identify AGD names, characterize their DGAs and isolate logical groups of domains that represent the respective botnets. Moreover, our system enriches these groups with new, previously unknown AGD names, and produce novel knowledge about the evolving behavior of each tracked botnet. We used our system in real-world settings, to help researchers that requested intelligence on suspicious domains and were able to label them as belonging to the correct botnet automatically. Additionally, we ran an evaluation on 1,153,516 domains, including AGDs from both modern (e.g., Bamital) and traditional (e.g., Conficker, Torpig) botnets. Our approach correctly isolated families of AGDs that belonged to distinct DGAs, and set automatically generated from non-automatically generated domains apart in 94.8 percent of the cases.","tags":null,"title":"Tracking and Characterizing Botnets Using Automatically Generated Domains","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1384905600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"c2cd13176455fc237e0c5394136d6a55","permalink":"/talk/maggi_andrototalinfosek_talk_2013/","publishdate":"2013-11-20T00:00:00Z","relpermalink":"/talk/maggi_andrototalinfosek_talk_2013/","section":"talk","summary":"","tags":null,"title":"AndroTotal: A Scalable Framework for Android Antivirus Testing","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1384905600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"5a599495db3817546cc1197130252685","permalink":"/talk/maggi_phoenixinfosek_talk_2013/","publishdate":"2013-11-20T00:00:00Z","relpermalink":"/talk/maggi_phoenixinfosek_talk_2013/","section":"talk","summary":"","tags":null,"title":"Modern Botnets and the Rise of Automatically Generated Domains","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1381276800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"85afab122bd96ae2460bcdfab479e1f9","permalink":"/talk/maggi_andrototalsecure_talk_2013/","publishdate":"2013-10-09T00:00:00Z","relpermalink":"/talk/maggi_andrototalsecure_talk_2013/","section":"talk","summary":"Although there are controversial opinions regarding how large the mobile malware phenomenon is in terms of absolute numbers, hype aside, the amount of new Android malware variants is increasing. This trend is mainly due to the fact that, as it happened with traditional malware, the authors are striving to repackage, obfuscate, or otherwise transform the executable code of their malicious apps in order to evade mobile security apps. There are about 85 of these apps only on the official marketplace. However, it is not clear how effective they are. Indeed, the sandboxing mechanism of Android does not allow (security) apps to audit other apps. We present AndroTotal, a publicly available tool, malware repository and research framework that aims at mitigating the above challenges, and allow researchers to automatically scan Android apps against an arbitrary set of malware detectors. We implemented AndroTotal and released it to the research community in April 2013. So far, we collected 18,758 distinct submitted samples and received the attention of several research groups (1,000 distinct accounts), who integrated their malware-analysis services with ours.","tags":null,"title":"AndroTotal: A Scalable Framework for Android Antimalware Testing","type":"talk"},{"authors":["Alessandro Nacci","Francesco Trov√≤","Federico Maggi","Matteo Ferroni","Andrea Cazzola","Donatella Sciuto","Marco Santambrogio"],"categories":null,"content":"","date":1380585600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"a852d675b54a8346fb3a1eecc6b89233","permalink":"/publication/nacci_mpower_article_2013/","publishdate":"2013-10-01T00:00:00Z","relpermalink":"/publication/nacci_mpower_article_2013/","section":"publication","summary":"Mobile devices have become the main interaction mean between users and the surrounding environment. An indirect measure of this trend is the increasing amount of security threats against mobile devices, which in turn created a demand for protection tools. Protection tools, unfortunately, add an additional burden for the smartphone's battery power, which is a precious resource. This observation motivates the need for smarter (security) applications, designed and capable of running within adaptive energy goals. Although this problem affects other areas, in the security area this research direction is referred to as \"green security\". In general, a fundamental need to the researches toward creating energy-aware applications, consist in having appropriate power models that capture the full dynamic of devices and users. This is not an easy task because of the highly dynamic environment and usage habits. In practice, this goal requires easy mechanisms to measure the power consumption and approaches to create accurate models. The existing approaches that tackle this problem are either not accurate or not applicable in practice due to their limiting requirements. We propose MPower, a power-sensing platform and adaptive power modeling platform for Android mobile devices. The MPower approach creates an adequate and precise knowledge base of the power \"behavior\" of several different devices and users, which allows us to create better device-centric power models that considers the main hardware components and how they contributed to the overall power consumption. In this paper we consolidate our perspective work on MPower by providing the implementation details and evaluation on 278 users and about 22.5 million power-related data. Also, we explain how MPower is useful in those scenarios where low-power, unobtrusive, accurate power modeling is necessary (e.g., green security applications).","tags":null,"title":"Adaptive and Flexible Smartphone Power Modeling","type":"publication"},{"authors":["Federico Maggi","Andrea Valdi","Stefano Zanero"],"categories":null,"content":"","date":1380585600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348198,"objectID":"2328c41bd99a7337fc3c03bd572769c4","permalink":"/publication/maggi_andrototal_2013/","publishdate":"2013-10-01T00:00:00Z","relpermalink":"/publication/maggi_andrototal_2013/","section":"publication","summary":"Although there are controversial opinions regarding how large the mobile malware phenomenon is in terms of absolute numbers, hype aside, the amount of new Android malware variants is increasing. This trend is mainly due to the fact that, as it happened with traditional malware, the authors are striving to repackage, obfuscate, or otherwise transform the executable code of their malicious apps in order to evade mobile security apps. There are about 85 of these apps only on the official marketplace. However, it is not clear how effective they are. Indeed, the sandboxing mechanism of Android does not allow (security) apps to audit other apps. We present AndroTotal, a publicly available tool, malware repository and research framework that aims at mitigating the above challenges, and allow researchers to automatically scan Android apps against an arbitrary set of malware detectors. We implemented AndroTotal and released it to the research community in April 2013. So far, we collected 18,758 distinct submitted samples and received the attention of several research groups (1,000 distinct accounts), who integrated their malware-analysis services with ours.","tags":["workshop"],"title":"AndroTotal: A Flexible, Scalable Toolbox and Service for Testing Mobile Malware Detectors","type":"publication"},{"authors":["Andrea Dardanelli","Federico Maggi","Mara Tanelli","Stefano Zanero","Sergio M Savaresi","Roman Kochanek","Thorsten Holz"],"categories":null,"content":"","date":1371772800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"93f757b9a1b9ecba904dee92386256b2","permalink":"/publication/dardanelli_cartox_article_2013/","publishdate":"2013-06-21T00:00:00Z","relpermalink":"/publication/dardanelli_cartox_article_2013/","section":"publication","summary":"Modern vehicles are increasingly being interconnected with computer systems, which collect information both from vehicular sources and Internet services. Unfortunately, this creates a non negligible attack surface, which extends when vehicles are partly operated via smartphones. In this letter, a hierarchically distributed control system architecture which integrates a smartphone with classical embedded systems is presented, and an ad-hoc, end-to-end security layer is designed to demonstrate how a smartphone can interact securely with a modern vehicle without requiring modifications to the existing in-vehicle network. Experimental results demonstrate the effectiveness of the approach.","tags":null,"title":"A Security Layer for Smartphone-to-Vehicle Communication over Bluetooth","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1367366400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"ad49b3b6fd21a15e1ab8a097c7db2a4e","permalink":"/talk/maggi_andrototalmit_talk_2013/","publishdate":"2013-05-01T00:00:00Z","relpermalink":"/talk/maggi_andrototalmit_talk_2013/","section":"talk","summary":"Although there are controversial opinions regarding how large the mobile malware phenomenon is in terms of absolute numbers, hype aside, the amount of new Android malware variants is increasing. This trend is mainly due to the fact that, as it happened with traditional malware, the authors are striving to repackage, obfuscate, or otherwise transform the executable code of their malicious apps in order to evade mobile security apps. There are about 85 of these apps only on the official marketplace. However, it is not clear how effective they are. Indeed, the sandboxing mechanism of Android does not allow (security) apps to audit other apps. We present AndroTotal, a publicly available tool, malware repository and research framework that aims at mitigating the above challenges, and allow researchers to automatically scan Android apps against an arbitrary set of malware detectors. We implemented AndroTotal and released it to the research community in April 2013. So far, we collected 18,758 distinct submitted samples and received the attention of several research groups (1,000 distinct accounts), who integrated their malware-analysis services with ours.","tags":null,"title":"AndroTotal: A Scalable Framework for Android Antimalware Testing","type":"talk"},{"authors":["Federico Maggi","Alessandro Frossi","Stefano Zanero","Gianluca Stringhini","Brett Stone-Gross","Christopher Kruegel","Giovanni Vigna"],"categories":null,"content":"","date":1367366400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"b8075687f28aa97cba6d882cd59e58e3","permalink":"/publication/maggi_longshore_2013/","publishdate":"2013-05-01T00:00:00Z","relpermalink":"/publication/maggi_longshore_2013/","section":"publication","summary":"URL shortening services have become extremely popular. However, it is still unclear whether they are an effective and reliable tool that can be leveraged to hide malicious URLs, and to what extent these abuses can impact the end users. With these questions in mind, we first analyzed existing countermeasures adopted by popular shortening services. Surprisingly, we found such countermeasures to be ineffective and trivial to bypass. This first measurement motivated us to proceed further with a large-scale collection of the HTTP interactions that originate when web users access live pages that contain short URLs. To this end, we monitored 622 distinct URL shortening services between March 2010 and April 2012, and collected 24,953,881 distinct short URLs. With this large dataset, we studied the abuse of short URLs. Despite short URLs are a significant, new security risk, in accordance with the reports resulting from the observation of the overall phishing and spamming activity, we found that only a relatively small fraction of users ever encountered malicious short URLs. Interestingly, during the second year of measurement, we noticed an increased percentage of short URLs being abused for drive-by download campaigns and a decreased percentage of short URLs being abused for spam campaigns. In addition to these security-related findings, our unique monitoring infrastructure and large dataset allowed us to complement previous research on short URLs and analyze these web services from the user's perspective.","tags":null,"title":"Two years of short URLs internet measurement: security threats and countermeasures","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1364774400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"111d84fe8ac8efa111a2eb660af62a12","permalink":"/talk/maggi_soauth_talk_2013/","publishdate":"2013-04-01T00:00:00Z","relpermalink":"/talk/maggi_soauth_talk_2013/","section":"talk","summary":"Two-factor authentication is widely used by high-value services to prevent adversaries from compromising accounts using stolen credentials. Facebook has recently released a two-factor authentication mechanism, referred to as Social Authentication, which requires users to identify some of their friends in randomly selected photos. A recent study has provided a formal analysis of social authentication weaknesses against attackers inside the victim's social circles. In this paper, we extend the threat model and study the attack surface of social authentication in practice, and show how any attacker can obtain the information needed to solve the challenges presented by Facebook. We implement a proof-of-concept system that utilizes widely available face recognition software and cloud services, and evaluate it using real public data collected from Facebook. Under the assumptions of Facebook's threat model, our results show that an attacker can obtain access to (sensitive) information for at least 42% of a user's friends that Facebook uses to generate social authentication challenges. By relying solely on publicly accessible information, a casual attacker can solve 22% of the social authentication tests in an automated fashion, and gain a significant advantage for an additional 56% of the tests, as opposed to just guessing. Additionally, we simulate the scenario of a determined attacker placing himself inside the victim's social circle by employing dummy accounts. In this case, the accuracy of our attack greatly increases and reaches 100% when 120 faces per friend are accessible by the attacker, even though it is very accurate with as little as 10 faces.","tags":null,"title":"Our Face are Belong to us: Breaking Facebook's Social Authentication","type":"talk"},{"authors":["Jason Polakis","Marco Lancini","Georgios Kontaxis","Federico Maggi","Sotiris Ioannidis","Angelos Keromytis","Stefano Zanero"],"categories":null,"content":"","date":1354492800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"c0a47e4d405f4ce6aa29a48d44ce3dce","permalink":"/publication/polakis_soauth_2012/","publishdate":"2012-12-03T00:00:00Z","relpermalink":"/publication/polakis_soauth_2012/","section":"publication","summary":"Two-factor authentication is widely used by high-value services to prevent adversaries from compromising accounts using stolen credentials. Facebook has recently released a two-factor authentication mechanism, referred to as Social Authentication, which requires users to identify some of their friends in randomly selected photos. A recent study has provided a formal analysis of social authentication weaknesses against attackers inside the victim's social circles. In this paper, we extend the threat model and study the attack surface of social authentication in practice, and show how any attacker can obtain the information needed to solve the challenges presented by Facebook. We implement a proof-of-concept system that utilizes widely available face recognition software and cloud services, and evaluate it using real public data collected from Facebook. Under the assumptions of Facebook's threat model, our results show that an attacker can obtain access to (sensitive) information for at least 42% of a user's friends that Facebook uses to generate social authentication challenges. By relying solely on publicly accessible information, a casual attacker can solve 22% of the social authentication tests in an automated fashion, and gain a significant advantage for an additional 56% of the tests, as opposed to just guessing. Additionally, we simulate the scenario of a determined attacker placing himself inside the victim's social circle by employing dummy accounts. In this case, the accuracy of our attack greatly increases and reaches 100% when 120 faces per friend are accessible by the attacker, even though it is very accurate with as little as 10 faces.","tags":null,"title":"All Your Face Are Belong to Us: Breaking Facebook's Social Authentication","type":"publication"},{"authors":["Martina Lindorfer","Alessandro Di Federico","Federico Maggi","Paolo Milani Comparetti","Stefano Zanero"],"categories":null,"content":"","date":1354492800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"b63162c05f7f2c083327481d963ec9ea","permalink":"/publication/lindorfer_beagle_2012/","publishdate":"2012-12-03T00:00:00Z","relpermalink":"/publication/lindorfer_beagle_2012/","section":"publication","summary":"Malicious software installed on infected computers is a fundamental component of online crime. Malware development thus plays an essential role in the underground economy of cyber-crime. Malware authors regularly update their software to defeat defenses or to support new or improved criminal business models. A large body of research has focused on detecting malware, defending against it and identifying its functionality. In addition to these goals, however, the analysis of malware can provide a glimpse into the software development industry that develops malicious code. In this work, we present techniques to observe the evolution of a malware family over time. First, we develop techniques to compare versions of malicious code and quantify their differences. Furthermore, we use behavior observed from dynamic analysis to assign semantics to binary code and to identify functional components within a malware binary. By combining these techniques, we are able to monitor the evolution of a malware's functional components. We implement these techniques in a system we call BEAGLE, and apply it to the observation of 16 malware strains over several months. The results of these experiments provide insight into the effort involved in updating malware code, and show that BEAGLE can identify changes to individual malware components.","tags":null,"title":"Lines of Malicious Code: Insights Into the Malicious Software Industry","type":"publication"},{"authors":["Roman Kochanek","Andrea Dardanelli","Federico Maggi","Stefano Zanero","Mara Tanelli","Sergio Savaresi","Thorsten Holz"],"categories":null,"content":"","date":1338508800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"0031e9f855887c3d9a1e8d74e4c6e1e1","permalink":"/publication/kochanek_cartox_tr_2012/","publishdate":"2012-06-01T00:00:00Z","relpermalink":"/publication/kochanek_cartox_tr_2012/","section":"publication","summary":"Modern vehicles, and in particular electric vehicles, are increasingly being equipped with interconnected computer systems, which collect information through vehicular sources and remote, Internet-connected services. Unfortunately, this creates a non-negligible attack surface, which extends even more when vehicles are integrated with smartphones to offer advanced services. In fact, embedded systems on vehicles have been developed to address safety, not security requirements. Furthermore, vehicles have real-time constraints, and the typical embedded architectures used on board significantly complicate security designs. In this paper, we introduce a communication framework that addresses these challenges and we demonstrate how a smartphone can interact with a vehicle in a secure and safe manner. To this end, we design a security session layer that ensures end-to-end security transparently. We conduct an experimental evaluation on a real implementation of our security layer, which shows that our solution is practical and easy to use, satisfies performance constraints, and meets real-time requirements by taking into account the limited capabilities of our target architecture. More precisely, we implement our approach for an electrically-powered two-wheeler manufactured by Piaggio, and show how a smartphone can interact via a wireless link with the battery-life controller in a secure manner. Interestingly, our approach is not limited to vehicles, but can be used in other application domains where a smartphone needs to securely interact with an embedded device.","tags":null,"title":"Secure Integration of Mobile Devices for Automotive Services","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1335830400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"b12685e193888abc7ea257849b4646ff","permalink":"/talk/maggi_longshore_talk_2012/","publishdate":"2012-05-01T00:00:00Z","relpermalink":"/talk/maggi_longshore_talk_2012/","section":"talk","summary":"I gave a talk based on these slides for the first time at Royal Holloway University of London, in April 2012. This talk discusses the results of a research that we have conducted about the impact on users of short URLs. I describe a system that we designed, implemented, and deployed that observes and collects the short URLs that more than 7,000 real web users have encountered while browsing the Web between March 2010 and April 2011 (and counting). On this dataset, which comprises 16,075,693 distinct short URLs, we first precisely characterized the usage habits observed during our collection process, and the content typically referred by short URLs: Users exhibit different usage habits depending on the type of content they are using short URLs for. We then analyzed the abuse of short URLs to hide the true URL of malicious pages: This practice is not widespread, although we noticed that the miscreants tend to post the same malicious short URL on multiple pages. Finally, we analyzed the countermeasures of shortening services against abuses of short URLs, and found that they are trivially bypassed by shortening a benign URL that turns malicious only a few moments after submitting it to the shortening service.","tags":null,"title":"The Long Story of Short URLs","type":"talk"},{"authors":["Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1334534400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"895fc5afa70b9c64902bfb1ec9304236","permalink":"/publication/maggi_phdthesispaper_2012/","publishdate":"2012-04-16T00:00:00Z","relpermalink":"/publication/maggi_phdthesispaper_2012/","section":"publication","summary":"Our research concentrates on anomaly detection techniques, which have both industrial applications such as network monitoring and protection, as well as research applications such as software behavioral analysis or malware classification. During our doctoral research, we worked on anomaly detection from three different perspective, as a complex computer infrastructure has several weak spots that must be protected. We first focused on the operating system, central to any computer, to avoid malicious code to subvert its normal activity. Secondly, we concentrated on web applications, which are the main interface to modern computing: Because of their immense popularity, they have indeed become the most targeted entry point of intrusions. Last, we developed novel techniques with the aim of identifying related events (e.g., alerts reported by intrusion detection systems) to build new and more compact knowledge to detect malicious activity on large-scale systems. During our research we enhanced existing anomaly detection tools and also contributed with new ones. Such tools have been tested over different datasets, both synthetic data and real network traffic, and lead to interesting results that were accepted for publication at main security venues.","tags":null,"title":"Integrated Detection of Anomalous Behavior of Computer Infrastructures","type":"publication"},{"authors":["Federico Maggi","Andrea Bellini","Guido Salvaneschi","Stefano Zanero"],"categories":null,"content":"","date":1323907200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"cbff875b95288cf162921b043eeabc16","permalink":"/publication/maggi_avlabelling_2011/","publishdate":"2011-12-15T00:00:00Z","relpermalink":"/publication/maggi_avlabelling_2011/","section":"publication","summary":"Malware analysts, and in particular antivirus vendors, never agreed on a single naming convention for malware specimens. This leads to confusion and difficulty more for researchers than for practitioners for example, when comparing coverage of different antivirus engines, when integrating and systematizing known threats, or comparing the classifications given by different detectors. Clearly, solving naming inconsistencies is a very difficult task, as it requires that vendors agree on a unified naming convention. More importantly, solving inconsistencies is impossible without knowing exactly where they are. Therefore, in this paper we take a step back and concentrate on the problem of finding inconsistencies. To this end, we first represent each vendor's naming convention with a graph-based model. Second, we give a precise definition of inconsistency with respect to these models. Third, we define two quantitative measures to calculate the overall degree of inconsistency between vendors. In addition, we propose a fast algorithm that finds non-trivial (i.e., beyond syntactic differences) inconsistencies. Our experiments on four major antivirus vendors and 98,798 real-world malware samples confirm anecdotal observations that different vendors name viruses differently. More importantly, we were able to find inconsistencies that cannot be inferred at all by looking solely at the syntax.","tags":null,"title":"Finding Non-trivial Malware Naming Inconsistencies","type":"publication"},{"authors":["Federico Maggi","Alberto Volpatto","Simone Gasparini","Giacomo Boracchi","Stefano Zanero"],"categories":null,"content":"","date":1323043200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"3361970ef19794f83f7f9f6e15b3ab2d","permalink":"/publication/maggi_iclearshot_2011/","publishdate":"2011-12-05T00:00:00Z","relpermalink":"/publication/maggi_iclearshot_2011/","section":"publication","summary":"The pervasiveness of mobile devices increases the risk of exposing sensitive information on the go. In this paper, we arise this concern by presenting an automatic attack against modern touchscreen keyboards. We demonstrate the attack against the Apple iPhone 2010's most popular touchscreen device although it can be adapted to other devices (e.g., Android) that employ similar key-magnifying keyboards. Our attack processes the stream of frames from a video camera (e.g., surveillance or portable camera) and recognizes keystrokes online, in a fraction of the time needed to perform the same task by direct observation or offline analysis of a recorded video, which can be unfeasible for large amount of data. Our attack detects, tracks, and rectifies the target touchscreen, thus following the device or camera's movements and eliminating possible perspective distortions and rotations In real-world settings, our attack can automatically recognize up to 97.07 percent of the keystrokes (91.03 on average), with 1.15 percent of errors (3.16 on average) at a speed ranging from 37 to 51 keystrokes per minute.","tags":null,"title":"A Fast Eavesdropping Attack Against Touchscreens","type":"publication"},{"authors":[],"categories":[],"content":"Spying on a person is an easy and effective method to obtain sensitive information, even when the victim is well protected against common digital attacks. Modern mobile devices allow people to perform some information sensitive actions in unsafe places, where anyone could easily observe the victim while typing.\nWhat if your mobile phone has a cool touchscreen interface that gives you graphical feedback as you type (iPhone, Android, BlackBerry Torch)? Does it make shoulder surfing easier or, worse, automatable? We believe so, and to demonstrate it, we developed a practical shoulder surfing attack that automatically reconstructs the sequence of keystrokes by aiming a camera at the target touchscreen while the victim is typing.\nDemo   References  Federico Maggi, Alberto Volpatto, Simone Gasparini, Giacomo Boracchi, Stefano Zanero  (2011). POSTER: Fast, Automatic iPhone Shoulder Surfing. Proceedings of the 18th Conference on Computer and Communication Security (CCS).  PDF  Cite    Federico Maggi, Alberto Volpatto, Simone Gasparini, Giacomo Boracchi, Stefano Zanero  (2011). A Fast Eavesdropping Attack Against Touchscreens. Proceedings of the 7th International Conference on Information Assurance and Security (IAS).  PDF  Cite    Federico Maggi, Alberto Volpatto, Simone Gasparini, Giacomo Boracchi, Stefano Zanero  (2010). Don\u0026#39;t touch a word! A practical input eavesdropping attack against mobile touchscreen devices.  PDF  Cite  ","date":1322753588,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1322753588,"objectID":"595ce22c55dc2ce8a368e51deb20a7b8","permalink":"/post/isnoop/","publishdate":"2011-12-01T17:33:08+02:00","relpermalink":"/post/isnoop/","section":"post","summary":"Spying on a person is an easy and effective method to obtain sensitive information, even when the victim is well protected against common digital attacks. Modern mobile devices allow people to perform some information sensitive actions in unsafe places, where anyone could easily observe the victim while typing.\n","tags":[],"title":"iSnoop: Automatic Eavesdropping from Touchscreen Keyboards","type":"post"},{"authors":["Federico Maggi","Alberto Volpatto","Stefano Zanero"],"categories":null,"content":"","date":1322697600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"02bac29ad4cfc45e093d77a4cdb0b4a0","permalink":"/talk/maggi_isnoop_talk_2011/","publishdate":"2011-12-01T00:00:00Z","relpermalink":"/talk/maggi_isnoop_talk_2011/","section":"talk","summary":"Spying on a person is an easy and effective method to obtain sensitive informations, even when the victim is well protected against common digital attacks. Modern mobile devices allow people to perform some information sensitive actions in unsafe places, where anyone could easily observe the victim while typing. What if your mobile phone has a cool touchscreen interface that gives you graphical feedback as you type (iPhone, Android, BlackBerry Torch)? Does it make shoulder surfing easier or, worse, automatable?  We believe so, and to demonstrate it, we developed a practical shoulder surfing attack that automatically reconstructs the sequence of keystrokes by aiming a camera at the target touchscreen while the victim is typing. Our attack exploits feedback such as magnified keys, often appearing in predictable positions. This feedback mechanism has been adopted by the top three touchscreen vendors (Apple iOS, Google Android, RIM BlackBerry); in newer version of these mobile OSs, the user has no way to disable it. To demonstrate the effectiveness of our approach, we implemented it against the iPhone (the most popular one), but it can be easily adapted to similar devices with minor modifications.  Our attack takes into account that, in real-world scenarios, both the victim's device and attacker's spying camera are not standing in fixed positions. To compensate their movements and misalignments, our system detects and rectifies the target screen before identifying keystokes. By doing that, we are able to automatically recognize up to 97.07% of the keystrokes, with as low as 1.15% errors and an average processing speed that makes it a fast and quasi-real-time alternative to shoulder surfing.","tags":null,"title":"iSnoop: How to Steal Secrets From Touchscreen Devices","type":"talk"},{"authors":["Federico Maggi","Alberto Volpatto","Simone Gasparini","Giacomo Boracchi","Stefano Zanero"],"categories":null,"content":"","date":1317427200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"73a68315e693c62f18a6415bbb93076e","permalink":"/publication/maggi_iclearshotposter_2011/","publishdate":"2011-10-01T00:00:00Z","relpermalink":"/publication/maggi_iclearshotposter_2011/","section":"publication","summary":"Touchscreen devices increase the risk of shoulder surfing to such an extent that attackers could steal sensitive information by simply following the victim and observe his or her portable device. We underline this concern by proposing an automatic shoulder surfing attack against modern touchscreen keyboards that display magnified keys in predictable positions. We demonstrate this attack against the Apple iPhone although it can work with other layouts and different devices and show that it recognizes up to 97.07% (91.03% on average) of the keystrokes, with only 1.15% of errors, at 37 to 51 keystrokes per minute: About eight times faster than a human analyzing a recorded video. Our attack accurately recovers the sequence of keystrokes input by the user. A previous attack, which targeted desktop scenarios and thus worked with very restrictive settings, is similar in spirit to ours. However, as it assumes that camera and target keyboard are both in fixed, perpendicular position, it cannot suite mobile settings, characterized by moving target and skewed, rotated viewpoints. Our attack, instead, requires no particular settings and even allows for natural movements of both target device and shoulder surfer's camera. In addition, our attack yields accurate output without any grammar or syntax checks, so that it can detect large context-free text or non-dictionary words.","tags":null,"title":"POSTER: Fast, Automatic iPhone Shoulder Surfing","type":"publication"},{"authors":["Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1309910400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348198,"objectID":"d7f017afff0a78f99481d9d267fed0a6","permalink":"/publication/maggi_syssecpolimi_2011/","publishdate":"2011-07-06T00:00:00Z","relpermalink":"/publication/maggi_syssecpolimi_2011/","section":"publication","summary":"This paper summarizes the past, present and future lines of research in the systems security area pursued by the Performance Evaluation Lab of Politecnico di Milano. We describe our past research in the area of learning algorithms applied to intrusion detection, our current work in the area of malware analysis, and our future research outlook, oriented to the cloud, to mobile device security, and to cyber-physical systems.","tags":["workshop"],"title":"System Security research at Politecnico di Milano","type":"publication"},{"authors":["Francesco Roveta","Luca Di Mario","Federico Maggi","Giorgio Caviglia","Stefano Zanero","Paolo Ciuccarelli"],"categories":null,"content":"","date":1308528000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"a4bf4c27af48c67ed3c372edee2d66e4","permalink":"/publication/roveta_burn_2011/","publishdate":"2011-06-20T00:00:00Z","relpermalink":"/publication/roveta_burn_2011/","section":"publication","summary":"Manual analysis of security-related events is still a necessity to investigate non-trivial cyber attacks. This task is particularly hard when the events involve slow, stealthy and large-scale activities typical of the modern cybercriminals' strategy. In this regard, visualization tools can effectively help analysts in their investigations. In this paper, we present BURN, an interactive visualization tool for displaying autonomous systems exhibiting rogue activity that helps at finding misbehaving networks through visual and interactive exploration. Up to seven values are displayed in a single visual element, while avoiding cumbersome and confusing maps. To this end, animations and alpha channels are leveraged to create simple views that highlight relevant activity patterns. In addition, BURN incorporates a simple algorithm to identify migrations of nefarious services across autonomous systems, which can support, for instance, root-cause analysis and law enforcement investigations.","tags":null,"title":"BURN: Baring Unknown Rogue Networks","type":"publication"},{"authors":["Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1306886400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"19ae8bfcf9ee0547d94df667f167b845","permalink":"/publication/maggi_cloudids_2011/","publishdate":"2011-06-01T00:00:00Z","relpermalink":"/publication/maggi_cloudids_2011/","section":"publication","summary":"The world of information and communication technology is experiencing changes that, regardless of some skepticism, are bringing to life the concept of ``utility computing''. The nostalgics observed a parallel between the emerging paradigm of cloud computing and the traditional time-sharing era, depicting clouds as the modern reincarnation of mainframes available on a pay-per-use basis, and equipped with virtual, elastic, disks-as-a-service that replace the old physical disks with quotas. This comparison is fascinating, but more importantly, in our opinion, it prepares the ground for constructive critiques regarding the security of such a computing paradigm and, especially, one of its key components: web services. In this paper we discuss our position about the current countermeasures (e.g., intrusion detection systems, anti-malware), developed to mitigate well-known web security threats. By reasoning on said affinities, we focus on the simple case study of anomaly-based approaches, which are employed in many modern protection tools, not just in intrusion detectors. We illustrate our position by the means of a simple running example and show that attacks against injection vulnerabilities, a widespread menace that is easily recognizable with ordinary anomaly-based checks, can be difficult to detect if web services are protected as they were regular web applications. Along this line, we concentrate on a few, critical hypotheses that demand particular attention. Although in this emerging landscape only a minority of threats qualify as novel, they could be difficult to recognize with the current countermeasures and thus can expose web services to new attacks. We conclude by proposing simple modifications to the current countermeasures to cope with the aforesaid security issues.","tags":null,"title":"Is the future Web more insecure? Distractions and solutions of new-old security issues and measures","type":"publication"},{"authors":["Federico Maggi","Alessandro Sisto","Stefano Zanero"],"categories":null,"content":"","date":1302393600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348198,"objectID":"6a1ff7477f0f485038c0bacfe9b3734c","permalink":"/publication/maggi_phonephishinghoneypot_2011/","publishdate":"2011-04-10T00:00:00Z","relpermalink":"/publication/maggi_phonephishinghoneypot_2011/","section":"publication","summary":"Phishers nowadays rely on a variety of channels, ranging from old-fashioned emails to instant messages, social networks, and the phone system (with both calls and text messages), with the goal of reaching more victims. As a consequence, modern phishing became a multi-faceted, even more pervasive threat that is inherently more difficult to study than traditional, email-based phishing. This short paper describes the status of a data collection system we are developing to capture different aspects of phishing campaigns, with a particular focus on the emerging use of the voice channel. The general approach is to record inbound calls received on decoy phone lines, place outbound calls to the same caller identifiers (when available) and also to telephone numbers obtained from different sources. Specifically, our system analyzes instant messages (e.g., automated social engineering attempts) and suspicious emails (e.g., spam, phishing), and extracts telephone numbers, URLs and popular words from the content. In addition, users can voluntarily submit voice phishing (vishing) attempts through a public website. Extracted telephone numbers, URLs and popular words will be correlated to recognize campaigns by means of cross-channel relationships between messages.","tags":["workshop"],"title":"A social-engineering-centric data collection initiative to study phishing","type":"publication"},{"authors":["Alberto Volpatto","Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1290384000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"ab2e075dad953e19b6fa739ef600a7a8","permalink":"/publication/volpatto_cooperativeids_2010/","publishdate":"2010-11-22T00:00:00Z","relpermalink":"/publication/volpatto_cooperativeids_2010/","section":"publication","summary":"","tags":null,"title":"Effective Multimodel Anomaly Detection Using Cooperative Negotiation","type":"publication"},{"authors":["Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1289433600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348204,"objectID":"3591b0a5f32a1287a8cf693ea5c138d6","permalink":"/publication/maggi_cloudids_tr_2010/","publishdate":"2010-11-11T00:00:00Z","relpermalink":"/publication/maggi_cloudids_tr_2010/","section":"publication","summary":"The world of information and communication technology is experiencing changes that, regardless of some skepticism, are bringing to life the concept of ``utility computing''. The nostalgics observed a parallel between the emerging paradigm of cloud computing and the traditional time-sharing era, depicting clouds as the modern reincarnation of mainframes available on a pay-per-use basis, and equipped with virtual, elastic, paid disks-as-a-service that replace the old physical disks with quotas. This comparison is fascinating, but more importantly, in our opinion, it prepares the ground for constructive critiques regarding the security of such computing paradigm. In this paper we explore similar analogies to discuss our position about the current countermeasures (e.g., intrusion detection systems, anti-viruses), developed to mitigate well-known security threats. By reasoning on said affinities, we focus on the simple case of anomaly-based approaches, which are employed in many modern protection tools, not just in intrusion detectors. We illustrate our position by the means of a simple running example and show that attacks against injection vulnerabilities, a current menace that is easily recognizable with ordinary anomaly-based checks, can be difficult to detect if web services are assumed to be regular web applications. Along this line, we concentrate on a few, critical hypotheses that demand particular attention. We conclude that, although only a minority of threats qualify as novel, they are well camouflaged and can be difficult to recognize behind the confusion caused by the cloud computing excitement.","tags":null,"title":"Rethinking security in a cloudy world","type":"publication"},{"authors":["Federico Maggi","Alberto Volpatto","Simone Gasparini","Giacomo Boracchi","Stefano Zanero"],"categories":null,"content":"","date":1288569600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348205,"objectID":"e9cbe926e7d84d90cddf45186e83b666","permalink":"/publication/maggi_iclearshot_tr_2010/","publishdate":"2010-11-01T00:00:00Z","relpermalink":"/publication/maggi_iclearshot_tr_2010/","section":"publication","summary":"Spying on a person is a subtle, yet easy and reliable method to obtain sensitive information. Even if the victim is well protected from digital attacks, spying may be a viable option. In addition, the pervasiveness of mobile devices increases an attacker's opportunities to observe the victims while they are accessing or entering sensitive information. This risk is exacerbated by the remarkable user-friendliness of modern, mobile graphical interfaces, which, for example, display visual feedback to improve the user experience and make common tasks, $ensuremathbackslashbackslash$eg, typing, more natural. Unfortunately, this turns into the well-known trade-off between usability and security. In this work, we focus on how usability of modern mobile interfaces may affect the users' privacy. In particular, we describe a practical eavesdropping attack, able to recognize the sequence of keystrokes from a low-resolution video, recorded while the victim is typing on a touchscreen. Our attack exploits the fact that modern virtual keyboards, as opposed to mechanical ones, often display magnified, virtual keys in predictable positions. To demonstrate the feasibility of this attack we implemented it against 2010's most popular smart-phone (i.e., Apple's iPhone). Our approach works under realistic conditions, because it tracks and rectifies the target screen according to the victim's natural movements, before performing the keystroke recognition. On real-world settings, our attack can automatically recognize up to 97.07% (91.03% on average) of the keystrokes, with a 1.15% error rate and a speed between 37 and 51 keystrokes per minute. This work confirms that touchscreen keyboards that magnify keys make automatic eavesdropping attacks easier than in classic mobile keyboards.","tags":null,"title":"Don't touch a word! A practical input eavesdropping attack against mobile touchscreen devices","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1277769600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"3fc8375ddfc4344bb7a4d02d0f6a92e6","permalink":"/publication/maggi_phonephishing_2010/","publishdate":"2010-06-29T00:00:00Z","relpermalink":"/publication/maggi_phonephishing_2010/","section":"publication","summary":"Phishing is the practice of eliciting a person's confidential information such as name, date of birth or credit card details. Typically, the phishers use simple technologies (e.g., e-mailing) to spread social engineering attacks with the goal of persuading a large amount of victims into voluntarily disclose sensitive data. Phishing based on e-mail and web technologies is certainly the most popular form. It has indeed received ample attention and some mitigation measures have been implemented. In this paper we describe our study on vishing (voice phishing), a form of phishing where the scammers exploit the phone channel to ask for sensitive information, rather than sending e-mails and cloning trustworthy websites. In some sense, the traditional ala-Mitnick phone scams are streamlined by attackers using techniques that are typical of modern, e-mail-based phishing. We detail our analysis of an embryonic, real-world database of vishing attacks reported by victims through a publicly-available web application that we build for this purpose. The vishing activity that we registered in our preliminary analysis is targeted against the U.S. customers. According to our samples, we analyzed to what extent the criminals rely on automated responders to streamline the vishing campaigns. In addition, we analyzed the content of the conversations and found that words such as ``credit'', ``press'' (a key) or ``account'' are fairly popular. In addition, we describe the data collection infrastructure and motivate why gathering data about vishing is more difficult than for regular e-mail phishing.","tags":null,"title":"Are the Con Artists Back? A Preliminary Analysis of Modern Phone Frauds","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1275350400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"89deb152589a5b532757c69d789f60cd","permalink":"/publication/maggi_traces_2010/","publishdate":"2010-06-01T00:00:00Z","relpermalink":"/publication/maggi_traces_2010/","section":"publication","summary":"A one-pass recognition algorithm is presented to solve the membership problem for rational trace languages. The algorithm is detailed through the formal specification of the Buffer Machine, a non-deterministic, finite-state automaton with multiple buffers that can solve the membership problem in polynomial time. The performances and characteristics of the proposed solution are evaluated on a testbed implementation using pseudo-random traces, strings, languages and dependency relations.","tags":null,"title":"A Recognizer of Rational Trace Languages","type":"publication"},{"authors":["William Robertson","Federico Maggi","Christopher Kruegel","Giovanni Vigna"],"categories":null,"content":"","date":1267401600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"2a92e15d02dedb0547fe000dd127da39","permalink":"/publication/robertson_longtail_2010/","publishdate":"2010-03-01T00:00:00Z","relpermalink":"/publication/robertson_longtail_2010/","section":"publication","summary":"Learning-based anomaly detection has proven to be an effective black-box technique for detecting unknown attacks. However, the effectiveness of this technique crucially depends upon both the quality and the completeness of the training data. Unfortunately, in most cases, the traffic to the system (e.g., a web application or daemon process) protected by an anomaly detector is not uniformly distributed. Therefore, some components (e.g., authentication, payments, or content publishing) might not be exercised enough to train an anomaly detection system in a reasonable time frame. This is of particular importance in real-world settings, where anomaly detection systems are deployed with little or no manual configuration, and they are expected to automatically learn the normal behavior of a system to detect or block attacks. In this work, we first demonstrate that the features utilized to train a learning-based detector can be semantically grouped, and that features of the same group tend to induce similar models. Therefore, we propose addressing local training data deficiencies by exploiting clustering techniques to construct a knowledge base of well-trained models that can be utilized in case of undertraining. Our approach, which is independent of the particular type of anomaly detector employed, is validated using the realistic case of a learning-based system protecting a pool of web servers running several web applications such as blogs, forums, or Web services. We run our experiments on a real-world data set containing over 58 million HTTP requests to more than 36,000 distinct web application components. The results show that by using the proposed solution, it is possible to achieve effective attack detection even with scarce training data.","tags":null,"title":"Effective Anomaly Detection with Scarce Training Data","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1267056000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"05f87efc45600bc8955bffa9da815c28","permalink":"/talk/maggi_phdthesisfbk_talk_2010/","publishdate":"2010-02-25T00:00:00Z","relpermalink":"/talk/maggi_phdthesisfbk_talk_2010/","section":"talk","summary":"","tags":null,"title":"Detecting Anomalous Behaviors in Computer Infrastructures","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1264032000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348035,"objectID":"f7077810ab9a934a923746da6a7931c6","permalink":"/talk/maggi_justintime_talk_2010/","publishdate":"2010-01-21T00:00:00Z","relpermalink":"/talk/maggi_justintime_talk_2010/","section":"talk","summary":"","tags":null,"title":"Just-in-Time Training of Anomaly Detectors","type":"talk"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1262304000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348228,"objectID":"14fb86e5d268463f617c428d20a7d9bb","permalink":"/publication/maggi_phdthesis_2010/","publishdate":"2010-01-01T00:00:00Z","relpermalink":"/publication/maggi_phdthesis_2010/","section":"publication","summary":"This dissertation details our research on anomaly detection techniques, that are central to several classic security-related tasks such as network monitoring, but it also have broader applications such as program behavior characterization or malware classification. In particular, we worked on anomaly detection from three different perspective, with the common goal of recognizing awkward activity on computer infrastructures. In fact, a computer system has several weak spots that must be protected to avoid attackers to take advantage of them. We focused on protecting the operating system, central to any computer, to avoid malicious code to subvert its normal activity. Secondly, we concentrated on protecting the web applications, which can be considered the modern, shared operating systems; because of their immense popularity, they have indeed become the most targeted entry point to violate a system. Last, we experimented with novel techniques with the aim of identifying related events (e.g., alerts reported by intrusion detection systems) to build new and more compact knowledge to detect malicious activity on large-scale systems.  Our contributions regarding host-based protection systems focus on characterizing a process' behavior through the system calls invoked into the kernel. In particular, we engineered and carefully tested different versions of a multi-model detection system using both stochastic and deterministic models to capture the features of the system calls during normal operation of the operating system. Besides demonstrating the effectiveness of our approaches, we confirmed that the use of finite-state, deterministic models allow to detect deviations from the process' control flow with the highest accuracy; however, our contribution combine this effectiveness with advanced models for the system calls' arguments resulting in a significantly decreased number of false alarms.  Our contributions regarding web-based protection systems focus on advanced training procedures to enable learning systems to perform well even in presence of changes in the web application source code---particularly frequent in the Web 2.0 era. We also addressed data scarcity issues that is a real problem when deploying an anomaly detector to protect a new, never-used-before application. Both these issues dramatically decrease the detection capabilities of an intrusion detection system but can be effectively mitigated by adopting the techniques we propose.  Last, we investigated the use of different stochastic and fuzzy models to perform automatic alert correlation, which is as post processing step to intrusion detection. We proposed a fuzzy model that formally defines the errors that inevitably occur if time-based alert aggregation (i.e., two alerts are considered correlated if they are close in time) is used. This model allow to account for measurements errors and avoid false correlations due to delays, for instance, or incorrect parameter settings. In addition, we defined a model to describe the alert generation as a stochastic process and experimented with non-parametric statistical tests to define robust, zero-configuration correlation systems.  The aforementioned tools have been tested over different datasets---that are thoroughly documented in this document---and lead to interesting results.","tags":null,"title":"Integrated Detection of Anomalous Behavior of Computer Infrastructures","type":"publication"},{"authors":["Claudio Criscione","Federico Maggi","Guido Salvaneschi","Stefano Zanero"],"categories":null,"content":"","date":1257724800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"d57a53cb263242699dcc6679f60db467","permalink":"/publication/criscione_masibty_2009/","publishdate":"2009-11-09T00:00:00Z","relpermalink":"/publication/criscione_masibty_2009/","section":"publication","summary":"Anomaly-based techniques were exploited successfully to implement protection mechanisms for various systems. Recently, these approaches have been ported to the web domain under the name of ``web application anomaly detectors'' (or firewalls) with promising results. In particular, those capable of automatically building specifications, or models, of the protected application by observing its traffic (e.g., network packets, system calls, or HTTP requests and responses) are particularly interesting, since they can be deployed with little effort. Typically, the detection accuracy of these systems is significantly influenced by the model building phase (often called training), which clearly depends upon the quality of the observed traffic, which should resemble the normal activity of the protected application and must be also free from attacks. Otherwise, detection may result in significant amounts of false positives (i.e., benign events flagged as anomalous) and negatives (i.e., undetected threats). In this work we describe Masibty, a web application anomaly detector that have some interesting properties. First, it requires the training data not to be attack-free. Secondly, not only it protects the monitored application, it also detects and blocks malicious client-side threats before they are sent to the browser. Third, Masibty intercepts the queries before they are sent to the database, correlates them with the corresponding HTTP requests and blocks those deemed anomalous. Both the accuracy and the performance have been evaluated on real-world web applications with interesting results. The system is almost not influenced by the presence of attacks in the training data and shows only a negligible amount of false positives, although this is paid in terms of a slight performance overhead.","tags":null,"title":"Integrated Detection of Attacks Against Browsers, Web Applications and Databases","type":"publication"},{"authors":["Federico Maggi","Matteo Matteucci","Stefano Zanero"],"categories":null,"content":"","date":1254355200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"66adefc2d7c874f842b068d068cfd544","permalink":"/publication/maggi_fuzzyalertaggregation_article_2009/","publishdate":"2009-10-01T00:00:00Z","relpermalink":"/publication/maggi_fuzzyalertaggregation_article_2009/","section":"publication","summary":"In this paper we focus on the aggregation of IDS alerts, an important component of the alert fusion process. We exploit fuzzy measures and fuzzy sets to design simple and robust alert aggregation algorithms. Exploiting fuzzy sets, we are able to robustly state whether or not two alerts are ``close in time'', dealing with noisy and delayed detections. A performance metric for the evaluation of fusion systems is also proposed. Finally, we evaluate the fusion method with alert streams from anomaly-based IDS.","tags":null,"title":"Reducing false positives in anomaly detectors through fuzzy alert aggregation","type":"publication"},{"authors":["Federico Maggi","William Robertson","Christopher Kruegel","Giovanni Vigna"],"categories":null,"content":"","date":1253664000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"5e726cfc52aa194895bc0d41e2d7f2b2","permalink":"/publication/maggi_conceptdrift_2009/","publishdate":"2009-09-23T00:00:00Z","relpermalink":"/publication/maggi_conceptdrift_2009/","section":"publication","summary":"Because of the ad hoc nature of web applications, intrusion detection systems that leverage machine learning techniques are particularly well-suited for protecting websites. The reason is that these systems are able to characterize the applications' normal behavior in an automated fashion. However, anomaly-based detectors for web applications suffer from false positives that are generated whenever the applications being protected change. These false positives need to be analyzed by the security officer who then has to interact with the web application developers to confirm that the reported alerts were indeed erroneous detections. In this paper, we propose a novel technique for the automatic detection of changes in web applications, which allows for the selective retraining of the affected anomaly detection models. We demonstrate that, by correctly identifying legitimate changes in web applications, we can reduce false positives and allow for the automated retraining of the anomaly models. We have evaluated our approach by analyzing a number of real-world applications. Our analysis shows that web applications indeed change substantially over time, and that our technique is able to effectively detect changes and automatically adapt the anomaly detection models to the new structure of the changed web applications.","tags":null,"title":"Protecting a Moving Target: Addressing Web Application Concept Drift","type":"publication"},{"authors":["Alessandro Frossi","Federico Maggi","Gian Luigi Rizzo","Stefano Zanero"],"categories":null,"content":"","date":1247097600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"4c79fa588c41bca012e662af9cd43e20","permalink":"/publication/frossi_hybridsyscalls_2009/","publishdate":"2009-07-09T00:00:00Z","relpermalink":"/publication/frossi_hybridsyscalls_2009/","section":"publication","summary":"We propose a syscall-based anomaly detection system that incorporates both deterministic and stochastic models. We analyze in detail two alternative approaches for anomaly detection over system call sequences and arguments, and propose a number of modifications that significantly improve their performance. We begin by comparing them and analyzing their respective performance in terms of detection accuracy. Then, we outline their major shortcomings, and propose various changes in the models that can address them: we show how targeted modifications of their anomaly models, as opposed to the redesign of the global system, can noticeably improve the overall detection accuracy. Finally, the impact of these modifications are discussed by comparing the performance of the two original implementations with two modified versions complemented with our models.","tags":null,"title":"Selecting and Improving System Call Models for Anomaly Detection","type":"publication"},{"authors":["Federico Maggi","Matteo Matteucci","Stefano Zanero"],"categories":null,"content":"","date":1226880000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"ea23b50f16778466e95f5b66cc9ea081","permalink":"/publication/maggi_syscallseq_article_2008/","publishdate":"2008-11-17T00:00:00Z","relpermalink":"/publication/maggi_syscallseq_article_2008/","section":"publication","summary":"We describe an unsupervised host-based intrusion detection system based on system calls arguments and sequences. We define a set of anomaly detection models for the individual parameters of the call. We then describe a clustering process which helps to better fit models to system call arguments, and creates inter-relations among different arguments of a system call. Finally, we add a behavioral Markov model in order to capture time correlations and abnormal behaviors. The whole system needs no prior knowledge input; it has a good signal to noise ratio, and it is also able to correctly contextualize alarms, giving the user more information to understand whether a true or false positive happened, and to detect variations over the entire execution flow, as opposed to punctual variations over individual instances.","tags":null,"title":"Detecting Intrusions through System Call Sequence and Argument Analysis","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1212278400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348205,"objectID":"d724fefbb7860734ff449a9e7048215d","permalink":"/publication/maggi_traces_tr_2008/","publishdate":"2008-06-01T00:00:00Z","relpermalink":"/publication/maggi_traces_tr_2008/","section":"publication","summary":"An improved, one-pass version of a two-pass, Earley-like recognition algorithm is here proposed to solve the Membership Problem for rational trace languages in polynomial time. The algorithm is first described through the formal specification of what we called a Non Deterministic Buffer Machine (NDBM); secondly, the recognition is detailed through a deterministic algorithm along with some running examples. In addition, we describe our prototype implementation of the algorithm used to empirically evaluate the performances and the characteristics of the proposed solution. To this end, we designed pseudo-random testing data generators that are here described as well.","tags":null,"title":"Specification and Evaluation of an Efficient Recognizer for Rational Trace Languages","type":"publication"},{"authors":["Federico Maggi"],"categories":null,"content":"","date":1207008000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591348205,"objectID":"7478aa6391b0b96a7bdc7caada0707e2","permalink":"/publication/maggi_recordmatching_tr_2008/","publishdate":"2008-04-01T00:00:00Z","relpermalink":"/publication/maggi_recordmatching_tr_2008/","section":"publication","summary":"Probabilistic record linkage regards the use of stochastic decision models to solve the problem of record linkage (also known as record matching). Data quality has became a key aspect in many institutions and the demand for novel, effective techniques is increasing. Record linkage in general has been studied in the last three decades and a solid probabilistic decision framework has been proposed along with several extensions and specific estimation methods. This paper is a survey work narrowed to the most recent and promising approaches also including a selection of data cleansing tools based on probabilistic decision models.","tags":null,"title":"A Survey of Probabilistic Record Matching Models, Techniques and Tools","type":"publication"},{"authors":["Federico Maggi","Stefano Zanero","Vincenzo Iozzo"],"categories":null,"content":"","date":1207008000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591520876,"objectID":"cdb03b4e88eaf7bc7bbc01743eeccee4","permalink":"/publication/maggi_antiforensics_article_2008/","publishdate":"2008-04-01T00:00:00Z","relpermalink":"/publication/maggi_antiforensics_article_2008/","section":"publication","summary":"Anti-forensics is the practice of circumventing classical forensics analysis procedures making them either unreliable or impossible. In this paper we propose the use of machine learning algorithms and anomaly detection to cope with a wide class of definitive anti-forensics techniques. We test the proposed system on a dataset we created through the implementation of an innovative technique of anti-forensics, and we show that our approach yields promising results in terms of detection.","tags":null,"title":"Seeing the invisible: forensic uses of anomaly detection and machine learning","type":"publication"},{"authors":["Federico Maggi","Stefano Zanero"],"categories":null,"content":"","date":1188950400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1591345282,"objectID":"4fcf8a19e545947560fac204c2f35f65","permalink":"/publication/maggi_alertcorrelation_2007/","publishdate":"2007-09-05T00:00:00Z","relpermalink":"/publication/maggi_alertcorrelation_2007/","section":"publication","summary":"In this paper we analyze the use of different types of statistical tests for the correlation of anomaly detection alerts. We show that the Granger Causality Test, one of the few proposals that can be extended to the anomaly detection domain, strongly depends on good choices of a parameter which proves to be both sensitive and difficult to estimate. We propose a different approach based on a set of simpler statistical tests, and we prove that our criteria work well on a simplified correlation task, without requiring complex configuration parameters.","tags":null,"title":"On the Use of Different Statistical Tests for Alert Correlation - Short Paper","type":"publication"}]